<?php

// Data functions (insert, update, delete, form) for table natural

// This script and data application were generated by AppGini 22.13
// Download AppGini for free from https://bigprof.com/appgini/download/

function natural_insert(&$error_message = '') {
	global $Translation;

	// mm: can member insert record?
	$arrPerm = getTablePermissions('natural');
	if(!$arrPerm['insert']) return false;

	$data = [
		'VcrIdSol' => Request::lookup('VcrIdSol', ''),
		'VcrFecVis' => Request::dateComponents('VcrFecVis', ''),
		'VcrNomAti' => Request::val('VcrNomAti', ''),
		'VcrIdTip' => Request::lookup('VcrIdTip', ''),
		'VcrNoIde' => Request::val('VcrNoIde', ''),
		'VcrCel' => Request::val('VcrCel', ''),
		'VcrCorEle' => Request::val('VcrCorEle', ''),
		'VcrIdMot' => Request::lookup('VcrIdMot', ''),
		'VcrRadSol' => Request::val('VcrRadSol', ''),
		'VcrFecSol' => Request::dateComponents('VcrFecSol', ''),
		'VcrObsDat' => br2nl(Request::val('VcrObsDat', '')),
		'VcrIdUbi' => Request::lookup('VcrIdUbi', ''),
		'VcrDir' => Request::val('VcrDir', ''),
		'VcrIdBarVe' => Request::lookup('VcrIdBarVe', ''),
		'VcrIdCorr' => Request::lookup('VcrIdCorr', ''),
		'VcrIdCom' => Request::lookup('VcrIdCom', ''),
		'VcrLat' => Request::val('VcrLat', ''),
		'VcrLon' => Request::val('VcrLon', ''),
		'VcrObsUbi' => br2nl(Request::val('VcrObsUbi', '')),
		'VcrIdFen' => Request::lookup('VcrIdFen', ''),
		'VcrDet' => br2nl(Request::val('VcrDet', '')),
		'VcrIdCar' => Request::lookup('VcrIdCar', ''),
		'VcrOtr' => Request::val('VcrOtr', ''),
		'VcrDesEve' => br2nl(Request::val('VcrDesEve', '')),
		'VcrIdEdi' => Request::lookup('VcrIdEdi', ''),
		'VcrNoPis' => Request::val('VcrNoPis', ''),
		'VcrObrCiv' => Request::val('VcrObrCiv', ''),
		'VcrEstEdi' => Request::val('VcrEstEdi', ''),
		'VcrIdAfe' => Request::lookup('VcrIdAfe', ''),
		'VcrObsEst' => br2nl(Request::val('VcrObsEst', '')),
		'VcrDanGrav' => Request::val('VcrDanGrav', ''),
		'VcrAnoCon' => Request::val('VcrAnoCon', ''),
		'VcrIdMat' => Request::lookup('VcrIdMat', ''),
		'VcrIdLes' => Request::lookup('VcrIdLes', ''),
		'VcrAyuHum' => Request::val('VcrAyuHum', ''),
		'VcrConAyu' => Request::val('VcrConAyu', ''),
		'VcrObs' => br2nl(Request::val('VcrObs', '')),
		'VcrCapRed' => Request::val('VcrCapRed', ''),
		'VcrIdCap' => Request::lookup('VcrIdCap', ''),
		'VcrOtrCap' => br2nl(Request::val('VcrOtrCap', '')),
		'VcrInf0a5F' => Request::val('VcrInf0a5F', ''),
		'VcrInf0a5M' => Request::val('VcrInf0a5M', ''),
		'VcrInf5a12F' => Request::val('VcrInf5a12F', ''),
		'VcrInf5a12M' => Request::val('VcrInf5a12M', ''),
		'VcrAd12a18F' => Request::val('VcrAd12a18F', ''),
		'VcrAd12a18M' => Request::val('VcrAd12a18M', ''),
		'VcrAd18a28F' => Request::val('VcrAd18a28F', ''),
		'VcrAd18a28M' => Request::val('VcrAd18a28M', ''),
		'VcrAd28a60F' => Request::val('VcrAd28a60F', ''),
		'VcrAd28a60M' => Request::val('VcrAd28a60M', ''),
		'VcrAdMay60F' => Request::val('VcrAdMay60F', ''),
		'VcrAdMay60M' => Request::val('VcrAdMay60M', ''),
		'VcrAfr' => Request::val('VcrAfr', ''),
		'VcrPal' => Request::val('VcrPal', ''),
		'VcrInd' => Request::val('VcrInd', ''),
		'VcrCau' => Request::val('VcrCau', ''),
		'VcrGit' => Request::val('VcrGit', ''),
		'VcrMes' => Request::val('VcrMes', ''),
		'VcrOtrPer' => br2nl(Request::val('VcrOtrPer', '')),
		'VcrPerNsNr' => Request::val('VcrPerNsNr', ''),
		'VcrTraCas' => Request::val('VcrTraCas', ''),
		'VcrIdTra1' => Request::lookup('VcrIdTra1', ''),
		'VcrdTra2' => Request::lookup('VcrdTra2', ''),
		'VcrIdTra3' => Request::lookup('VcrIdTra3', ''),
		'VcrIdTra4' => Request::lookup('VcrIdTra4', ''),
		'VcrRecLin' => Request::val('VcrRecLin', ''),
		'VcrRecLey' => Request::val('VcrRecLey', ''),
		'VcrRecPre' => Request::val('VcrRecPre', ''),
		'VcrRecAut' => Request::val('VcrRecAut', ''),
		'VcrDatPer' => Request::val('VcrDatPer', ''),
		'VcrUsoIma' => Request::val('VcrUsoIma', ''),
		'VcrUsoDat' => Request::val('VcrUsoDat', ''),
		'VcrAutCor' => Request::val('VcrAutCor', ''),
		'VcrIdSerP' => Request::lookup('VcrIdSerP', ''),
		'VcrIma' => Request::fileUpload('VcrIma', [
			'maxSize' => 8192000,
			'types' => 'jpg|jpeg|gif|png|webp',
			'noRename' => false,
			'dir' => '',
			'success' => function($name, $selected_id) {
			},
			'failure' => function($selected_id, $fileRemoved) {
				if(!strlen(Request::val('SelectedID'))) return '';

				/* for empty upload fields, when saving a copy of an existing record, copy the original upload field */
				return existing_value('natural', 'VcrIma', Request::val('SelectedID'));
			},
		]),
		'VcrVideo' => Request::fileUpload('VcrVideo', [
			'maxSize' => 8192000,
			'types' => 'mov|avi|swf|asf|wmv|mpg|mpeg|mp4|flv',
			'noRename' => false,
			'dir' => '',
			'success' => function($name, $selected_id) {
			},
			'failure' => function($selected_id, $fileRemoved) {
				if(!strlen(Request::val('SelectedID'))) return '';

				/* for empty upload fields, when saving a copy of an existing record, copy the original upload field */
				return existing_value('natural', 'VcrVideo', Request::val('SelectedID'));
			},
		]),
		'VcrDoc' => Request::fileUpload('VcrDoc', [
			'maxSize' => 2048000,
			'types' => 'txt|doc|docx|docm|odt|pdf|rtf',
			'noRename' => false,
			'dir' => '',
			'success' => function($name, $selected_id) {
			},
			'failure' => function($selected_id, $fileRemoved) {
				if(!strlen(Request::val('SelectedID'))) return '';

				/* for empty upload fields, when saving a copy of an existing record, copy the original upload field */
				return existing_value('natural', 'VcrDoc', Request::val('SelectedID'));
			},
		]),
	];

	if($data['VcrIdSol'] === '') {
		echo StyleSheet() . "\n\n<div class=\"alert alert-danger\">{$Translation['error:']} 'TIPO SOLICITUD:': {$Translation['field not null']}<br><br>";
		echo '<a href="" onclick="history.go(-1); return false;">' . $Translation['< back'] . '</a></div>';
		exit;
	}
	if($data['VcrNomAti'] === '') {
		echo StyleSheet() . "\n\n<div class=\"alert alert-danger\">{$Translation['error:']} 'NOMBRE PERSONA ATIENDE VISITA:': {$Translation['field not null']}<br><br>";
		echo '<a href="" onclick="history.go(-1); return false;">' . $Translation['< back'] . '</a></div>';
		exit;
	}
	if($data['VcrIdTip'] === '') {
		echo StyleSheet() . "\n\n<div class=\"alert alert-danger\">{$Translation['error:']} 'TIPO IDENTIFICACI&#211;N:': {$Translation['field not null']}<br><br>";
		echo '<a href="" onclick="history.go(-1); return false;">' . $Translation['< back'] . '</a></div>';
		exit;
	}
	if($data['VcrNoIde'] === '') {
		echo StyleSheet() . "\n\n<div class=\"alert alert-danger\">{$Translation['error:']} 'N&#218;MERO IDENTIFICACI&#211;N:': {$Translation['field not null']}<br><br>";
		echo '<a href="" onclick="history.go(-1); return false;">' . $Translation['< back'] . '</a></div>';
		exit;
	}
	if($data['VcrIdMot'] === '') {
		echo StyleSheet() . "\n\n<div class=\"alert alert-danger\">{$Translation['error:']} 'MOTIVO VISITA:': {$Translation['field not null']}<br><br>";
		echo '<a href="" onclick="history.go(-1); return false;">' . $Translation['< back'] . '</a></div>';
		exit;
	}
	if($data['VcrIdUbi'] === '') {
		echo StyleSheet() . "\n\n<div class=\"alert alert-danger\">{$Translation['error:']} 'UBICACION:': {$Translation['field not null']}<br><br>";
		echo '<a href="" onclick="history.go(-1); return false;">' . $Translation['< back'] . '</a></div>';
		exit;
	}
	if($data['VcrDir'] === '') {
		echo StyleSheet() . "\n\n<div class=\"alert alert-danger\">{$Translation['error:']} 'DIRECCION:': {$Translation['field not null']}<br><br>";
		echo '<a href="" onclick="history.go(-1); return false;">' . $Translation['< back'] . '</a></div>';
		exit;
	}
	if($data['VcrLat'] === '') {
		echo StyleSheet() . "\n\n<div class=\"alert alert-danger\">{$Translation['error:']} 'LATITUD:': {$Translation['field not null']}<br><br>";
		echo '<a href="" onclick="history.go(-1); return false;">' . $Translation['< back'] . '</a></div>';
		exit;
	}
	if($data['VcrLon'] === '') {
		echo StyleSheet() . "\n\n<div class=\"alert alert-danger\">{$Translation['error:']} 'LONGITUD:': {$Translation['field not null']}<br><br>";
		echo '<a href="" onclick="history.go(-1); return false;">' . $Translation['< back'] . '</a></div>';
		exit;
	}
	if($data['VcrIdFen'] === '') {
		echo StyleSheet() . "\n\n<div class=\"alert alert-danger\">{$Translation['error:']} 'TIPO DE FEN&#211;MENO:': {$Translation['field not null']}<br><br>";
		echo '<a href="" onclick="history.go(-1); return false;">' . $Translation['< back'] . '</a></div>';
		exit;
	}
	if($data['VcrIdCar'] === '') {
		echo StyleSheet() . "\n\n<div class=\"alert alert-danger\">{$Translation['error:']} 'CARACTER&#205;STICAS DEL EVENTO:': {$Translation['field not null']}<br><br>";
		echo '<a href="" onclick="history.go(-1); return false;">' . $Translation['< back'] . '</a></div>';
		exit;
	}
	if($data['VcrAyuHum'] === '') {
		echo StyleSheet() . "\n\n<div class=\"alert alert-danger\">{$Translation['error:']} 'AYUDA HUMANITARIA:': {$Translation['field not null']}<br><br>";
		echo '<a href="" onclick="history.go(-1); return false;">' . $Translation['< back'] . '</a></div>';
		exit;
	}
	if($data['VcrTraCas'] === '') {
		echo StyleSheet() . "\n\n<div class=\"alert alert-danger\">{$Translation['error:']} 'TRASLADO CASO:': {$Translation['field not null']}<br><br>";
		echo '<a href="" onclick="history.go(-1); return false;">' . $Translation['< back'] . '</a></div>';
		exit;
	}
	if($data['VcrRecLin'] === '') {
		echo StyleSheet() . "\n\n<div class=\"alert alert-danger\">{$Translation['error:']} 'RECOMENDACION LINEA EMERGENCIA:': {$Translation['field not null']}<br><br>";
		echo '<a href="" onclick="history.go(-1); return false;">' . $Translation['< back'] . '</a></div>';
		exit;
	}
	if($data['VcrRecLey'] === '') {
		echo StyleSheet() . "\n\n<div class=\"alert alert-danger\">{$Translation['error:']} 'RECOMENDACION LEY 1523:': {$Translation['field not null']}<br><br>";
		echo '<a href="" onclick="history.go(-1); return false;">' . $Translation['< back'] . '</a></div>';
		exit;
	}
	if($data['VcrRecPre'] === '') {
		echo StyleSheet() . "\n\n<div class=\"alert alert-danger\">{$Translation['error:']} 'RECOMENDACION PRINCIPIO PRECAUCION:': {$Translation['field not null']}<br><br>";
		echo '<a href="" onclick="history.go(-1); return false;">' . $Translation['< back'] . '</a></div>';
		exit;
	}
	if($data['VcrRecAut'] === '') {
		echo StyleSheet() . "\n\n<div class=\"alert alert-danger\">{$Translation['error:']} 'RECOMENDACIONES PRINCIPIO AUTOCONSERVACION:': {$Translation['field not null']}<br><br>";
		echo '<a href="" onclick="history.go(-1); return false;">' . $Translation['< back'] . '</a></div>';
		exit;
	}
	if($data['VcrDatPer'] === '') {
		echo StyleSheet() . "\n\n<div class=\"alert alert-danger\">{$Translation['error:']} 'DATOS PERSONALES:': {$Translation['field not null']}<br><br>";
		echo '<a href="" onclick="history.go(-1); return false;">' . $Translation['< back'] . '</a></div>';
		exit;
	}
	if($data['VcrUsoIma'] === '') {
		echo StyleSheet() . "\n\n<div class=\"alert alert-danger\">{$Translation['error:']} 'USO DE IMAGENES:': {$Translation['field not null']}<br><br>";
		echo '<a href="" onclick="history.go(-1); return false;">' . $Translation['< back'] . '</a></div>';
		exit;
	}
	if($data['VcrUsoDat'] === '') {
		echo StyleSheet() . "\n\n<div class=\"alert alert-danger\">{$Translation['error:']} 'USO DATOS PERSONALES:': {$Translation['field not null']}<br><br>";
		echo '<a href="" onclick="history.go(-1); return false;">' . $Translation['< back'] . '</a></div>';
		exit;
	}
	if($data['VcrAutCor'] === '') {
		echo StyleSheet() . "\n\n<div class=\"alert alert-danger\">{$Translation['error:']} 'AUTORIZACION CORREO ELECTR&#211;NICO:': {$Translation['field not null']}<br><br>";
		echo '<a href="" onclick="history.go(-1); return false;">' . $Translation['< back'] . '</a></div>';
		exit;
	}
	if($data['VcrIdSerP'] === '') {
		echo StyleSheet() . "\n\n<div class=\"alert alert-danger\">{$Translation['error:']} 'FUNCIONARIO / CONTRATISTA:': {$Translation['field not null']}<br><br>";
		echo '<a href="" onclick="history.go(-1); return false;">' . $Translation['< back'] . '</a></div>';
		exit;
	}

	// hook: natural_before_insert
	if(function_exists('natural_before_insert')) {
		$args = [];
		if(!natural_before_insert($data, getMemberInfo(), $args)) {
			if(isset($args['error_message'])) $error_message = $args['error_message'];
			return false;
		}
	}

	$error = '';
	// set empty fields to NULL
	$data = array_map(function($v) { return ($v === '' ? NULL : $v); }, $data);
	insert('natural', backtick_keys_once($data), $error);
	if($error) {
		$error_message = $error;
		return false;
	}

	$recID = db_insert_id(db_link());

	update_calc_fields('natural', $recID, calculated_fields()['natural']);

	// hook: natural_after_insert
	if(function_exists('natural_after_insert')) {
		$res = sql("SELECT * FROM `natural` WHERE `VcrId`='" . makeSafe($recID, false) . "' LIMIT 1", $eo);
		if($row = db_fetch_assoc($res)) {
			$data = array_map('makeSafe', $row);
		}
		$data['selectedID'] = makeSafe($recID, false);
		$args = [];
		if(!natural_after_insert($data, getMemberInfo(), $args)) { return $recID; }
	}

	// mm: save ownership data
	set_record_owner('natural', $recID, getLoggedMemberID());

	// if this record is a copy of another record, copy children if applicable
	if(strlen(Request::val('SelectedID'))) natural_copy_children($recID, Request::val('SelectedID'));

	return $recID;
}

function natural_copy_children($destination_id, $source_id) {
	global $Translation;
	$requests = []; // array of curl handlers for launching insert requests
	$eo = ['silentErrors' => true];
	$safe_sid = makeSafe($source_id);

	// launch requests, asynchronously
	curl_batch($requests);
}

function natural_delete($selected_id, $AllowDeleteOfParents = false, $skipChecks = false) {
	// insure referential integrity ...
	global $Translation;
	$selected_id = makeSafe($selected_id);

	// mm: can member delete record?
	if(!check_record_permission('natural', $selected_id, 'delete')) {
		return $Translation['You don\'t have enough permissions to delete this record'];
	}

	// hook: natural_before_delete
	if(function_exists('natural_before_delete')) {
		$args = [];
		if(!natural_before_delete($selected_id, $skipChecks, getMemberInfo(), $args))
			return $Translation['Couldn\'t delete this record'] . (
				!empty($args['error_message']) ?
					'<div class="text-bold">' . strip_tags($args['error_message']) . '</div>'
					: '' 
			);
	}

	// delete file stored in the 'VcrIma' field
	$res = sql("SELECT `VcrIma` FROM `natural` WHERE `VcrId`='{$selected_id}'", $eo);
	if($row = @db_fetch_row($res)) {
		if($row[0] != '') {
			@unlink(getUploadDir('') . $row[0]);
		}
	}

	// delete file stored in the 'VcrVideo' field
	$res = sql("SELECT `VcrVideo` FROM `natural` WHERE `VcrId`='{$selected_id}'", $eo);
	if($row = @db_fetch_row($res)) {
		if($row[0] != '') {
			@unlink(getUploadDir('') . $row[0]);
		}
	}

	// delete file stored in the 'VcrDoc' field
	$res = sql("SELECT `VcrDoc` FROM `natural` WHERE `VcrId`='{$selected_id}'", $eo);
	if($row = @db_fetch_row($res)) {
		if($row[0] != '') {
			@unlink(getUploadDir('') . $row[0]);
		}
	}

	sql("DELETE FROM `natural` WHERE `VcrId`='{$selected_id}'", $eo);

	// hook: natural_after_delete
	if(function_exists('natural_after_delete')) {
		$args = [];
		natural_after_delete($selected_id, getMemberInfo(), $args);
	}

	// mm: delete ownership data
	sql("DELETE FROM `membership_userrecords` WHERE `tableName`='natural' AND `pkValue`='{$selected_id}'", $eo);
}

function natural_update(&$selected_id, &$error_message = '') {
	global $Translation;

	// mm: can member edit record?
	if(!check_record_permission('natural', $selected_id, 'edit')) return false;

	$data = [
		'VcrIdSol' => Request::lookup('VcrIdSol', ''),
		'VcrFecVis' => Request::dateComponents('VcrFecVis', ''),
		'VcrNomAti' => Request::val('VcrNomAti', ''),
		'VcrIdTip' => Request::lookup('VcrIdTip', ''),
		'VcrNoIde' => Request::val('VcrNoIde', ''),
		'VcrCel' => Request::val('VcrCel', ''),
		'VcrCorEle' => Request::val('VcrCorEle', ''),
		'VcrIdMot' => Request::lookup('VcrIdMot', ''),
		'VcrRadSol' => Request::val('VcrRadSol', ''),
		'VcrFecSol' => Request::dateComponents('VcrFecSol', ''),
		'VcrObsDat' => br2nl(Request::val('VcrObsDat', '')),
		'VcrIdUbi' => Request::lookup('VcrIdUbi', ''),
		'VcrDir' => Request::val('VcrDir', ''),
		'VcrIdBarVe' => Request::lookup('VcrIdBarVe', ''),
		'VcrIdCorr' => Request::lookup('VcrIdCorr', ''),
		'VcrIdCom' => Request::lookup('VcrIdCom', ''),
		'VcrLat' => Request::val('VcrLat', ''),
		'VcrLon' => Request::val('VcrLon', ''),
		'VcrObsUbi' => br2nl(Request::val('VcrObsUbi', '')),
		'VcrIdFen' => Request::lookup('VcrIdFen', ''),
		'VcrDet' => br2nl(Request::val('VcrDet', '')),
		'VcrIdCar' => Request::lookup('VcrIdCar', ''),
		'VcrOtr' => Request::val('VcrOtr', ''),
		'VcrDesEve' => br2nl(Request::val('VcrDesEve', '')),
		'VcrIdEdi' => Request::lookup('VcrIdEdi', ''),
		'VcrNoPis' => Request::val('VcrNoPis', ''),
		'VcrObrCiv' => Request::val('VcrObrCiv', ''),
		'VcrEstEdi' => Request::val('VcrEstEdi', ''),
		'VcrIdAfe' => Request::lookup('VcrIdAfe', ''),
		'VcrObsEst' => br2nl(Request::val('VcrObsEst', '')),
		'VcrDanGrav' => Request::val('VcrDanGrav', ''),
		'VcrAnoCon' => Request::val('VcrAnoCon', ''),
		'VcrIdMat' => Request::lookup('VcrIdMat', ''),
		'VcrIdLes' => Request::lookup('VcrIdLes', ''),
		'VcrAyuHum' => Request::val('VcrAyuHum', ''),
		'VcrConAyu' => Request::val('VcrConAyu', ''),
		'VcrObs' => br2nl(Request::val('VcrObs', '')),
		'VcrCapRed' => Request::val('VcrCapRed', ''),
		'VcrIdCap' => Request::lookup('VcrIdCap', ''),
		'VcrOtrCap' => br2nl(Request::val('VcrOtrCap', '')),
		'VcrInf0a5F' => Request::val('VcrInf0a5F', ''),
		'VcrInf0a5M' => Request::val('VcrInf0a5M', ''),
		'VcrInf5a12F' => Request::val('VcrInf5a12F', ''),
		'VcrInf5a12M' => Request::val('VcrInf5a12M', ''),
		'VcrAd12a18F' => Request::val('VcrAd12a18F', ''),
		'VcrAd12a18M' => Request::val('VcrAd12a18M', ''),
		'VcrAd18a28F' => Request::val('VcrAd18a28F', ''),
		'VcrAd18a28M' => Request::val('VcrAd18a28M', ''),
		'VcrAd28a60F' => Request::val('VcrAd28a60F', ''),
		'VcrAd28a60M' => Request::val('VcrAd28a60M', ''),
		'VcrAdMay60F' => Request::val('VcrAdMay60F', ''),
		'VcrAdMay60M' => Request::val('VcrAdMay60M', ''),
		'VcrAfr' => Request::val('VcrAfr', ''),
		'VcrPal' => Request::val('VcrPal', ''),
		'VcrInd' => Request::val('VcrInd', ''),
		'VcrCau' => Request::val('VcrCau', ''),
		'VcrGit' => Request::val('VcrGit', ''),
		'VcrMes' => Request::val('VcrMes', ''),
		'VcrOtrPer' => br2nl(Request::val('VcrOtrPer', '')),
		'VcrPerNsNr' => Request::val('VcrPerNsNr', ''),
		'VcrTraCas' => Request::val('VcrTraCas', ''),
		'VcrIdTra1' => Request::lookup('VcrIdTra1', ''),
		'VcrdTra2' => Request::lookup('VcrdTra2', ''),
		'VcrIdTra3' => Request::lookup('VcrIdTra3', ''),
		'VcrIdTra4' => Request::lookup('VcrIdTra4', ''),
		'VcrRecLin' => Request::val('VcrRecLin', ''),
		'VcrRecLey' => Request::val('VcrRecLey', ''),
		'VcrRecPre' => Request::val('VcrRecPre', ''),
		'VcrRecAut' => Request::val('VcrRecAut', ''),
		'VcrDatPer' => Request::val('VcrDatPer', ''),
		'VcrUsoIma' => Request::val('VcrUsoIma', ''),
		'VcrUsoDat' => Request::val('VcrUsoDat', ''),
		'VcrAutCor' => Request::val('VcrAutCor', ''),
		'VcrIdSerP' => Request::lookup('VcrIdSerP', ''),
		'VcrIma' => Request::fileUpload('VcrIma', [
			'maxSize' => 8192000,
			'types' => 'jpg|jpeg|gif|png|webp',
			'noRename' => false,
			'dir' => '',
			'id' => $selected_id,
			'success' => function($name, $selected_id) {
			},
			'removeOnSuccess' => true,
			'removeOnRequest' => true,
			'remove' => function($selected_id) {
				// delete old file from server
				$oldFile = existing_value('natural', 'VcrIma', $selected_id);
				if(!$oldFile) return;

				@unlink(getUploadDir('') . $oldFile);
			},
			'failure' => function($selected_id, $fileRemoved) {
				if($fileRemoved) return '';
				return existing_value('natural', 'VcrIma', $selected_id);
			},
		]),
		'VcrVideo' => Request::fileUpload('VcrVideo', [
			'maxSize' => 8192000,
			'types' => 'mov|avi|swf|asf|wmv|mpg|mpeg|mp4|flv',
			'noRename' => false,
			'dir' => '',
			'id' => $selected_id,
			'success' => function($name, $selected_id) {
			},
			'removeOnSuccess' => true,
			'removeOnRequest' => true,
			'remove' => function($selected_id) {
				// delete old file from server
				$oldFile = existing_value('natural', 'VcrVideo', $selected_id);
				if(!$oldFile) return;

				@unlink(getUploadDir('') . $oldFile);
			},
			'failure' => function($selected_id, $fileRemoved) {
				if($fileRemoved) return '';
				return existing_value('natural', 'VcrVideo', $selected_id);
			},
		]),
		'VcrDoc' => Request::fileUpload('VcrDoc', [
			'maxSize' => 2048000,
			'types' => 'txt|doc|docx|docm|odt|pdf|rtf',
			'noRename' => false,
			'dir' => '',
			'id' => $selected_id,
			'success' => function($name, $selected_id) {
			},
			'removeOnSuccess' => true,
			'removeOnRequest' => true,
			'remove' => function($selected_id) {
				// delete old file from server
				$oldFile = existing_value('natural', 'VcrDoc', $selected_id);
				if(!$oldFile) return;

				@unlink(getUploadDir('') . $oldFile);
			},
			'failure' => function($selected_id, $fileRemoved) {
				if($fileRemoved) return '';
				return existing_value('natural', 'VcrDoc', $selected_id);
			},
		]),
	];

	if($data['VcrIdSol'] === '') {
		echo StyleSheet() . "\n\n<div class=\"alert alert-danger\">{$Translation['error:']} 'TIPO SOLICITUD:': {$Translation['field not null']}<br><br>";
		echo '<a href="" onclick="history.go(-1); return false;">' . $Translation['< back'] . '</a></div>';
		exit;
	}
	if($data['VcrNomAti'] === '') {
		echo StyleSheet() . "\n\n<div class=\"alert alert-danger\">{$Translation['error:']} 'NOMBRE PERSONA ATIENDE VISITA:': {$Translation['field not null']}<br><br>";
		echo '<a href="" onclick="history.go(-1); return false;">' . $Translation['< back'] . '</a></div>';
		exit;
	}
	if($data['VcrIdTip'] === '') {
		echo StyleSheet() . "\n\n<div class=\"alert alert-danger\">{$Translation['error:']} 'TIPO IDENTIFICACI&#211;N:': {$Translation['field not null']}<br><br>";
		echo '<a href="" onclick="history.go(-1); return false;">' . $Translation['< back'] . '</a></div>';
		exit;
	}
	if($data['VcrNoIde'] === '') {
		echo StyleSheet() . "\n\n<div class=\"alert alert-danger\">{$Translation['error:']} 'N&#218;MERO IDENTIFICACI&#211;N:': {$Translation['field not null']}<br><br>";
		echo '<a href="" onclick="history.go(-1); return false;">' . $Translation['< back'] . '</a></div>';
		exit;
	}
	if($data['VcrIdMot'] === '') {
		echo StyleSheet() . "\n\n<div class=\"alert alert-danger\">{$Translation['error:']} 'MOTIVO VISITA:': {$Translation['field not null']}<br><br>";
		echo '<a href="" onclick="history.go(-1); return false;">' . $Translation['< back'] . '</a></div>';
		exit;
	}
	if($data['VcrIdUbi'] === '') {
		echo StyleSheet() . "\n\n<div class=\"alert alert-danger\">{$Translation['error:']} 'UBICACION:': {$Translation['field not null']}<br><br>";
		echo '<a href="" onclick="history.go(-1); return false;">' . $Translation['< back'] . '</a></div>';
		exit;
	}
	if($data['VcrDir'] === '') {
		echo StyleSheet() . "\n\n<div class=\"alert alert-danger\">{$Translation['error:']} 'DIRECCION:': {$Translation['field not null']}<br><br>";
		echo '<a href="" onclick="history.go(-1); return false;">' . $Translation['< back'] . '</a></div>';
		exit;
	}
	if($data['VcrLat'] === '') {
		echo StyleSheet() . "\n\n<div class=\"alert alert-danger\">{$Translation['error:']} 'LATITUD:': {$Translation['field not null']}<br><br>";
		echo '<a href="" onclick="history.go(-1); return false;">' . $Translation['< back'] . '</a></div>';
		exit;
	}
	if($data['VcrLon'] === '') {
		echo StyleSheet() . "\n\n<div class=\"alert alert-danger\">{$Translation['error:']} 'LONGITUD:': {$Translation['field not null']}<br><br>";
		echo '<a href="" onclick="history.go(-1); return false;">' . $Translation['< back'] . '</a></div>';
		exit;
	}
	if($data['VcrIdFen'] === '') {
		echo StyleSheet() . "\n\n<div class=\"alert alert-danger\">{$Translation['error:']} 'TIPO DE FEN&#211;MENO:': {$Translation['field not null']}<br><br>";
		echo '<a href="" onclick="history.go(-1); return false;">' . $Translation['< back'] . '</a></div>';
		exit;
	}
	if($data['VcrIdCar'] === '') {
		echo StyleSheet() . "\n\n<div class=\"alert alert-danger\">{$Translation['error:']} 'CARACTER&#205;STICAS DEL EVENTO:': {$Translation['field not null']}<br><br>";
		echo '<a href="" onclick="history.go(-1); return false;">' . $Translation['< back'] . '</a></div>';
		exit;
	}
	if($data['VcrAyuHum'] === '') {
		echo StyleSheet() . "\n\n<div class=\"alert alert-danger\">{$Translation['error:']} 'AYUDA HUMANITARIA:': {$Translation['field not null']}<br><br>";
		echo '<a href="" onclick="history.go(-1); return false;">' . $Translation['< back'] . '</a></div>';
		exit;
	}
	if($data['VcrTraCas'] === '') {
		echo StyleSheet() . "\n\n<div class=\"alert alert-danger\">{$Translation['error:']} 'TRASLADO CASO:': {$Translation['field not null']}<br><br>";
		echo '<a href="" onclick="history.go(-1); return false;">' . $Translation['< back'] . '</a></div>';
		exit;
	}
	if($data['VcrRecLin'] === '') {
		echo StyleSheet() . "\n\n<div class=\"alert alert-danger\">{$Translation['error:']} 'RECOMENDACION LINEA EMERGENCIA:': {$Translation['field not null']}<br><br>";
		echo '<a href="" onclick="history.go(-1); return false;">' . $Translation['< back'] . '</a></div>';
		exit;
	}
	if($data['VcrRecLey'] === '') {
		echo StyleSheet() . "\n\n<div class=\"alert alert-danger\">{$Translation['error:']} 'RECOMENDACION LEY 1523:': {$Translation['field not null']}<br><br>";
		echo '<a href="" onclick="history.go(-1); return false;">' . $Translation['< back'] . '</a></div>';
		exit;
	}
	if($data['VcrRecPre'] === '') {
		echo StyleSheet() . "\n\n<div class=\"alert alert-danger\">{$Translation['error:']} 'RECOMENDACION PRINCIPIO PRECAUCION:': {$Translation['field not null']}<br><br>";
		echo '<a href="" onclick="history.go(-1); return false;">' . $Translation['< back'] . '</a></div>';
		exit;
	}
	if($data['VcrRecAut'] === '') {
		echo StyleSheet() . "\n\n<div class=\"alert alert-danger\">{$Translation['error:']} 'RECOMENDACIONES PRINCIPIO AUTOCONSERVACION:': {$Translation['field not null']}<br><br>";
		echo '<a href="" onclick="history.go(-1); return false;">' . $Translation['< back'] . '</a></div>';
		exit;
	}
	if($data['VcrDatPer'] === '') {
		echo StyleSheet() . "\n\n<div class=\"alert alert-danger\">{$Translation['error:']} 'DATOS PERSONALES:': {$Translation['field not null']}<br><br>";
		echo '<a href="" onclick="history.go(-1); return false;">' . $Translation['< back'] . '</a></div>';
		exit;
	}
	if($data['VcrUsoIma'] === '') {
		echo StyleSheet() . "\n\n<div class=\"alert alert-danger\">{$Translation['error:']} 'USO DE IMAGENES:': {$Translation['field not null']}<br><br>";
		echo '<a href="" onclick="history.go(-1); return false;">' . $Translation['< back'] . '</a></div>';
		exit;
	}
	if($data['VcrUsoDat'] === '') {
		echo StyleSheet() . "\n\n<div class=\"alert alert-danger\">{$Translation['error:']} 'USO DATOS PERSONALES:': {$Translation['field not null']}<br><br>";
		echo '<a href="" onclick="history.go(-1); return false;">' . $Translation['< back'] . '</a></div>';
		exit;
	}
	if($data['VcrAutCor'] === '') {
		echo StyleSheet() . "\n\n<div class=\"alert alert-danger\">{$Translation['error:']} 'AUTORIZACION CORREO ELECTR&#211;NICO:': {$Translation['field not null']}<br><br>";
		echo '<a href="" onclick="history.go(-1); return false;">' . $Translation['< back'] . '</a></div>';
		exit;
	}
	if($data['VcrIdSerP'] === '') {
		echo StyleSheet() . "\n\n<div class=\"alert alert-danger\">{$Translation['error:']} 'FUNCIONARIO / CONTRATISTA:': {$Translation['field not null']}<br><br>";
		echo '<a href="" onclick="history.go(-1); return false;">' . $Translation['< back'] . '</a></div>';
		exit;
	}
	// get existing values
	$old_data = getRecord('natural', $selected_id);
	if(is_array($old_data)) {
		$old_data = array_map('makeSafe', $old_data);
		$old_data['selectedID'] = makeSafe($selected_id);
	}

	$data['selectedID'] = makeSafe($selected_id);

	// hook: natural_before_update
	if(function_exists('natural_before_update')) {
		$args = ['old_data' => $old_data];
		if(!natural_before_update($data, getMemberInfo(), $args)) {
			if(isset($args['error_message'])) $error_message = $args['error_message'];
			return false;
		}
	}

	$set = $data; unset($set['selectedID']);
	foreach ($set as $field => $value) {
		$set[$field] = ($value !== '' && $value !== NULL) ? $value : NULL;
	}

	if(!update(
		'natural', 
		backtick_keys_once($set), 
		['`VcrId`' => $selected_id], 
		$error_message
	)) {
		echo $error_message;
		echo '<a href="natural_view.php?SelectedID=' . urlencode($selected_id) . "\">{$Translation['< back']}</a>";
		exit;
	}


	$eo = ['silentErrors' => true];

	update_calc_fields('natural', $data['selectedID'], calculated_fields()['natural']);

	// hook: natural_after_update
	if(function_exists('natural_after_update')) {
		$res = sql("SELECT * FROM `natural` WHERE `VcrId`='{$data['selectedID']}' LIMIT 1", $eo);
		if($row = db_fetch_assoc($res)) $data = array_map('makeSafe', $row);

		$data['selectedID'] = $data['VcrId'];
		$args = ['old_data' => $old_data];
		if(!natural_after_update($data, getMemberInfo(), $args)) return;
	}

	// mm: update ownership data
	sql("UPDATE `membership_userrecords` SET `dateUpdated`='" . time() . "' WHERE `tableName`='natural' AND `pkValue`='" . makeSafe($selected_id) . "'", $eo);
}

function natural_form($selected_id = '', $AllowUpdate = 1, $AllowInsert = 1, $AllowDelete = 1, $separateDV = 0, $TemplateDV = '', $TemplateDVP = '') {
	// function to return an editable form for a table records
	// and fill it with data of record whose ID is $selected_id. If $selected_id
	// is empty, an empty form is shown, with only an 'Add New'
	// button displayed.

	global $Translation;
	$eo = ['silentErrors' => true];
	$noUploads = null;
	$row = $urow = $jsReadOnly = $jsEditable = $lookups = null;

	$noSaveAsCopy = false;

	// mm: get table permissions
	$arrPerm = getTablePermissions('natural');
	if(!$arrPerm['insert'] && $selected_id == '')
		// no insert permission and no record selected
		// so show access denied error unless TVDV
		return $separateDV ? $Translation['tableAccessDenied'] : '';
	$AllowInsert = ($arrPerm['insert'] ? true : false);
	// print preview?
	$dvprint = false;
	if(strlen($selected_id) && Request::val('dvprint_x') != '') {
		$dvprint = true;
	}

	$filterer_VcrIdSol = Request::val('filterer_VcrIdSol');
	$filterer_VcrIdTip = Request::val('filterer_VcrIdTip');
	$filterer_VcrIdMot = Request::val('filterer_VcrIdMot');
	$filterer_VcrIdUbi = Request::val('filterer_VcrIdUbi');
	$filterer_VcrIdBarVe = Request::val('filterer_VcrIdBarVe');
	$filterer_VcrIdCorr = Request::val('filterer_VcrIdCorr');
	$filterer_VcrIdCom = Request::val('filterer_VcrIdCom');
	$filterer_VcrIdFen = Request::val('filterer_VcrIdFen');
	$filterer_VcrIdCar = Request::val('filterer_VcrIdCar');
	$filterer_VcrIdEdi = Request::val('filterer_VcrIdEdi');
	$filterer_VcrIdAfe = Request::val('filterer_VcrIdAfe');
	$filterer_VcrIdMat = Request::val('filterer_VcrIdMat');
	$filterer_VcrIdLes = Request::val('filterer_VcrIdLes');
	$filterer_VcrIdCap = Request::val('filterer_VcrIdCap');
	$filterer_VcrIdTra1 = Request::val('filterer_VcrIdTra1');
	$filterer_VcrdTra2 = Request::val('filterer_VcrdTra2');
	$filterer_VcrIdTra3 = Request::val('filterer_VcrIdTra3');
	$filterer_VcrIdTra4 = Request::val('filterer_VcrIdTra4');
	$filterer_VcrIdSerP = Request::val('filterer_VcrIdSerP');

	// populate filterers, starting from children to grand-parents

	// unique random identifier
	$rnd1 = ($dvprint ? rand(1000000, 9999999) : '');
	// combobox: VcrIdSol
	$combo_VcrIdSol = new DataCombo;
	// combobox: VcrFecVis
	$combo_VcrFecVis = new DateCombo;
	$combo_VcrFecVis->DateFormat = "dmy";
	$combo_VcrFecVis->MinYear = defined('natural.VcrFecVis.MinYear') ? constant('natural.VcrFecVis.MinYear') : 1900;
	$combo_VcrFecVis->MaxYear = defined('natural.VcrFecVis.MaxYear') ? constant('natural.VcrFecVis.MaxYear') : 2100;
	$combo_VcrFecVis->DefaultDate = parseMySQLDate('', '');
	$combo_VcrFecVis->MonthNames = $Translation['month names'];
	$combo_VcrFecVis->NamePrefix = 'VcrFecVis';
	// combobox: VcrIdTip
	$combo_VcrIdTip = new DataCombo;
	// combobox: VcrIdMot
	$combo_VcrIdMot = new DataCombo;
	// combobox: VcrFecSol
	$combo_VcrFecSol = new DateCombo;
	$combo_VcrFecSol->DateFormat = "dmy";
	$combo_VcrFecSol->MinYear = defined('natural.VcrFecSol.MinYear') ? constant('natural.VcrFecSol.MinYear') : 1900;
	$combo_VcrFecSol->MaxYear = defined('natural.VcrFecSol.MaxYear') ? constant('natural.VcrFecSol.MaxYear') : 2100;
	$combo_VcrFecSol->DefaultDate = parseMySQLDate('', '');
	$combo_VcrFecSol->MonthNames = $Translation['month names'];
	$combo_VcrFecSol->NamePrefix = 'VcrFecSol';
	// combobox: VcrIdUbi
	$combo_VcrIdUbi = new DataCombo;
	// combobox: VcrIdBarVe
	$combo_VcrIdBarVe = new DataCombo;
	// combobox: VcrIdCorr
	$combo_VcrIdCorr = new DataCombo;
	// combobox: VcrIdCom
	$combo_VcrIdCom = new DataCombo;
	// combobox: VcrIdFen
	$combo_VcrIdFen = new DataCombo;
	// combobox: VcrIdCar
	$combo_VcrIdCar = new DataCombo;
	// combobox: VcrIdEdi
	$combo_VcrIdEdi = new DataCombo;
	// combobox: VcrEstEdi
	$combo_VcrEstEdi = new Combo;
	$combo_VcrEstEdi->ListType = 0;
	$combo_VcrEstEdi->MultipleSeparator = ', ';
	$combo_VcrEstEdi->ListBoxHeight = 10;
	$combo_VcrEstEdi->RadiosPerLine = 1;
	if(is_file(__DIR__ . '/hooks/natural.VcrEstEdi.csv')) {
		$VcrEstEdi_data = addslashes(implode('', @file(__DIR__ . '/hooks/natural.VcrEstEdi.csv')));
		$combo_VcrEstEdi->ListItem = array_trim(explode('||', entitiesToUTF8(convertLegacyOptions($VcrEstEdi_data))));
		$combo_VcrEstEdi->ListData = $combo_VcrEstEdi->ListItem;
	} else {
		$combo_VcrEstEdi->ListItem = array_trim(explode('||', entitiesToUTF8(convertLegacyOptions("BUENO;;REGULAR;;MALO"))));
		$combo_VcrEstEdi->ListData = $combo_VcrEstEdi->ListItem;
	}
	$combo_VcrEstEdi->SelectName = 'VcrEstEdi';
	// combobox: VcrIdAfe
	$combo_VcrIdAfe = new DataCombo;
	// combobox: VcrDanGrav
	$combo_VcrDanGrav = new Combo;
	$combo_VcrDanGrav->ListType = 0;
	$combo_VcrDanGrav->MultipleSeparator = ', ';
	$combo_VcrDanGrav->ListBoxHeight = 10;
	$combo_VcrDanGrav->RadiosPerLine = 1;
	if(is_file(__DIR__ . '/hooks/natural.VcrDanGrav.csv')) {
		$VcrDanGrav_data = addslashes(implode('', @file(__DIR__ . '/hooks/natural.VcrDanGrav.csv')));
		$combo_VcrDanGrav->ListItem = array_trim(explode('||', entitiesToUTF8(convertLegacyOptions($VcrDanGrav_data))));
		$combo_VcrDanGrav->ListData = $combo_VcrDanGrav->ListItem;
	} else {
		$combo_VcrDanGrav->ListItem = array_trim(explode('||', entitiesToUTF8(convertLegacyOptions("SI;;NO"))));
		$combo_VcrDanGrav->ListData = $combo_VcrDanGrav->ListItem;
	}
	$combo_VcrDanGrav->SelectName = 'VcrDanGrav';
	// combobox: VcrIdMat
	$combo_VcrIdMat = new DataCombo;
	// combobox: VcrIdLes
	$combo_VcrIdLes = new DataCombo;
	// combobox: VcrAyuHum
	$combo_VcrAyuHum = new Combo;
	$combo_VcrAyuHum->ListType = 0;
	$combo_VcrAyuHum->MultipleSeparator = ', ';
	$combo_VcrAyuHum->ListBoxHeight = 10;
	$combo_VcrAyuHum->RadiosPerLine = 1;
	if(is_file(__DIR__ . '/hooks/natural.VcrAyuHum.csv')) {
		$VcrAyuHum_data = addslashes(implode('', @file(__DIR__ . '/hooks/natural.VcrAyuHum.csv')));
		$combo_VcrAyuHum->ListItem = array_trim(explode('||', entitiesToUTF8(convertLegacyOptions($VcrAyuHum_data))));
		$combo_VcrAyuHum->ListData = $combo_VcrAyuHum->ListItem;
	} else {
		$combo_VcrAyuHum->ListItem = array_trim(explode('||', entitiesToUTF8(convertLegacyOptions("NO;;SI"))));
		$combo_VcrAyuHum->ListData = $combo_VcrAyuHum->ListItem;
	}
	$combo_VcrAyuHum->SelectName = 'VcrAyuHum';
	$combo_VcrAyuHum->AllowNull = false;
	// combobox: VcrCapRed
	$combo_VcrCapRed = new Combo;
	$combo_VcrCapRed->ListType = 0;
	$combo_VcrCapRed->MultipleSeparator = ', ';
	$combo_VcrCapRed->ListBoxHeight = 10;
	$combo_VcrCapRed->RadiosPerLine = 1;
	if(is_file(__DIR__ . '/hooks/natural.VcrCapRed.csv')) {
		$VcrCapRed_data = addslashes(implode('', @file(__DIR__ . '/hooks/natural.VcrCapRed.csv')));
		$combo_VcrCapRed->ListItem = array_trim(explode('||', entitiesToUTF8(convertLegacyOptions($VcrCapRed_data))));
		$combo_VcrCapRed->ListData = $combo_VcrCapRed->ListItem;
	} else {
		$combo_VcrCapRed->ListItem = array_trim(explode('||', entitiesToUTF8(convertLegacyOptions("SI;;NO"))));
		$combo_VcrCapRed->ListData = $combo_VcrCapRed->ListItem;
	}
	$combo_VcrCapRed->SelectName = 'VcrCapRed';
	// combobox: VcrIdCap
	$combo_VcrIdCap = new DataCombo;
	// combobox: VcrPerNsNr
	$combo_VcrPerNsNr = new Combo;
	$combo_VcrPerNsNr->ListType = 0;
	$combo_VcrPerNsNr->MultipleSeparator = ', ';
	$combo_VcrPerNsNr->ListBoxHeight = 10;
	$combo_VcrPerNsNr->RadiosPerLine = 1;
	if(is_file(__DIR__ . '/hooks/natural.VcrPerNsNr.csv')) {
		$VcrPerNsNr_data = addslashes(implode('', @file(__DIR__ . '/hooks/natural.VcrPerNsNr.csv')));
		$combo_VcrPerNsNr->ListItem = array_trim(explode('||', entitiesToUTF8(convertLegacyOptions($VcrPerNsNr_data))));
		$combo_VcrPerNsNr->ListData = $combo_VcrPerNsNr->ListItem;
	} else {
		$combo_VcrPerNsNr->ListItem = array_trim(explode('||', entitiesToUTF8(convertLegacyOptions("NS;;NR"))));
		$combo_VcrPerNsNr->ListData = $combo_VcrPerNsNr->ListItem;
	}
	$combo_VcrPerNsNr->SelectName = 'VcrPerNsNr';
	// combobox: VcrTraCas
	$combo_VcrTraCas = new Combo;
	$combo_VcrTraCas->ListType = 0;
	$combo_VcrTraCas->MultipleSeparator = ', ';
	$combo_VcrTraCas->ListBoxHeight = 10;
	$combo_VcrTraCas->RadiosPerLine = 1;
	if(is_file(__DIR__ . '/hooks/natural.VcrTraCas.csv')) {
		$VcrTraCas_data = addslashes(implode('', @file(__DIR__ . '/hooks/natural.VcrTraCas.csv')));
		$combo_VcrTraCas->ListItem = array_trim(explode('||', entitiesToUTF8(convertLegacyOptions($VcrTraCas_data))));
		$combo_VcrTraCas->ListData = $combo_VcrTraCas->ListItem;
	} else {
		$combo_VcrTraCas->ListItem = array_trim(explode('||', entitiesToUTF8(convertLegacyOptions("NO;;SI"))));
		$combo_VcrTraCas->ListData = $combo_VcrTraCas->ListItem;
	}
	$combo_VcrTraCas->SelectName = 'VcrTraCas';
	$combo_VcrTraCas->AllowNull = false;
	// combobox: VcrIdTra1
	$combo_VcrIdTra1 = new DataCombo;
	// combobox: VcrdTra2
	$combo_VcrdTra2 = new DataCombo;
	// combobox: VcrIdTra3
	$combo_VcrIdTra3 = new DataCombo;
	// combobox: VcrIdTra4
	$combo_VcrIdTra4 = new DataCombo;
	// combobox: VcrRecLin
	$combo_VcrRecLin = new Combo;
	$combo_VcrRecLin->ListType = 0;
	$combo_VcrRecLin->MultipleSeparator = ', ';
	$combo_VcrRecLin->ListBoxHeight = 10;
	$combo_VcrRecLin->RadiosPerLine = 1;
	if(is_file(__DIR__ . '/hooks/natural.VcrRecLin.csv')) {
		$VcrRecLin_data = addslashes(implode('', @file(__DIR__ . '/hooks/natural.VcrRecLin.csv')));
		$combo_VcrRecLin->ListItem = array_trim(explode('||', entitiesToUTF8(convertLegacyOptions($VcrRecLin_data))));
		$combo_VcrRecLin->ListData = $combo_VcrRecLin->ListItem;
	} else {
		$combo_VcrRecLin->ListItem = array_trim(explode('||', entitiesToUTF8(convertLegacyOptions("SI APLICA;;NO APLICA"))));
		$combo_VcrRecLin->ListData = $combo_VcrRecLin->ListItem;
	}
	$combo_VcrRecLin->SelectName = 'VcrRecLin';
	$combo_VcrRecLin->AllowNull = false;
	// combobox: VcrRecLey
	$combo_VcrRecLey = new Combo;
	$combo_VcrRecLey->ListType = 0;
	$combo_VcrRecLey->MultipleSeparator = ', ';
	$combo_VcrRecLey->ListBoxHeight = 10;
	$combo_VcrRecLey->RadiosPerLine = 1;
	if(is_file(__DIR__ . '/hooks/natural.VcrRecLey.csv')) {
		$VcrRecLey_data = addslashes(implode('', @file(__DIR__ . '/hooks/natural.VcrRecLey.csv')));
		$combo_VcrRecLey->ListItem = array_trim(explode('||', entitiesToUTF8(convertLegacyOptions($VcrRecLey_data))));
		$combo_VcrRecLey->ListData = $combo_VcrRecLey->ListItem;
	} else {
		$combo_VcrRecLey->ListItem = array_trim(explode('||', entitiesToUTF8(convertLegacyOptions("SI APLICA;;NO APLICA"))));
		$combo_VcrRecLey->ListData = $combo_VcrRecLey->ListItem;
	}
	$combo_VcrRecLey->SelectName = 'VcrRecLey';
	$combo_VcrRecLey->AllowNull = false;
	// combobox: VcrRecPre
	$combo_VcrRecPre = new Combo;
	$combo_VcrRecPre->ListType = 0;
	$combo_VcrRecPre->MultipleSeparator = ', ';
	$combo_VcrRecPre->ListBoxHeight = 10;
	$combo_VcrRecPre->RadiosPerLine = 1;
	if(is_file(__DIR__ . '/hooks/natural.VcrRecPre.csv')) {
		$VcrRecPre_data = addslashes(implode('', @file(__DIR__ . '/hooks/natural.VcrRecPre.csv')));
		$combo_VcrRecPre->ListItem = array_trim(explode('||', entitiesToUTF8(convertLegacyOptions($VcrRecPre_data))));
		$combo_VcrRecPre->ListData = $combo_VcrRecPre->ListItem;
	} else {
		$combo_VcrRecPre->ListItem = array_trim(explode('||', entitiesToUTF8(convertLegacyOptions("SI APLICA;;NO APLICA"))));
		$combo_VcrRecPre->ListData = $combo_VcrRecPre->ListItem;
	}
	$combo_VcrRecPre->SelectName = 'VcrRecPre';
	$combo_VcrRecPre->AllowNull = false;
	// combobox: VcrRecAut
	$combo_VcrRecAut = new Combo;
	$combo_VcrRecAut->ListType = 0;
	$combo_VcrRecAut->MultipleSeparator = ', ';
	$combo_VcrRecAut->ListBoxHeight = 10;
	$combo_VcrRecAut->RadiosPerLine = 1;
	if(is_file(__DIR__ . '/hooks/natural.VcrRecAut.csv')) {
		$VcrRecAut_data = addslashes(implode('', @file(__DIR__ . '/hooks/natural.VcrRecAut.csv')));
		$combo_VcrRecAut->ListItem = array_trim(explode('||', entitiesToUTF8(convertLegacyOptions($VcrRecAut_data))));
		$combo_VcrRecAut->ListData = $combo_VcrRecAut->ListItem;
	} else {
		$combo_VcrRecAut->ListItem = array_trim(explode('||', entitiesToUTF8(convertLegacyOptions("SI APLICA;;NO APLICA"))));
		$combo_VcrRecAut->ListData = $combo_VcrRecAut->ListItem;
	}
	$combo_VcrRecAut->SelectName = 'VcrRecAut';
	$combo_VcrRecAut->AllowNull = false;
	// combobox: VcrDatPer
	$combo_VcrDatPer = new Combo;
	$combo_VcrDatPer->ListType = 0;
	$combo_VcrDatPer->MultipleSeparator = ', ';
	$combo_VcrDatPer->ListBoxHeight = 10;
	$combo_VcrDatPer->RadiosPerLine = 1;
	if(is_file(__DIR__ . '/hooks/natural.VcrDatPer.csv')) {
		$VcrDatPer_data = addslashes(implode('', @file(__DIR__ . '/hooks/natural.VcrDatPer.csv')));
		$combo_VcrDatPer->ListItem = array_trim(explode('||', entitiesToUTF8(convertLegacyOptions($VcrDatPer_data))));
		$combo_VcrDatPer->ListData = $combo_VcrDatPer->ListItem;
	} else {
		$combo_VcrDatPer->ListItem = array_trim(explode('||', entitiesToUTF8(convertLegacyOptions("SI;;NO"))));
		$combo_VcrDatPer->ListData = $combo_VcrDatPer->ListItem;
	}
	$combo_VcrDatPer->SelectName = 'VcrDatPer';
	$combo_VcrDatPer->AllowNull = false;
	// combobox: VcrUsoIma
	$combo_VcrUsoIma = new Combo;
	$combo_VcrUsoIma->ListType = 0;
	$combo_VcrUsoIma->MultipleSeparator = ', ';
	$combo_VcrUsoIma->ListBoxHeight = 10;
	$combo_VcrUsoIma->RadiosPerLine = 1;
	if(is_file(__DIR__ . '/hooks/natural.VcrUsoIma.csv')) {
		$VcrUsoIma_data = addslashes(implode('', @file(__DIR__ . '/hooks/natural.VcrUsoIma.csv')));
		$combo_VcrUsoIma->ListItem = array_trim(explode('||', entitiesToUTF8(convertLegacyOptions($VcrUsoIma_data))));
		$combo_VcrUsoIma->ListData = $combo_VcrUsoIma->ListItem;
	} else {
		$combo_VcrUsoIma->ListItem = array_trim(explode('||', entitiesToUTF8(convertLegacyOptions("SI;;NO"))));
		$combo_VcrUsoIma->ListData = $combo_VcrUsoIma->ListItem;
	}
	$combo_VcrUsoIma->SelectName = 'VcrUsoIma';
	$combo_VcrUsoIma->AllowNull = false;
	// combobox: VcrUsoDat
	$combo_VcrUsoDat = new Combo;
	$combo_VcrUsoDat->ListType = 0;
	$combo_VcrUsoDat->MultipleSeparator = ', ';
	$combo_VcrUsoDat->ListBoxHeight = 10;
	$combo_VcrUsoDat->RadiosPerLine = 1;
	if(is_file(__DIR__ . '/hooks/natural.VcrUsoDat.csv')) {
		$VcrUsoDat_data = addslashes(implode('', @file(__DIR__ . '/hooks/natural.VcrUsoDat.csv')));
		$combo_VcrUsoDat->ListItem = array_trim(explode('||', entitiesToUTF8(convertLegacyOptions($VcrUsoDat_data))));
		$combo_VcrUsoDat->ListData = $combo_VcrUsoDat->ListItem;
	} else {
		$combo_VcrUsoDat->ListItem = array_trim(explode('||', entitiesToUTF8(convertLegacyOptions("SI;;NO"))));
		$combo_VcrUsoDat->ListData = $combo_VcrUsoDat->ListItem;
	}
	$combo_VcrUsoDat->SelectName = 'VcrUsoDat';
	$combo_VcrUsoDat->AllowNull = false;
	// combobox: VcrAutCor
	$combo_VcrAutCor = new Combo;
	$combo_VcrAutCor->ListType = 0;
	$combo_VcrAutCor->MultipleSeparator = ', ';
	$combo_VcrAutCor->ListBoxHeight = 10;
	$combo_VcrAutCor->RadiosPerLine = 1;
	if(is_file(__DIR__ . '/hooks/natural.VcrAutCor.csv')) {
		$VcrAutCor_data = addslashes(implode('', @file(__DIR__ . '/hooks/natural.VcrAutCor.csv')));
		$combo_VcrAutCor->ListItem = array_trim(explode('||', entitiesToUTF8(convertLegacyOptions($VcrAutCor_data))));
		$combo_VcrAutCor->ListData = $combo_VcrAutCor->ListItem;
	} else {
		$combo_VcrAutCor->ListItem = array_trim(explode('||', entitiesToUTF8(convertLegacyOptions("SI;;NO"))));
		$combo_VcrAutCor->ListData = $combo_VcrAutCor->ListItem;
	}
	$combo_VcrAutCor->SelectName = 'VcrAutCor';
	$combo_VcrAutCor->AllowNull = false;
	// combobox: VcrIdSerP
	$combo_VcrIdSerP = new DataCombo;

	if($selected_id) {
		// mm: check member permissions
		if(!$arrPerm['view']) return $Translation['tableAccessDenied'];

		// mm: who is the owner?
		$ownerGroupID = sqlValue("SELECT `groupID` FROM `membership_userrecords` WHERE `tableName`='natural' AND `pkValue`='" . makeSafe($selected_id) . "'");
		$ownerMemberID = sqlValue("SELECT LCASE(`memberID`) FROM `membership_userrecords` WHERE `tableName`='natural' AND `pkValue`='" . makeSafe($selected_id) . "'");

		if($arrPerm['view'] == 1 && getLoggedMemberID() != $ownerMemberID) return $Translation['tableAccessDenied'];
		if($arrPerm['view'] == 2 && getLoggedGroupID() != $ownerGroupID) return $Translation['tableAccessDenied'];

		// can edit?
		$AllowUpdate = 0;
		if(($arrPerm['edit'] == 1 && $ownerMemberID == getLoggedMemberID()) || ($arrPerm['edit'] == 2 && $ownerGroupID == getLoggedGroupID()) || $arrPerm['edit'] == 3) {
			$AllowUpdate = 1;
		}

		$res = sql("SELECT * FROM `natural` WHERE `VcrId`='" . makeSafe($selected_id) . "'", $eo);
		if(!($row = db_fetch_array($res))) {
			return error_message($Translation['No records found'], 'natural_view.php', false);
		}
		$combo_VcrIdSol->SelectedData = $row['VcrIdSol'];
		$combo_VcrFecVis->DefaultDate = $row['VcrFecVis'];
		$combo_VcrIdTip->SelectedData = $row['VcrIdTip'];
		$combo_VcrIdMot->SelectedData = $row['VcrIdMot'];
		$combo_VcrFecSol->DefaultDate = $row['VcrFecSol'];
		$combo_VcrIdUbi->SelectedData = $row['VcrIdUbi'];
		$combo_VcrIdBarVe->SelectedData = $row['VcrIdBarVe'];
		$combo_VcrIdCorr->SelectedData = $row['VcrIdCorr'];
		$combo_VcrIdCom->SelectedData = $row['VcrIdCom'];
		$combo_VcrIdFen->SelectedData = $row['VcrIdFen'];
		$combo_VcrIdCar->SelectedData = $row['VcrIdCar'];
		$combo_VcrIdEdi->SelectedData = $row['VcrIdEdi'];
		$combo_VcrEstEdi->SelectedData = $row['VcrEstEdi'];
		$combo_VcrIdAfe->SelectedData = $row['VcrIdAfe'];
		$combo_VcrDanGrav->SelectedData = $row['VcrDanGrav'];
		$combo_VcrIdMat->SelectedData = $row['VcrIdMat'];
		$combo_VcrIdLes->SelectedData = $row['VcrIdLes'];
		$combo_VcrAyuHum->SelectedData = $row['VcrAyuHum'];
		$combo_VcrCapRed->SelectedData = $row['VcrCapRed'];
		$combo_VcrIdCap->SelectedData = $row['VcrIdCap'];
		$combo_VcrPerNsNr->SelectedData = $row['VcrPerNsNr'];
		$combo_VcrTraCas->SelectedData = $row['VcrTraCas'];
		$combo_VcrIdTra1->SelectedData = $row['VcrIdTra1'];
		$combo_VcrdTra2->SelectedData = $row['VcrdTra2'];
		$combo_VcrIdTra3->SelectedData = $row['VcrIdTra3'];
		$combo_VcrIdTra4->SelectedData = $row['VcrIdTra4'];
		$combo_VcrRecLin->SelectedData = $row['VcrRecLin'];
		$combo_VcrRecLey->SelectedData = $row['VcrRecLey'];
		$combo_VcrRecPre->SelectedData = $row['VcrRecPre'];
		$combo_VcrRecAut->SelectedData = $row['VcrRecAut'];
		$combo_VcrDatPer->SelectedData = $row['VcrDatPer'];
		$combo_VcrUsoIma->SelectedData = $row['VcrUsoIma'];
		$combo_VcrUsoDat->SelectedData = $row['VcrUsoDat'];
		$combo_VcrAutCor->SelectedData = $row['VcrAutCor'];
		$combo_VcrIdSerP->SelectedData = $row['VcrIdSerP'];
		$urow = $row; /* unsanitized data */
		$row = array_map('safe_html', $row);
	} else {
		$filterField = Request::val('FilterField');
		$filterOperator = Request::val('FilterOperator');
		$filterValue = Request::val('FilterValue');
		$combo_VcrIdSol->SelectedData = $filterer_VcrIdSol;
		$combo_VcrIdTip->SelectedData = $filterer_VcrIdTip;
		$combo_VcrIdMot->SelectedData = $filterer_VcrIdMot;
		$combo_VcrIdUbi->SelectedData = $filterer_VcrIdUbi;
		$combo_VcrIdBarVe->SelectedData = $filterer_VcrIdBarVe;
		$combo_VcrIdCorr->SelectedData = $filterer_VcrIdCorr;
		$combo_VcrIdCom->SelectedData = $filterer_VcrIdCom;
		$combo_VcrIdFen->SelectedData = $filterer_VcrIdFen;
		$combo_VcrIdCar->SelectedData = $filterer_VcrIdCar;
		$combo_VcrIdEdi->SelectedData = $filterer_VcrIdEdi;
		$combo_VcrEstEdi->SelectedText = (isset($filterField[1]) && $filterField[1] == '30' && $filterOperator[1] == '<=>' ? $filterValue[1] : '');
		$combo_VcrIdAfe->SelectedData = $filterer_VcrIdAfe;
		$combo_VcrDanGrav->SelectedText = (isset($filterField[1]) && $filterField[1] == '33' && $filterOperator[1] == '<=>' ? $filterValue[1] : '');
		$combo_VcrIdMat->SelectedData = $filterer_VcrIdMat;
		$combo_VcrIdLes->SelectedData = $filterer_VcrIdLes;
		$combo_VcrAyuHum->SelectedText = (isset($filterField[1]) && $filterField[1] == '37' && $filterOperator[1] == '<=>' ? $filterValue[1] : '');
		$combo_VcrCapRed->SelectedText = (isset($filterField[1]) && $filterField[1] == '40' && $filterOperator[1] == '<=>' ? $filterValue[1] : '');
		$combo_VcrIdCap->SelectedData = $filterer_VcrIdCap;
		$combo_VcrPerNsNr->SelectedText = (isset($filterField[1]) && $filterField[1] == '62' && $filterOperator[1] == '<=>' ? $filterValue[1] : '');
		$combo_VcrTraCas->SelectedText = (isset($filterField[1]) && $filterField[1] == '63' && $filterOperator[1] == '<=>' ? $filterValue[1] : '');
		$combo_VcrIdTra1->SelectedData = $filterer_VcrIdTra1;
		$combo_VcrdTra2->SelectedData = $filterer_VcrdTra2;
		$combo_VcrIdTra3->SelectedData = $filterer_VcrIdTra3;
		$combo_VcrIdTra4->SelectedData = $filterer_VcrIdTra4;
		$combo_VcrRecLin->SelectedText = (isset($filterField[1]) && $filterField[1] == '68' && $filterOperator[1] == '<=>' ? $filterValue[1] : '');
		$combo_VcrRecLey->SelectedText = (isset($filterField[1]) && $filterField[1] == '69' && $filterOperator[1] == '<=>' ? $filterValue[1] : '');
		$combo_VcrRecPre->SelectedText = (isset($filterField[1]) && $filterField[1] == '70' && $filterOperator[1] == '<=>' ? $filterValue[1] : '');
		$combo_VcrRecAut->SelectedText = (isset($filterField[1]) && $filterField[1] == '71' && $filterOperator[1] == '<=>' ? $filterValue[1] : '');
		$combo_VcrDatPer->SelectedText = (isset($filterField[1]) && $filterField[1] == '72' && $filterOperator[1] == '<=>' ? $filterValue[1] : '');
		$combo_VcrUsoIma->SelectedText = (isset($filterField[1]) && $filterField[1] == '73' && $filterOperator[1] == '<=>' ? $filterValue[1] : '');
		$combo_VcrUsoDat->SelectedText = (isset($filterField[1]) && $filterField[1] == '74' && $filterOperator[1] == '<=>' ? $filterValue[1] : '');
		$combo_VcrAutCor->SelectedText = (isset($filterField[1]) && $filterField[1] == '75' && $filterOperator[1] == '<=>' ? $filterValue[1] : '');
		$combo_VcrIdSerP->SelectedData = $filterer_VcrIdSerP;
	}
	$combo_VcrIdSol->HTML = '<span id="VcrIdSol-container' . $rnd1 . '"></span><input type="hidden" name="VcrIdSol" id="VcrIdSol' . $rnd1 . '" value="' . html_attr($combo_VcrIdSol->SelectedData) . '">';
	$combo_VcrIdSol->MatchText = '<span id="VcrIdSol-container-readonly' . $rnd1 . '"></span><input type="hidden" name="VcrIdSol" id="VcrIdSol' . $rnd1 . '" value="' . html_attr($combo_VcrIdSol->SelectedData) . '">';
	$combo_VcrIdTip->HTML = '<span id="VcrIdTip-container' . $rnd1 . '"></span><input type="hidden" name="VcrIdTip" id="VcrIdTip' . $rnd1 . '" value="' . html_attr($combo_VcrIdTip->SelectedData) . '">';
	$combo_VcrIdTip->MatchText = '<span id="VcrIdTip-container-readonly' . $rnd1 . '"></span><input type="hidden" name="VcrIdTip" id="VcrIdTip' . $rnd1 . '" value="' . html_attr($combo_VcrIdTip->SelectedData) . '">';
	$combo_VcrIdMot->HTML = '<span id="VcrIdMot-container' . $rnd1 . '"></span><input type="hidden" name="VcrIdMot" id="VcrIdMot' . $rnd1 . '" value="' . html_attr($combo_VcrIdMot->SelectedData) . '">';
	$combo_VcrIdMot->MatchText = '<span id="VcrIdMot-container-readonly' . $rnd1 . '"></span><input type="hidden" name="VcrIdMot" id="VcrIdMot' . $rnd1 . '" value="' . html_attr($combo_VcrIdMot->SelectedData) . '">';
	$combo_VcrIdUbi->HTML = '<span id="VcrIdUbi-container' . $rnd1 . '"></span><input type="hidden" name="VcrIdUbi" id="VcrIdUbi' . $rnd1 . '" value="' . html_attr($combo_VcrIdUbi->SelectedData) . '">';
	$combo_VcrIdUbi->MatchText = '<span id="VcrIdUbi-container-readonly' . $rnd1 . '"></span><input type="hidden" name="VcrIdUbi" id="VcrIdUbi' . $rnd1 . '" value="' . html_attr($combo_VcrIdUbi->SelectedData) . '">';
	$combo_VcrIdBarVe->HTML = '<span id="VcrIdBarVe-container' . $rnd1 . '"></span><input type="hidden" name="VcrIdBarVe" id="VcrIdBarVe' . $rnd1 . '" value="' . html_attr($combo_VcrIdBarVe->SelectedData) . '">';
	$combo_VcrIdBarVe->MatchText = '<span id="VcrIdBarVe-container-readonly' . $rnd1 . '"></span><input type="hidden" name="VcrIdBarVe" id="VcrIdBarVe' . $rnd1 . '" value="' . html_attr($combo_VcrIdBarVe->SelectedData) . '">';
	$combo_VcrIdCorr->HTML = '<span id="VcrIdCorr-container' . $rnd1 . '"></span><input type="hidden" name="VcrIdCorr" id="VcrIdCorr' . $rnd1 . '" value="' . html_attr($combo_VcrIdCorr->SelectedData) . '">';
	$combo_VcrIdCorr->MatchText = '<span id="VcrIdCorr-container-readonly' . $rnd1 . '"></span><input type="hidden" name="VcrIdCorr" id="VcrIdCorr' . $rnd1 . '" value="' . html_attr($combo_VcrIdCorr->SelectedData) . '">';
	$combo_VcrIdCom->HTML = '<span id="VcrIdCom-container' . $rnd1 . '"></span><input type="hidden" name="VcrIdCom" id="VcrIdCom' . $rnd1 . '" value="' . html_attr($combo_VcrIdCom->SelectedData) . '">';
	$combo_VcrIdCom->MatchText = '<span id="VcrIdCom-container-readonly' . $rnd1 . '"></span><input type="hidden" name="VcrIdCom" id="VcrIdCom' . $rnd1 . '" value="' . html_attr($combo_VcrIdCom->SelectedData) . '">';
	$combo_VcrIdFen->HTML = '<span id="VcrIdFen-container' . $rnd1 . '"></span><input type="hidden" name="VcrIdFen" id="VcrIdFen' . $rnd1 . '" value="' . html_attr($combo_VcrIdFen->SelectedData) . '">';
	$combo_VcrIdFen->MatchText = '<span id="VcrIdFen-container-readonly' . $rnd1 . '"></span><input type="hidden" name="VcrIdFen" id="VcrIdFen' . $rnd1 . '" value="' . html_attr($combo_VcrIdFen->SelectedData) . '">';
	$combo_VcrIdCar->HTML = '<span id="VcrIdCar-container' . $rnd1 . '"></span><input type="hidden" name="VcrIdCar" id="VcrIdCar' . $rnd1 . '" value="' . html_attr($combo_VcrIdCar->SelectedData) . '">';
	$combo_VcrIdCar->MatchText = '<span id="VcrIdCar-container-readonly' . $rnd1 . '"></span><input type="hidden" name="VcrIdCar" id="VcrIdCar' . $rnd1 . '" value="' . html_attr($combo_VcrIdCar->SelectedData) . '">';
	$combo_VcrIdEdi->HTML = '<span id="VcrIdEdi-container' . $rnd1 . '"></span><input type="hidden" name="VcrIdEdi" id="VcrIdEdi' . $rnd1 . '" value="' . html_attr($combo_VcrIdEdi->SelectedData) . '">';
	$combo_VcrIdEdi->MatchText = '<span id="VcrIdEdi-container-readonly' . $rnd1 . '"></span><input type="hidden" name="VcrIdEdi" id="VcrIdEdi' . $rnd1 . '" value="' . html_attr($combo_VcrIdEdi->SelectedData) . '">';
	$combo_VcrEstEdi->Render();
	$combo_VcrIdAfe->HTML = '<span id="VcrIdAfe-container' . $rnd1 . '"></span><input type="hidden" name="VcrIdAfe" id="VcrIdAfe' . $rnd1 . '" value="' . html_attr($combo_VcrIdAfe->SelectedData) . '">';
	$combo_VcrIdAfe->MatchText = '<span id="VcrIdAfe-container-readonly' . $rnd1 . '"></span><input type="hidden" name="VcrIdAfe" id="VcrIdAfe' . $rnd1 . '" value="' . html_attr($combo_VcrIdAfe->SelectedData) . '">';
	$combo_VcrDanGrav->Render();
	$combo_VcrIdMat->HTML = '<span id="VcrIdMat-container' . $rnd1 . '"></span><input type="hidden" name="VcrIdMat" id="VcrIdMat' . $rnd1 . '" value="' . html_attr($combo_VcrIdMat->SelectedData) . '">';
	$combo_VcrIdMat->MatchText = '<span id="VcrIdMat-container-readonly' . $rnd1 . '"></span><input type="hidden" name="VcrIdMat" id="VcrIdMat' . $rnd1 . '" value="' . html_attr($combo_VcrIdMat->SelectedData) . '">';
	$combo_VcrIdLes->HTML = '<span id="VcrIdLes-container' . $rnd1 . '"></span><input type="hidden" name="VcrIdLes" id="VcrIdLes' . $rnd1 . '" value="' . html_attr($combo_VcrIdLes->SelectedData) . '">';
	$combo_VcrIdLes->MatchText = '<span id="VcrIdLes-container-readonly' . $rnd1 . '"></span><input type="hidden" name="VcrIdLes" id="VcrIdLes' . $rnd1 . '" value="' . html_attr($combo_VcrIdLes->SelectedData) . '">';
	$combo_VcrAyuHum->Render();
	$combo_VcrCapRed->Render();
	$combo_VcrIdCap->HTML = '<span id="VcrIdCap-container' . $rnd1 . '"></span><input type="hidden" name="VcrIdCap" id="VcrIdCap' . $rnd1 . '" value="' . html_attr($combo_VcrIdCap->SelectedData) . '">';
	$combo_VcrIdCap->MatchText = '<span id="VcrIdCap-container-readonly' . $rnd1 . '"></span><input type="hidden" name="VcrIdCap" id="VcrIdCap' . $rnd1 . '" value="' . html_attr($combo_VcrIdCap->SelectedData) . '">';
	$combo_VcrPerNsNr->Render();
	$combo_VcrTraCas->Render();
	$combo_VcrIdTra1->HTML = '<span id="VcrIdTra1-container' . $rnd1 . '"></span><input type="hidden" name="VcrIdTra1" id="VcrIdTra1' . $rnd1 . '" value="' . html_attr($combo_VcrIdTra1->SelectedData) . '">';
	$combo_VcrIdTra1->MatchText = '<span id="VcrIdTra1-container-readonly' . $rnd1 . '"></span><input type="hidden" name="VcrIdTra1" id="VcrIdTra1' . $rnd1 . '" value="' . html_attr($combo_VcrIdTra1->SelectedData) . '">';
	$combo_VcrdTra2->HTML = '<span id="VcrdTra2-container' . $rnd1 . '"></span><input type="hidden" name="VcrdTra2" id="VcrdTra2' . $rnd1 . '" value="' . html_attr($combo_VcrdTra2->SelectedData) . '">';
	$combo_VcrdTra2->MatchText = '<span id="VcrdTra2-container-readonly' . $rnd1 . '"></span><input type="hidden" name="VcrdTra2" id="VcrdTra2' . $rnd1 . '" value="' . html_attr($combo_VcrdTra2->SelectedData) . '">';
	$combo_VcrIdTra3->HTML = '<span id="VcrIdTra3-container' . $rnd1 . '"></span><input type="hidden" name="VcrIdTra3" id="VcrIdTra3' . $rnd1 . '" value="' . html_attr($combo_VcrIdTra3->SelectedData) . '">';
	$combo_VcrIdTra3->MatchText = '<span id="VcrIdTra3-container-readonly' . $rnd1 . '"></span><input type="hidden" name="VcrIdTra3" id="VcrIdTra3' . $rnd1 . '" value="' . html_attr($combo_VcrIdTra3->SelectedData) . '">';
	$combo_VcrIdTra4->HTML = '<span id="VcrIdTra4-container' . $rnd1 . '"></span><input type="hidden" name="VcrIdTra4" id="VcrIdTra4' . $rnd1 . '" value="' . html_attr($combo_VcrIdTra4->SelectedData) . '">';
	$combo_VcrIdTra4->MatchText = '<span id="VcrIdTra4-container-readonly' . $rnd1 . '"></span><input type="hidden" name="VcrIdTra4" id="VcrIdTra4' . $rnd1 . '" value="' . html_attr($combo_VcrIdTra4->SelectedData) . '">';
	$combo_VcrRecLin->Render();
	$combo_VcrRecLey->Render();
	$combo_VcrRecPre->Render();
	$combo_VcrRecAut->Render();
	$combo_VcrDatPer->Render();
	$combo_VcrUsoIma->Render();
	$combo_VcrUsoDat->Render();
	$combo_VcrAutCor->Render();
	$combo_VcrIdSerP->HTML = '<span id="VcrIdSerP-container' . $rnd1 . '"></span><input type="hidden" name="VcrIdSerP" id="VcrIdSerP' . $rnd1 . '" value="' . html_attr($combo_VcrIdSerP->SelectedData) . '">';
	$combo_VcrIdSerP->MatchText = '<span id="VcrIdSerP-container-readonly' . $rnd1 . '"></span><input type="hidden" name="VcrIdSerP" id="VcrIdSerP' . $rnd1 . '" value="' . html_attr($combo_VcrIdSerP->SelectedData) . '">';

	ob_start();
	?>

	<script>
		// initial lookup values
		AppGini.current_VcrIdSol__RAND__ = { text: "", value: "<?php echo addslashes($selected_id ? $urow['VcrIdSol'] : htmlspecialchars($filterer_VcrIdSol, ENT_QUOTES)); ?>"};
		AppGini.current_VcrIdTip__RAND__ = { text: "", value: "<?php echo addslashes($selected_id ? $urow['VcrIdTip'] : htmlspecialchars($filterer_VcrIdTip, ENT_QUOTES)); ?>"};
		AppGini.current_VcrIdMot__RAND__ = { text: "", value: "<?php echo addslashes($selected_id ? $urow['VcrIdMot'] : htmlspecialchars($filterer_VcrIdMot, ENT_QUOTES)); ?>"};
		AppGini.current_VcrIdUbi__RAND__ = { text: "", value: "<?php echo addslashes($selected_id ? $urow['VcrIdUbi'] : htmlspecialchars($filterer_VcrIdUbi, ENT_QUOTES)); ?>"};
		AppGini.current_VcrIdBarVe__RAND__ = { text: "", value: "<?php echo addslashes($selected_id ? $urow['VcrIdBarVe'] : htmlspecialchars($filterer_VcrIdBarVe, ENT_QUOTES)); ?>"};
		AppGini.current_VcrIdCorr__RAND__ = { text: "", value: "<?php echo addslashes($selected_id ? $urow['VcrIdCorr'] : htmlspecialchars($filterer_VcrIdCorr, ENT_QUOTES)); ?>"};
		AppGini.current_VcrIdCom__RAND__ = { text: "", value: "<?php echo addslashes($selected_id ? $urow['VcrIdCom'] : htmlspecialchars($filterer_VcrIdCom, ENT_QUOTES)); ?>"};
		AppGini.current_VcrIdFen__RAND__ = { text: "", value: "<?php echo addslashes($selected_id ? $urow['VcrIdFen'] : htmlspecialchars($filterer_VcrIdFen, ENT_QUOTES)); ?>"};
		AppGini.current_VcrIdCar__RAND__ = { text: "", value: "<?php echo addslashes($selected_id ? $urow['VcrIdCar'] : htmlspecialchars($filterer_VcrIdCar, ENT_QUOTES)); ?>"};
		AppGini.current_VcrIdEdi__RAND__ = { text: "", value: "<?php echo addslashes($selected_id ? $urow['VcrIdEdi'] : htmlspecialchars($filterer_VcrIdEdi, ENT_QUOTES)); ?>"};
		AppGini.current_VcrIdAfe__RAND__ = { text: "", value: "<?php echo addslashes($selected_id ? $urow['VcrIdAfe'] : htmlspecialchars($filterer_VcrIdAfe, ENT_QUOTES)); ?>"};
		AppGini.current_VcrIdMat__RAND__ = { text: "", value: "<?php echo addslashes($selected_id ? $urow['VcrIdMat'] : htmlspecialchars($filterer_VcrIdMat, ENT_QUOTES)); ?>"};
		AppGini.current_VcrIdLes__RAND__ = { text: "", value: "<?php echo addslashes($selected_id ? $urow['VcrIdLes'] : htmlspecialchars($filterer_VcrIdLes, ENT_QUOTES)); ?>"};
		AppGini.current_VcrIdCap__RAND__ = { text: "", value: "<?php echo addslashes($selected_id ? $urow['VcrIdCap'] : htmlspecialchars($filterer_VcrIdCap, ENT_QUOTES)); ?>"};
		AppGini.current_VcrIdTra1__RAND__ = { text: "", value: "<?php echo addslashes($selected_id ? $urow['VcrIdTra1'] : htmlspecialchars($filterer_VcrIdTra1, ENT_QUOTES)); ?>"};
		AppGini.current_VcrdTra2__RAND__ = { text: "", value: "<?php echo addslashes($selected_id ? $urow['VcrdTra2'] : htmlspecialchars($filterer_VcrdTra2, ENT_QUOTES)); ?>"};
		AppGini.current_VcrIdTra3__RAND__ = { text: "", value: "<?php echo addslashes($selected_id ? $urow['VcrIdTra3'] : htmlspecialchars($filterer_VcrIdTra3, ENT_QUOTES)); ?>"};
		AppGini.current_VcrIdTra4__RAND__ = { text: "", value: "<?php echo addslashes($selected_id ? $urow['VcrIdTra4'] : htmlspecialchars($filterer_VcrIdTra4, ENT_QUOTES)); ?>"};
		AppGini.current_VcrIdSerP__RAND__ = { text: "", value: "<?php echo addslashes($selected_id ? $urow['VcrIdSerP'] : htmlspecialchars($filterer_VcrIdSerP, ENT_QUOTES)); ?>"};

		jQuery(function() {
			setTimeout(function() {
				if(typeof(VcrIdSol_reload__RAND__) == 'function') VcrIdSol_reload__RAND__();
				if(typeof(VcrIdTip_reload__RAND__) == 'function') VcrIdTip_reload__RAND__();
				if(typeof(VcrIdMot_reload__RAND__) == 'function') VcrIdMot_reload__RAND__();
				if(typeof(VcrIdUbi_reload__RAND__) == 'function') VcrIdUbi_reload__RAND__();
				if(typeof(VcrIdBarVe_reload__RAND__) == 'function') VcrIdBarVe_reload__RAND__();
				if(typeof(VcrIdCorr_reload__RAND__) == 'function') VcrIdCorr_reload__RAND__();
				if(typeof(VcrIdCom_reload__RAND__) == 'function') VcrIdCom_reload__RAND__();
				if(typeof(VcrIdFen_reload__RAND__) == 'function') VcrIdFen_reload__RAND__();
				if(typeof(VcrIdCar_reload__RAND__) == 'function') VcrIdCar_reload__RAND__();
				if(typeof(VcrIdEdi_reload__RAND__) == 'function') VcrIdEdi_reload__RAND__();
				if(typeof(VcrIdAfe_reload__RAND__) == 'function') VcrIdAfe_reload__RAND__();
				if(typeof(VcrIdMat_reload__RAND__) == 'function') VcrIdMat_reload__RAND__();
				if(typeof(VcrIdLes_reload__RAND__) == 'function') VcrIdLes_reload__RAND__();
				if(typeof(VcrIdCap_reload__RAND__) == 'function') VcrIdCap_reload__RAND__();
				if(typeof(VcrIdTra1_reload__RAND__) == 'function') VcrIdTra1_reload__RAND__();
				if(typeof(VcrdTra2_reload__RAND__) == 'function') VcrdTra2_reload__RAND__();
				if(typeof(VcrIdTra3_reload__RAND__) == 'function') VcrIdTra3_reload__RAND__();
				if(typeof(VcrIdTra4_reload__RAND__) == 'function') VcrIdTra4_reload__RAND__();
				if(typeof(VcrIdSerP_reload__RAND__) == 'function') VcrIdSerP_reload__RAND__();
			}, 50); /* we need to slightly delay client-side execution of the above code to allow AppGini.ajaxCache to work */
		});
		function VcrIdSol_reload__RAND__() {
		<?php if(($AllowUpdate || $AllowInsert) && !$dvprint) { ?>

			$j("#VcrIdSol-container__RAND__").select2({
				/* initial default value */
				initSelection: function(e, c) {
					$j.ajax({
						url: 'ajax_combo.php',
						dataType: 'json',
						data: { id: AppGini.current_VcrIdSol__RAND__.value, t: 'natural', f: 'VcrIdSol' },
						success: function(resp) {
							c({
								id: resp.results[0].id,
								text: resp.results[0].text
							});
							$j('[name="VcrIdSol"]').val(resp.results[0].id);
							$j('[id=VcrIdSol-container-readonly__RAND__]').html('<span class="match-text" id="VcrIdSol-match-text">' + resp.results[0].text + '</span>');
							if(resp.results[0].id == '<?php echo empty_lookup_value; ?>') { $j('.btn[id=solicitudes_view_parent]').hide(); } else { $j('.btn[id=solicitudes_view_parent]').show(); }


							if(typeof(VcrIdSol_update_autofills__RAND__) == 'function') VcrIdSol_update_autofills__RAND__();
						}
					});
				},
				width: '100%',
				formatNoMatches: function(term) { return '<?php echo addslashes($Translation['No matches found!']); ?>'; },
				minimumResultsForSearch: 5,
				loadMorePadding: 200,
				ajax: {
					url: 'ajax_combo.php',
					dataType: 'json',
					cache: true,
					data: function(term, page) { return { s: term, p: page, t: 'natural', f: 'VcrIdSol' }; },
					results: function(resp, page) { return resp; }
				},
				escapeMarkup: function(str) { return str; }
			}).on('change', function(e) {
				AppGini.current_VcrIdSol__RAND__.value = e.added.id;
				AppGini.current_VcrIdSol__RAND__.text = e.added.text;
				$j('[name="VcrIdSol"]').val(e.added.id);
				if(e.added.id == '<?php echo empty_lookup_value; ?>') { $j('.btn[id=solicitudes_view_parent]').hide(); } else { $j('.btn[id=solicitudes_view_parent]').show(); }


				if(typeof(VcrIdSol_update_autofills__RAND__) == 'function') VcrIdSol_update_autofills__RAND__();
			});

			if(!$j("#VcrIdSol-container__RAND__").length) {
				$j.ajax({
					url: 'ajax_combo.php',
					dataType: 'json',
					data: { id: AppGini.current_VcrIdSol__RAND__.value, t: 'natural', f: 'VcrIdSol' },
					success: function(resp) {
						$j('[name="VcrIdSol"]').val(resp.results[0].id);
						$j('[id=VcrIdSol-container-readonly__RAND__]').html('<span class="match-text" id="VcrIdSol-match-text">' + resp.results[0].text + '</span>');
						if(resp.results[0].id == '<?php echo empty_lookup_value; ?>') { $j('.btn[id=solicitudes_view_parent]').hide(); } else { $j('.btn[id=solicitudes_view_parent]').show(); }

						if(typeof(VcrIdSol_update_autofills__RAND__) == 'function') VcrIdSol_update_autofills__RAND__();
					}
				});
			}

		<?php } else { ?>

			$j.ajax({
				url: 'ajax_combo.php',
				dataType: 'json',
				data: { id: AppGini.current_VcrIdSol__RAND__.value, t: 'natural', f: 'VcrIdSol' },
				success: function(resp) {
					$j('[id=VcrIdSol-container__RAND__], [id=VcrIdSol-container-readonly__RAND__]').html('<span class="match-text" id="VcrIdSol-match-text">' + resp.results[0].text + '</span>');
					if(resp.results[0].id == '<?php echo empty_lookup_value; ?>') { $j('.btn[id=solicitudes_view_parent]').hide(); } else { $j('.btn[id=solicitudes_view_parent]').show(); }

					if(typeof(VcrIdSol_update_autofills__RAND__) == 'function') VcrIdSol_update_autofills__RAND__();
				}
			});
		<?php } ?>

		}
		function VcrIdTip_reload__RAND__() {
		<?php if(($AllowUpdate || $AllowInsert) && !$dvprint) { ?>

			$j("#VcrIdTip-container__RAND__").select2({
				/* initial default value */
				initSelection: function(e, c) {
					$j.ajax({
						url: 'ajax_combo.php',
						dataType: 'json',
						data: { id: AppGini.current_VcrIdTip__RAND__.value, t: 'natural', f: 'VcrIdTip' },
						success: function(resp) {
							c({
								id: resp.results[0].id,
								text: resp.results[0].text
							});
							$j('[name="VcrIdTip"]').val(resp.results[0].id);
							$j('[id=VcrIdTip-container-readonly__RAND__]').html('<span class="match-text" id="VcrIdTip-match-text">' + resp.results[0].text + '</span>');
							if(resp.results[0].id == '<?php echo empty_lookup_value; ?>') { $j('.btn[id=tipo_documento_view_parent]').hide(); } else { $j('.btn[id=tipo_documento_view_parent]').show(); }


							if(typeof(VcrIdTip_update_autofills__RAND__) == 'function') VcrIdTip_update_autofills__RAND__();
						}
					});
				},
				width: '100%',
				formatNoMatches: function(term) { return '<?php echo addslashes($Translation['No matches found!']); ?>'; },
				minimumResultsForSearch: 5,
				loadMorePadding: 200,
				ajax: {
					url: 'ajax_combo.php',
					dataType: 'json',
					cache: true,
					data: function(term, page) { return { s: term, p: page, t: 'natural', f: 'VcrIdTip' }; },
					results: function(resp, page) { return resp; }
				},
				escapeMarkup: function(str) { return str; }
			}).on('change', function(e) {
				AppGini.current_VcrIdTip__RAND__.value = e.added.id;
				AppGini.current_VcrIdTip__RAND__.text = e.added.text;
				$j('[name="VcrIdTip"]').val(e.added.id);
				if(e.added.id == '<?php echo empty_lookup_value; ?>') { $j('.btn[id=tipo_documento_view_parent]').hide(); } else { $j('.btn[id=tipo_documento_view_parent]').show(); }


				if(typeof(VcrIdTip_update_autofills__RAND__) == 'function') VcrIdTip_update_autofills__RAND__();
			});

			if(!$j("#VcrIdTip-container__RAND__").length) {
				$j.ajax({
					url: 'ajax_combo.php',
					dataType: 'json',
					data: { id: AppGini.current_VcrIdTip__RAND__.value, t: 'natural', f: 'VcrIdTip' },
					success: function(resp) {
						$j('[name="VcrIdTip"]').val(resp.results[0].id);
						$j('[id=VcrIdTip-container-readonly__RAND__]').html('<span class="match-text" id="VcrIdTip-match-text">' + resp.results[0].text + '</span>');
						if(resp.results[0].id == '<?php echo empty_lookup_value; ?>') { $j('.btn[id=tipo_documento_view_parent]').hide(); } else { $j('.btn[id=tipo_documento_view_parent]').show(); }

						if(typeof(VcrIdTip_update_autofills__RAND__) == 'function') VcrIdTip_update_autofills__RAND__();
					}
				});
			}

		<?php } else { ?>

			$j.ajax({
				url: 'ajax_combo.php',
				dataType: 'json',
				data: { id: AppGini.current_VcrIdTip__RAND__.value, t: 'natural', f: 'VcrIdTip' },
				success: function(resp) {
					$j('[id=VcrIdTip-container__RAND__], [id=VcrIdTip-container-readonly__RAND__]').html('<span class="match-text" id="VcrIdTip-match-text">' + resp.results[0].text + '</span>');
					if(resp.results[0].id == '<?php echo empty_lookup_value; ?>') { $j('.btn[id=tipo_documento_view_parent]').hide(); } else { $j('.btn[id=tipo_documento_view_parent]').show(); }

					if(typeof(VcrIdTip_update_autofills__RAND__) == 'function') VcrIdTip_update_autofills__RAND__();
				}
			});
		<?php } ?>

		}
		function VcrIdMot_reload__RAND__() {
		<?php if(($AllowUpdate || $AllowInsert) && !$dvprint) { ?>

			$j("#VcrIdMot-container__RAND__").select2({
				/* initial default value */
				initSelection: function(e, c) {
					$j.ajax({
						url: 'ajax_combo.php',
						dataType: 'json',
						data: { id: AppGini.current_VcrIdMot__RAND__.value, t: 'natural', f: 'VcrIdMot' },
						success: function(resp) {
							c({
								id: resp.results[0].id,
								text: resp.results[0].text
							});
							$j('[name="VcrIdMot"]').val(resp.results[0].id);
							$j('[id=VcrIdMot-container-readonly__RAND__]').html('<span class="match-text" id="VcrIdMot-match-text">' + resp.results[0].text + '</span>');
							if(resp.results[0].id == '<?php echo empty_lookup_value; ?>') { $j('.btn[id=motivo_visita_view_parent]').hide(); } else { $j('.btn[id=motivo_visita_view_parent]').show(); }


							if(typeof(VcrIdMot_update_autofills__RAND__) == 'function') VcrIdMot_update_autofills__RAND__();
						}
					});
				},
				width: '100%',
				formatNoMatches: function(term) { return '<?php echo addslashes($Translation['No matches found!']); ?>'; },
				minimumResultsForSearch: 5,
				loadMorePadding: 200,
				ajax: {
					url: 'ajax_combo.php',
					dataType: 'json',
					cache: true,
					data: function(term, page) { return { s: term, p: page, t: 'natural', f: 'VcrIdMot' }; },
					results: function(resp, page) { return resp; }
				},
				escapeMarkup: function(str) { return str; }
			}).on('change', function(e) {
				AppGini.current_VcrIdMot__RAND__.value = e.added.id;
				AppGini.current_VcrIdMot__RAND__.text = e.added.text;
				$j('[name="VcrIdMot"]').val(e.added.id);
				if(e.added.id == '<?php echo empty_lookup_value; ?>') { $j('.btn[id=motivo_visita_view_parent]').hide(); } else { $j('.btn[id=motivo_visita_view_parent]').show(); }


				if(typeof(VcrIdMot_update_autofills__RAND__) == 'function') VcrIdMot_update_autofills__RAND__();
			});

			if(!$j("#VcrIdMot-container__RAND__").length) {
				$j.ajax({
					url: 'ajax_combo.php',
					dataType: 'json',
					data: { id: AppGini.current_VcrIdMot__RAND__.value, t: 'natural', f: 'VcrIdMot' },
					success: function(resp) {
						$j('[name="VcrIdMot"]').val(resp.results[0].id);
						$j('[id=VcrIdMot-container-readonly__RAND__]').html('<span class="match-text" id="VcrIdMot-match-text">' + resp.results[0].text + '</span>');
						if(resp.results[0].id == '<?php echo empty_lookup_value; ?>') { $j('.btn[id=motivo_visita_view_parent]').hide(); } else { $j('.btn[id=motivo_visita_view_parent]').show(); }

						if(typeof(VcrIdMot_update_autofills__RAND__) == 'function') VcrIdMot_update_autofills__RAND__();
					}
				});
			}

		<?php } else { ?>

			$j.ajax({
				url: 'ajax_combo.php',
				dataType: 'json',
				data: { id: AppGini.current_VcrIdMot__RAND__.value, t: 'natural', f: 'VcrIdMot' },
				success: function(resp) {
					$j('[id=VcrIdMot-container__RAND__], [id=VcrIdMot-container-readonly__RAND__]').html('<span class="match-text" id="VcrIdMot-match-text">' + resp.results[0].text + '</span>');
					if(resp.results[0].id == '<?php echo empty_lookup_value; ?>') { $j('.btn[id=motivo_visita_view_parent]').hide(); } else { $j('.btn[id=motivo_visita_view_parent]').show(); }

					if(typeof(VcrIdMot_update_autofills__RAND__) == 'function') VcrIdMot_update_autofills__RAND__();
				}
			});
		<?php } ?>

		}
		function VcrIdUbi_reload__RAND__() {
		<?php if(($AllowUpdate || $AllowInsert) && !$dvprint) { ?>

			$j("#VcrIdUbi-container__RAND__").select2({
				/* initial default value */
				initSelection: function(e, c) {
					$j.ajax({
						url: 'ajax_combo.php',
						dataType: 'json',
						data: { id: AppGini.current_VcrIdUbi__RAND__.value, t: 'natural', f: 'VcrIdUbi' },
						success: function(resp) {
							c({
								id: resp.results[0].id,
								text: resp.results[0].text
							});
							$j('[name="VcrIdUbi"]').val(resp.results[0].id);
							$j('[id=VcrIdUbi-container-readonly__RAND__]').html('<span class="match-text" id="VcrIdUbi-match-text">' + resp.results[0].text + '</span>');
							if(resp.results[0].id == '<?php echo empty_lookup_value; ?>') { $j('.btn[id=ubicacion_view_parent]').hide(); } else { $j('.btn[id=ubicacion_view_parent]').show(); }


							if(typeof(VcrIdUbi_update_autofills__RAND__) == 'function') VcrIdUbi_update_autofills__RAND__();
						}
					});
				},
				width: '100%',
				formatNoMatches: function(term) { return '<?php echo addslashes($Translation['No matches found!']); ?>'; },
				minimumResultsForSearch: 5,
				loadMorePadding: 200,
				ajax: {
					url: 'ajax_combo.php',
					dataType: 'json',
					cache: true,
					data: function(term, page) { return { s: term, p: page, t: 'natural', f: 'VcrIdUbi' }; },
					results: function(resp, page) { return resp; }
				},
				escapeMarkup: function(str) { return str; }
			}).on('change', function(e) {
				AppGini.current_VcrIdUbi__RAND__.value = e.added.id;
				AppGini.current_VcrIdUbi__RAND__.text = e.added.text;
				$j('[name="VcrIdUbi"]').val(e.added.id);
				if(e.added.id == '<?php echo empty_lookup_value; ?>') { $j('.btn[id=ubicacion_view_parent]').hide(); } else { $j('.btn[id=ubicacion_view_parent]').show(); }


				if(typeof(VcrIdUbi_update_autofills__RAND__) == 'function') VcrIdUbi_update_autofills__RAND__();
			});

			if(!$j("#VcrIdUbi-container__RAND__").length) {
				$j.ajax({
					url: 'ajax_combo.php',
					dataType: 'json',
					data: { id: AppGini.current_VcrIdUbi__RAND__.value, t: 'natural', f: 'VcrIdUbi' },
					success: function(resp) {
						$j('[name="VcrIdUbi"]').val(resp.results[0].id);
						$j('[id=VcrIdUbi-container-readonly__RAND__]').html('<span class="match-text" id="VcrIdUbi-match-text">' + resp.results[0].text + '</span>');
						if(resp.results[0].id == '<?php echo empty_lookup_value; ?>') { $j('.btn[id=ubicacion_view_parent]').hide(); } else { $j('.btn[id=ubicacion_view_parent]').show(); }

						if(typeof(VcrIdUbi_update_autofills__RAND__) == 'function') VcrIdUbi_update_autofills__RAND__();
					}
				});
			}

		<?php } else { ?>

			$j.ajax({
				url: 'ajax_combo.php',
				dataType: 'json',
				data: { id: AppGini.current_VcrIdUbi__RAND__.value, t: 'natural', f: 'VcrIdUbi' },
				success: function(resp) {
					$j('[id=VcrIdUbi-container__RAND__], [id=VcrIdUbi-container-readonly__RAND__]').html('<span class="match-text" id="VcrIdUbi-match-text">' + resp.results[0].text + '</span>');
					if(resp.results[0].id == '<?php echo empty_lookup_value; ?>') { $j('.btn[id=ubicacion_view_parent]').hide(); } else { $j('.btn[id=ubicacion_view_parent]').show(); }

					if(typeof(VcrIdUbi_update_autofills__RAND__) == 'function') VcrIdUbi_update_autofills__RAND__();
				}
			});
		<?php } ?>

		}
		function VcrIdBarVe_reload__RAND__() {
		<?php if(($AllowUpdate || $AllowInsert) && !$dvprint) { ?>

			$j("#VcrIdBarVe-container__RAND__").select2({
				/* initial default value */
				initSelection: function(e, c) {
					$j.ajax({
						url: 'ajax_combo.php',
						dataType: 'json',
						data: { id: AppGini.current_VcrIdBarVe__RAND__.value, t: 'natural', f: 'VcrIdBarVe' },
						success: function(resp) {
							c({
								id: resp.results[0].id,
								text: resp.results[0].text
							});
							$j('[name="VcrIdBarVe"]').val(resp.results[0].id);
							$j('[id=VcrIdBarVe-container-readonly__RAND__]').html('<span class="match-text" id="VcrIdBarVe-match-text">' + resp.results[0].text + '</span>');
							if(resp.results[0].id == '<?php echo empty_lookup_value; ?>') { $j('.btn[id=barrios_view_parent]').hide(); } else { $j('.btn[id=barrios_view_parent]').show(); }


							if(typeof(VcrIdBarVe_update_autofills__RAND__) == 'function') VcrIdBarVe_update_autofills__RAND__();
						}
					});
				},
				width: '100%',
				formatNoMatches: function(term) { return '<?php echo addslashes($Translation['No matches found!']); ?>'; },
				minimumResultsForSearch: 5,
				loadMorePadding: 200,
				ajax: {
					url: 'ajax_combo.php',
					dataType: 'json',
					cache: true,
					data: function(term, page) { return { s: term, p: page, t: 'natural', f: 'VcrIdBarVe' }; },
					results: function(resp, page) { return resp; }
				},
				escapeMarkup: function(str) { return str; }
			}).on('change', function(e) {
				AppGini.current_VcrIdBarVe__RAND__.value = e.added.id;
				AppGini.current_VcrIdBarVe__RAND__.text = e.added.text;
				$j('[name="VcrIdBarVe"]').val(e.added.id);
				if(e.added.id == '<?php echo empty_lookup_value; ?>') { $j('.btn[id=barrios_view_parent]').hide(); } else { $j('.btn[id=barrios_view_parent]').show(); }


				if(typeof(VcrIdBarVe_update_autofills__RAND__) == 'function') VcrIdBarVe_update_autofills__RAND__();
			});

			if(!$j("#VcrIdBarVe-container__RAND__").length) {
				$j.ajax({
					url: 'ajax_combo.php',
					dataType: 'json',
					data: { id: AppGini.current_VcrIdBarVe__RAND__.value, t: 'natural', f: 'VcrIdBarVe' },
					success: function(resp) {
						$j('[name="VcrIdBarVe"]').val(resp.results[0].id);
						$j('[id=VcrIdBarVe-container-readonly__RAND__]').html('<span class="match-text" id="VcrIdBarVe-match-text">' + resp.results[0].text + '</span>');
						if(resp.results[0].id == '<?php echo empty_lookup_value; ?>') { $j('.btn[id=barrios_view_parent]').hide(); } else { $j('.btn[id=barrios_view_parent]').show(); }

						if(typeof(VcrIdBarVe_update_autofills__RAND__) == 'function') VcrIdBarVe_update_autofills__RAND__();
					}
				});
			}

		<?php } else { ?>

			$j.ajax({
				url: 'ajax_combo.php',
				dataType: 'json',
				data: { id: AppGini.current_VcrIdBarVe__RAND__.value, t: 'natural', f: 'VcrIdBarVe' },
				success: function(resp) {
					$j('[id=VcrIdBarVe-container__RAND__], [id=VcrIdBarVe-container-readonly__RAND__]').html('<span class="match-text" id="VcrIdBarVe-match-text">' + resp.results[0].text + '</span>');
					if(resp.results[0].id == '<?php echo empty_lookup_value; ?>') { $j('.btn[id=barrios_view_parent]').hide(); } else { $j('.btn[id=barrios_view_parent]').show(); }

					if(typeof(VcrIdBarVe_update_autofills__RAND__) == 'function') VcrIdBarVe_update_autofills__RAND__();
				}
			});
		<?php } ?>

		}
		function VcrIdCorr_reload__RAND__() {
		<?php if(($AllowUpdate || $AllowInsert) && !$dvprint) { ?>

			$j("#VcrIdCorr-container__RAND__").select2({
				/* initial default value */
				initSelection: function(e, c) {
					$j.ajax({
						url: 'ajax_combo.php',
						dataType: 'json',
						data: { id: AppGini.current_VcrIdCorr__RAND__.value, t: 'natural', f: 'VcrIdCorr' },
						success: function(resp) {
							c({
								id: resp.results[0].id,
								text: resp.results[0].text
							});
							$j('[name="VcrIdCorr"]').val(resp.results[0].id);
							$j('[id=VcrIdCorr-container-readonly__RAND__]').html('<span class="match-text" id="VcrIdCorr-match-text">' + resp.results[0].text + '</span>');
							if(resp.results[0].id == '<?php echo empty_lookup_value; ?>') { $j('.btn[id=corregimientos_view_parent]').hide(); } else { $j('.btn[id=corregimientos_view_parent]').show(); }


							if(typeof(VcrIdCorr_update_autofills__RAND__) == 'function') VcrIdCorr_update_autofills__RAND__();
						}
					});
				},
				width: '100%',
				formatNoMatches: function(term) { return '<?php echo addslashes($Translation['No matches found!']); ?>'; },
				minimumResultsForSearch: 5,
				loadMorePadding: 200,
				ajax: {
					url: 'ajax_combo.php',
					dataType: 'json',
					cache: true,
					data: function(term, page) { return { s: term, p: page, t: 'natural', f: 'VcrIdCorr' }; },
					results: function(resp, page) { return resp; }
				},
				escapeMarkup: function(str) { return str; }
			}).on('change', function(e) {
				AppGini.current_VcrIdCorr__RAND__.value = e.added.id;
				AppGini.current_VcrIdCorr__RAND__.text = e.added.text;
				$j('[name="VcrIdCorr"]').val(e.added.id);
				if(e.added.id == '<?php echo empty_lookup_value; ?>') { $j('.btn[id=corregimientos_view_parent]').hide(); } else { $j('.btn[id=corregimientos_view_parent]').show(); }


				if(typeof(VcrIdCorr_update_autofills__RAND__) == 'function') VcrIdCorr_update_autofills__RAND__();
			});

			if(!$j("#VcrIdCorr-container__RAND__").length) {
				$j.ajax({
					url: 'ajax_combo.php',
					dataType: 'json',
					data: { id: AppGini.current_VcrIdCorr__RAND__.value, t: 'natural', f: 'VcrIdCorr' },
					success: function(resp) {
						$j('[name="VcrIdCorr"]').val(resp.results[0].id);
						$j('[id=VcrIdCorr-container-readonly__RAND__]').html('<span class="match-text" id="VcrIdCorr-match-text">' + resp.results[0].text + '</span>');
						if(resp.results[0].id == '<?php echo empty_lookup_value; ?>') { $j('.btn[id=corregimientos_view_parent]').hide(); } else { $j('.btn[id=corregimientos_view_parent]').show(); }

						if(typeof(VcrIdCorr_update_autofills__RAND__) == 'function') VcrIdCorr_update_autofills__RAND__();
					}
				});
			}

		<?php } else { ?>

			$j.ajax({
				url: 'ajax_combo.php',
				dataType: 'json',
				data: { id: AppGini.current_VcrIdCorr__RAND__.value, t: 'natural', f: 'VcrIdCorr' },
				success: function(resp) {
					$j('[id=VcrIdCorr-container__RAND__], [id=VcrIdCorr-container-readonly__RAND__]').html('<span class="match-text" id="VcrIdCorr-match-text">' + resp.results[0].text + '</span>');
					if(resp.results[0].id == '<?php echo empty_lookup_value; ?>') { $j('.btn[id=corregimientos_view_parent]').hide(); } else { $j('.btn[id=corregimientos_view_parent]').show(); }

					if(typeof(VcrIdCorr_update_autofills__RAND__) == 'function') VcrIdCorr_update_autofills__RAND__();
				}
			});
		<?php } ?>

		}
		function VcrIdCom_reload__RAND__() {
		<?php if(($AllowUpdate || $AllowInsert) && !$dvprint) { ?>

			$j("#VcrIdCom-container__RAND__").select2({
				/* initial default value */
				initSelection: function(e, c) {
					$j.ajax({
						url: 'ajax_combo.php',
						dataType: 'json',
						data: { id: AppGini.current_VcrIdCom__RAND__.value, t: 'natural', f: 'VcrIdCom' },
						success: function(resp) {
							c({
								id: resp.results[0].id,
								text: resp.results[0].text
							});
							$j('[name="VcrIdCom"]').val(resp.results[0].id);
							$j('[id=VcrIdCom-container-readonly__RAND__]').html('<span class="match-text" id="VcrIdCom-match-text">' + resp.results[0].text + '</span>');
							if(resp.results[0].id == '<?php echo empty_lookup_value; ?>') { $j('.btn[id=comunas_view_parent]').hide(); } else { $j('.btn[id=comunas_view_parent]').show(); }


							if(typeof(VcrIdCom_update_autofills__RAND__) == 'function') VcrIdCom_update_autofills__RAND__();
						}
					});
				},
				width: '100%',
				formatNoMatches: function(term) { return '<?php echo addslashes($Translation['No matches found!']); ?>'; },
				minimumResultsForSearch: 5,
				loadMorePadding: 200,
				ajax: {
					url: 'ajax_combo.php',
					dataType: 'json',
					cache: true,
					data: function(term, page) { return { s: term, p: page, t: 'natural', f: 'VcrIdCom' }; },
					results: function(resp, page) { return resp; }
				},
				escapeMarkup: function(str) { return str; }
			}).on('change', function(e) {
				AppGini.current_VcrIdCom__RAND__.value = e.added.id;
				AppGini.current_VcrIdCom__RAND__.text = e.added.text;
				$j('[name="VcrIdCom"]').val(e.added.id);
				if(e.added.id == '<?php echo empty_lookup_value; ?>') { $j('.btn[id=comunas_view_parent]').hide(); } else { $j('.btn[id=comunas_view_parent]').show(); }


				if(typeof(VcrIdCom_update_autofills__RAND__) == 'function') VcrIdCom_update_autofills__RAND__();
			});

			if(!$j("#VcrIdCom-container__RAND__").length) {
				$j.ajax({
					url: 'ajax_combo.php',
					dataType: 'json',
					data: { id: AppGini.current_VcrIdCom__RAND__.value, t: 'natural', f: 'VcrIdCom' },
					success: function(resp) {
						$j('[name="VcrIdCom"]').val(resp.results[0].id);
						$j('[id=VcrIdCom-container-readonly__RAND__]').html('<span class="match-text" id="VcrIdCom-match-text">' + resp.results[0].text + '</span>');
						if(resp.results[0].id == '<?php echo empty_lookup_value; ?>') { $j('.btn[id=comunas_view_parent]').hide(); } else { $j('.btn[id=comunas_view_parent]').show(); }

						if(typeof(VcrIdCom_update_autofills__RAND__) == 'function') VcrIdCom_update_autofills__RAND__();
					}
				});
			}

		<?php } else { ?>

			$j.ajax({
				url: 'ajax_combo.php',
				dataType: 'json',
				data: { id: AppGini.current_VcrIdCom__RAND__.value, t: 'natural', f: 'VcrIdCom' },
				success: function(resp) {
					$j('[id=VcrIdCom-container__RAND__], [id=VcrIdCom-container-readonly__RAND__]').html('<span class="match-text" id="VcrIdCom-match-text">' + resp.results[0].text + '</span>');
					if(resp.results[0].id == '<?php echo empty_lookup_value; ?>') { $j('.btn[id=comunas_view_parent]').hide(); } else { $j('.btn[id=comunas_view_parent]').show(); }

					if(typeof(VcrIdCom_update_autofills__RAND__) == 'function') VcrIdCom_update_autofills__RAND__();
				}
			});
		<?php } ?>

		}
		function VcrIdFen_reload__RAND__() {
		<?php if(($AllowUpdate || $AllowInsert) && !$dvprint) { ?>

			$j("#VcrIdFen-container__RAND__").select2({
				/* initial default value */
				initSelection: function(e, c) {
					$j.ajax({
						url: 'ajax_combo.php',
						dataType: 'json',
						data: { id: AppGini.current_VcrIdFen__RAND__.value, t: 'natural', f: 'VcrIdFen' },
						success: function(resp) {
							c({
								id: resp.results[0].id,
								text: resp.results[0].text
							});
							$j('[name="VcrIdFen"]').val(resp.results[0].id);
							$j('[id=VcrIdFen-container-readonly__RAND__]').html('<span class="match-text" id="VcrIdFen-match-text">' + resp.results[0].text + '</span>');
							if(resp.results[0].id == '<?php echo empty_lookup_value; ?>') { $j('.btn[id=fenomenos_view_parent]').hide(); } else { $j('.btn[id=fenomenos_view_parent]').show(); }


							if(typeof(VcrIdFen_update_autofills__RAND__) == 'function') VcrIdFen_update_autofills__RAND__();
						}
					});
				},
				width: '100%',
				formatNoMatches: function(term) { return '<?php echo addslashes($Translation['No matches found!']); ?>'; },
				minimumResultsForSearch: 5,
				loadMorePadding: 200,
				ajax: {
					url: 'ajax_combo.php',
					dataType: 'json',
					cache: true,
					data: function(term, page) { return { s: term, p: page, t: 'natural', f: 'VcrIdFen' }; },
					results: function(resp, page) { return resp; }
				},
				escapeMarkup: function(str) { return str; }
			}).on('change', function(e) {
				AppGini.current_VcrIdFen__RAND__.value = e.added.id;
				AppGini.current_VcrIdFen__RAND__.text = e.added.text;
				$j('[name="VcrIdFen"]').val(e.added.id);
				if(e.added.id == '<?php echo empty_lookup_value; ?>') { $j('.btn[id=fenomenos_view_parent]').hide(); } else { $j('.btn[id=fenomenos_view_parent]').show(); }


				if(typeof(VcrIdFen_update_autofills__RAND__) == 'function') VcrIdFen_update_autofills__RAND__();
			});

			if(!$j("#VcrIdFen-container__RAND__").length) {
				$j.ajax({
					url: 'ajax_combo.php',
					dataType: 'json',
					data: { id: AppGini.current_VcrIdFen__RAND__.value, t: 'natural', f: 'VcrIdFen' },
					success: function(resp) {
						$j('[name="VcrIdFen"]').val(resp.results[0].id);
						$j('[id=VcrIdFen-container-readonly__RAND__]').html('<span class="match-text" id="VcrIdFen-match-text">' + resp.results[0].text + '</span>');
						if(resp.results[0].id == '<?php echo empty_lookup_value; ?>') { $j('.btn[id=fenomenos_view_parent]').hide(); } else { $j('.btn[id=fenomenos_view_parent]').show(); }

						if(typeof(VcrIdFen_update_autofills__RAND__) == 'function') VcrIdFen_update_autofills__RAND__();
					}
				});
			}

		<?php } else { ?>

			$j.ajax({
				url: 'ajax_combo.php',
				dataType: 'json',
				data: { id: AppGini.current_VcrIdFen__RAND__.value, t: 'natural', f: 'VcrIdFen' },
				success: function(resp) {
					$j('[id=VcrIdFen-container__RAND__], [id=VcrIdFen-container-readonly__RAND__]').html('<span class="match-text" id="VcrIdFen-match-text">' + resp.results[0].text + '</span>');
					if(resp.results[0].id == '<?php echo empty_lookup_value; ?>') { $j('.btn[id=fenomenos_view_parent]').hide(); } else { $j('.btn[id=fenomenos_view_parent]').show(); }

					if(typeof(VcrIdFen_update_autofills__RAND__) == 'function') VcrIdFen_update_autofills__RAND__();
				}
			});
		<?php } ?>

		}
		function VcrIdCar_reload__RAND__() {
		<?php if(($AllowUpdate || $AllowInsert) && !$dvprint) { ?>

			$j("#VcrIdCar-container__RAND__").select2({
				/* initial default value */
				initSelection: function(e, c) {
					$j.ajax({
						url: 'ajax_combo.php',
						dataType: 'json',
						data: { id: AppGini.current_VcrIdCar__RAND__.value, t: 'natural', f: 'VcrIdCar' },
						success: function(resp) {
							c({
								id: resp.results[0].id,
								text: resp.results[0].text
							});
							$j('[name="VcrIdCar"]').val(resp.results[0].id);
							$j('[id=VcrIdCar-container-readonly__RAND__]').html('<span class="match-text" id="VcrIdCar-match-text">' + resp.results[0].text + '</span>');
							if(resp.results[0].id == '<?php echo empty_lookup_value; ?>') { $j('.btn[id=caracteristicas_evento_view_parent]').hide(); } else { $j('.btn[id=caracteristicas_evento_view_parent]').show(); }


							if(typeof(VcrIdCar_update_autofills__RAND__) == 'function') VcrIdCar_update_autofills__RAND__();
						}
					});
				},
				width: '100%',
				formatNoMatches: function(term) { return '<?php echo addslashes($Translation['No matches found!']); ?>'; },
				minimumResultsForSearch: 5,
				loadMorePadding: 200,
				ajax: {
					url: 'ajax_combo.php',
					dataType: 'json',
					cache: true,
					data: function(term, page) { return { s: term, p: page, t: 'natural', f: 'VcrIdCar' }; },
					results: function(resp, page) { return resp; }
				},
				escapeMarkup: function(str) { return str; }
			}).on('change', function(e) {
				AppGini.current_VcrIdCar__RAND__.value = e.added.id;
				AppGini.current_VcrIdCar__RAND__.text = e.added.text;
				$j('[name="VcrIdCar"]').val(e.added.id);
				if(e.added.id == '<?php echo empty_lookup_value; ?>') { $j('.btn[id=caracteristicas_evento_view_parent]').hide(); } else { $j('.btn[id=caracteristicas_evento_view_parent]').show(); }


				if(typeof(VcrIdCar_update_autofills__RAND__) == 'function') VcrIdCar_update_autofills__RAND__();
			});

			if(!$j("#VcrIdCar-container__RAND__").length) {
				$j.ajax({
					url: 'ajax_combo.php',
					dataType: 'json',
					data: { id: AppGini.current_VcrIdCar__RAND__.value, t: 'natural', f: 'VcrIdCar' },
					success: function(resp) {
						$j('[name="VcrIdCar"]').val(resp.results[0].id);
						$j('[id=VcrIdCar-container-readonly__RAND__]').html('<span class="match-text" id="VcrIdCar-match-text">' + resp.results[0].text + '</span>');
						if(resp.results[0].id == '<?php echo empty_lookup_value; ?>') { $j('.btn[id=caracteristicas_evento_view_parent]').hide(); } else { $j('.btn[id=caracteristicas_evento_view_parent]').show(); }

						if(typeof(VcrIdCar_update_autofills__RAND__) == 'function') VcrIdCar_update_autofills__RAND__();
					}
				});
			}

		<?php } else { ?>

			$j.ajax({
				url: 'ajax_combo.php',
				dataType: 'json',
				data: { id: AppGini.current_VcrIdCar__RAND__.value, t: 'natural', f: 'VcrIdCar' },
				success: function(resp) {
					$j('[id=VcrIdCar-container__RAND__], [id=VcrIdCar-container-readonly__RAND__]').html('<span class="match-text" id="VcrIdCar-match-text">' + resp.results[0].text + '</span>');
					if(resp.results[0].id == '<?php echo empty_lookup_value; ?>') { $j('.btn[id=caracteristicas_evento_view_parent]').hide(); } else { $j('.btn[id=caracteristicas_evento_view_parent]').show(); }

					if(typeof(VcrIdCar_update_autofills__RAND__) == 'function') VcrIdCar_update_autofills__RAND__();
				}
			});
		<?php } ?>

		}
		function VcrIdEdi_reload__RAND__() {
		<?php if(($AllowUpdate || $AllowInsert) && !$dvprint) { ?>

			$j("#VcrIdEdi-container__RAND__").select2({
				/* initial default value */
				initSelection: function(e, c) {
					$j.ajax({
						url: 'ajax_combo.php',
						dataType: 'json',
						data: { id: AppGini.current_VcrIdEdi__RAND__.value, t: 'natural', f: 'VcrIdEdi' },
						success: function(resp) {
							c({
								id: resp.results[0].id,
								text: resp.results[0].text
							});
							$j('[name="VcrIdEdi"]').val(resp.results[0].id);
							$j('[id=VcrIdEdi-container-readonly__RAND__]').html('<span class="match-text" id="VcrIdEdi-match-text">' + resp.results[0].text + '</span>');
							if(resp.results[0].id == '<?php echo empty_lookup_value; ?>') { $j('.btn[id=edificacion_view_parent]').hide(); } else { $j('.btn[id=edificacion_view_parent]').show(); }


							if(typeof(VcrIdEdi_update_autofills__RAND__) == 'function') VcrIdEdi_update_autofills__RAND__();
						}
					});
				},
				width: '100%',
				formatNoMatches: function(term) { return '<?php echo addslashes($Translation['No matches found!']); ?>'; },
				minimumResultsForSearch: 5,
				loadMorePadding: 200,
				ajax: {
					url: 'ajax_combo.php',
					dataType: 'json',
					cache: true,
					data: function(term, page) { return { s: term, p: page, t: 'natural', f: 'VcrIdEdi' }; },
					results: function(resp, page) { return resp; }
				},
				escapeMarkup: function(str) { return str; }
			}).on('change', function(e) {
				AppGini.current_VcrIdEdi__RAND__.value = e.added.id;
				AppGini.current_VcrIdEdi__RAND__.text = e.added.text;
				$j('[name="VcrIdEdi"]').val(e.added.id);
				if(e.added.id == '<?php echo empty_lookup_value; ?>') { $j('.btn[id=edificacion_view_parent]').hide(); } else { $j('.btn[id=edificacion_view_parent]').show(); }


				if(typeof(VcrIdEdi_update_autofills__RAND__) == 'function') VcrIdEdi_update_autofills__RAND__();
			});

			if(!$j("#VcrIdEdi-container__RAND__").length) {
				$j.ajax({
					url: 'ajax_combo.php',
					dataType: 'json',
					data: { id: AppGini.current_VcrIdEdi__RAND__.value, t: 'natural', f: 'VcrIdEdi' },
					success: function(resp) {
						$j('[name="VcrIdEdi"]').val(resp.results[0].id);
						$j('[id=VcrIdEdi-container-readonly__RAND__]').html('<span class="match-text" id="VcrIdEdi-match-text">' + resp.results[0].text + '</span>');
						if(resp.results[0].id == '<?php echo empty_lookup_value; ?>') { $j('.btn[id=edificacion_view_parent]').hide(); } else { $j('.btn[id=edificacion_view_parent]').show(); }

						if(typeof(VcrIdEdi_update_autofills__RAND__) == 'function') VcrIdEdi_update_autofills__RAND__();
					}
				});
			}

		<?php } else { ?>

			$j.ajax({
				url: 'ajax_combo.php',
				dataType: 'json',
				data: { id: AppGini.current_VcrIdEdi__RAND__.value, t: 'natural', f: 'VcrIdEdi' },
				success: function(resp) {
					$j('[id=VcrIdEdi-container__RAND__], [id=VcrIdEdi-container-readonly__RAND__]').html('<span class="match-text" id="VcrIdEdi-match-text">' + resp.results[0].text + '</span>');
					if(resp.results[0].id == '<?php echo empty_lookup_value; ?>') { $j('.btn[id=edificacion_view_parent]').hide(); } else { $j('.btn[id=edificacion_view_parent]').show(); }

					if(typeof(VcrIdEdi_update_autofills__RAND__) == 'function') VcrIdEdi_update_autofills__RAND__();
				}
			});
		<?php } ?>

		}
		function VcrIdAfe_reload__RAND__() {
		<?php if(($AllowUpdate || $AllowInsert) && !$dvprint) { ?>

			$j("#VcrIdAfe-container__RAND__").select2({
				/* initial default value */
				initSelection: function(e, c) {
					$j.ajax({
						url: 'ajax_combo.php',
						dataType: 'json',
						data: { id: AppGini.current_VcrIdAfe__RAND__.value, t: 'natural', f: 'VcrIdAfe' },
						success: function(resp) {
							c({
								id: resp.results[0].id,
								text: resp.results[0].text
							});
							$j('[name="VcrIdAfe"]').val(resp.results[0].id);
							$j('[id=VcrIdAfe-container-readonly__RAND__]').html('<span class="match-text" id="VcrIdAfe-match-text">' + resp.results[0].text + '</span>');
							if(resp.results[0].id == '<?php echo empty_lookup_value; ?>') { $j('.btn[id=afectacion_view_parent]').hide(); } else { $j('.btn[id=afectacion_view_parent]').show(); }


							if(typeof(VcrIdAfe_update_autofills__RAND__) == 'function') VcrIdAfe_update_autofills__RAND__();
						}
					});
				},
				width: '100%',
				formatNoMatches: function(term) { return '<?php echo addslashes($Translation['No matches found!']); ?>'; },
				minimumResultsForSearch: 5,
				loadMorePadding: 200,
				ajax: {
					url: 'ajax_combo.php',
					dataType: 'json',
					cache: true,
					data: function(term, page) { return { s: term, p: page, t: 'natural', f: 'VcrIdAfe' }; },
					results: function(resp, page) { return resp; }
				},
				escapeMarkup: function(str) { return str; }
			}).on('change', function(e) {
				AppGini.current_VcrIdAfe__RAND__.value = e.added.id;
				AppGini.current_VcrIdAfe__RAND__.text = e.added.text;
				$j('[name="VcrIdAfe"]').val(e.added.id);
				if(e.added.id == '<?php echo empty_lookup_value; ?>') { $j('.btn[id=afectacion_view_parent]').hide(); } else { $j('.btn[id=afectacion_view_parent]').show(); }


				if(typeof(VcrIdAfe_update_autofills__RAND__) == 'function') VcrIdAfe_update_autofills__RAND__();
			});

			if(!$j("#VcrIdAfe-container__RAND__").length) {
				$j.ajax({
					url: 'ajax_combo.php',
					dataType: 'json',
					data: { id: AppGini.current_VcrIdAfe__RAND__.value, t: 'natural', f: 'VcrIdAfe' },
					success: function(resp) {
						$j('[name="VcrIdAfe"]').val(resp.results[0].id);
						$j('[id=VcrIdAfe-container-readonly__RAND__]').html('<span class="match-text" id="VcrIdAfe-match-text">' + resp.results[0].text + '</span>');
						if(resp.results[0].id == '<?php echo empty_lookup_value; ?>') { $j('.btn[id=afectacion_view_parent]').hide(); } else { $j('.btn[id=afectacion_view_parent]').show(); }

						if(typeof(VcrIdAfe_update_autofills__RAND__) == 'function') VcrIdAfe_update_autofills__RAND__();
					}
				});
			}

		<?php } else { ?>

			$j.ajax({
				url: 'ajax_combo.php',
				dataType: 'json',
				data: { id: AppGini.current_VcrIdAfe__RAND__.value, t: 'natural', f: 'VcrIdAfe' },
				success: function(resp) {
					$j('[id=VcrIdAfe-container__RAND__], [id=VcrIdAfe-container-readonly__RAND__]').html('<span class="match-text" id="VcrIdAfe-match-text">' + resp.results[0].text + '</span>');
					if(resp.results[0].id == '<?php echo empty_lookup_value; ?>') { $j('.btn[id=afectacion_view_parent]').hide(); } else { $j('.btn[id=afectacion_view_parent]').show(); }

					if(typeof(VcrIdAfe_update_autofills__RAND__) == 'function') VcrIdAfe_update_autofills__RAND__();
				}
			});
		<?php } ?>

		}
		function VcrIdMat_reload__RAND__() {
		<?php if(($AllowUpdate || $AllowInsert) && !$dvprint) { ?>

			$j("#VcrIdMat-container__RAND__").select2({
				/* initial default value */
				initSelection: function(e, c) {
					$j.ajax({
						url: 'ajax_combo.php',
						dataType: 'json',
						data: { id: AppGini.current_VcrIdMat__RAND__.value, t: 'natural', f: 'VcrIdMat' },
						success: function(resp) {
							c({
								id: resp.results[0].id,
								text: resp.results[0].text
							});
							$j('[name="VcrIdMat"]').val(resp.results[0].id);
							$j('[id=VcrIdMat-container-readonly__RAND__]').html('<span class="match-text" id="VcrIdMat-match-text">' + resp.results[0].text + '</span>');
							if(resp.results[0].id == '<?php echo empty_lookup_value; ?>') { $j('.btn[id=tipo_material_view_parent]').hide(); } else { $j('.btn[id=tipo_material_view_parent]').show(); }


							if(typeof(VcrIdMat_update_autofills__RAND__) == 'function') VcrIdMat_update_autofills__RAND__();
						}
					});
				},
				width: '100%',
				formatNoMatches: function(term) { return '<?php echo addslashes($Translation['No matches found!']); ?>'; },
				minimumResultsForSearch: 5,
				loadMorePadding: 200,
				ajax: {
					url: 'ajax_combo.php',
					dataType: 'json',
					cache: true,
					data: function(term, page) { return { s: term, p: page, t: 'natural', f: 'VcrIdMat' }; },
					results: function(resp, page) { return resp; }
				},
				escapeMarkup: function(str) { return str; }
			}).on('change', function(e) {
				AppGini.current_VcrIdMat__RAND__.value = e.added.id;
				AppGini.current_VcrIdMat__RAND__.text = e.added.text;
				$j('[name="VcrIdMat"]').val(e.added.id);
				if(e.added.id == '<?php echo empty_lookup_value; ?>') { $j('.btn[id=tipo_material_view_parent]').hide(); } else { $j('.btn[id=tipo_material_view_parent]').show(); }


				if(typeof(VcrIdMat_update_autofills__RAND__) == 'function') VcrIdMat_update_autofills__RAND__();
			});

			if(!$j("#VcrIdMat-container__RAND__").length) {
				$j.ajax({
					url: 'ajax_combo.php',
					dataType: 'json',
					data: { id: AppGini.current_VcrIdMat__RAND__.value, t: 'natural', f: 'VcrIdMat' },
					success: function(resp) {
						$j('[name="VcrIdMat"]').val(resp.results[0].id);
						$j('[id=VcrIdMat-container-readonly__RAND__]').html('<span class="match-text" id="VcrIdMat-match-text">' + resp.results[0].text + '</span>');
						if(resp.results[0].id == '<?php echo empty_lookup_value; ?>') { $j('.btn[id=tipo_material_view_parent]').hide(); } else { $j('.btn[id=tipo_material_view_parent]').show(); }

						if(typeof(VcrIdMat_update_autofills__RAND__) == 'function') VcrIdMat_update_autofills__RAND__();
					}
				});
			}

		<?php } else { ?>

			$j.ajax({
				url: 'ajax_combo.php',
				dataType: 'json',
				data: { id: AppGini.current_VcrIdMat__RAND__.value, t: 'natural', f: 'VcrIdMat' },
				success: function(resp) {
					$j('[id=VcrIdMat-container__RAND__], [id=VcrIdMat-container-readonly__RAND__]').html('<span class="match-text" id="VcrIdMat-match-text">' + resp.results[0].text + '</span>');
					if(resp.results[0].id == '<?php echo empty_lookup_value; ?>') { $j('.btn[id=tipo_material_view_parent]').hide(); } else { $j('.btn[id=tipo_material_view_parent]').show(); }

					if(typeof(VcrIdMat_update_autofills__RAND__) == 'function') VcrIdMat_update_autofills__RAND__();
				}
			});
		<?php } ?>

		}
		function VcrIdLes_reload__RAND__() {
		<?php if(($AllowUpdate || $AllowInsert) && !$dvprint) { ?>

			$j("#VcrIdLes-container__RAND__").select2({
				/* initial default value */
				initSelection: function(e, c) {
					$j.ajax({
						url: 'ajax_combo.php',
						dataType: 'json',
						data: { id: AppGini.current_VcrIdLes__RAND__.value, t: 'natural', f: 'VcrIdLes' },
						success: function(resp) {
							c({
								id: resp.results[0].id,
								text: resp.results[0].text
							});
							$j('[name="VcrIdLes"]').val(resp.results[0].id);
							$j('[id=VcrIdLes-container-readonly__RAND__]').html('<span class="match-text" id="VcrIdLes-match-text">' + resp.results[0].text + '</span>');
							if(resp.results[0].id == '<?php echo empty_lookup_value; ?>') { $j('.btn[id=lesiones_view_parent]').hide(); } else { $j('.btn[id=lesiones_view_parent]').show(); }


							if(typeof(VcrIdLes_update_autofills__RAND__) == 'function') VcrIdLes_update_autofills__RAND__();
						}
					});
				},
				width: '100%',
				formatNoMatches: function(term) { return '<?php echo addslashes($Translation['No matches found!']); ?>'; },
				minimumResultsForSearch: 5,
				loadMorePadding: 200,
				ajax: {
					url: 'ajax_combo.php',
					dataType: 'json',
					cache: true,
					data: function(term, page) { return { s: term, p: page, t: 'natural', f: 'VcrIdLes' }; },
					results: function(resp, page) { return resp; }
				},
				escapeMarkup: function(str) { return str; }
			}).on('change', function(e) {
				AppGini.current_VcrIdLes__RAND__.value = e.added.id;
				AppGini.current_VcrIdLes__RAND__.text = e.added.text;
				$j('[name="VcrIdLes"]').val(e.added.id);
				if(e.added.id == '<?php echo empty_lookup_value; ?>') { $j('.btn[id=lesiones_view_parent]').hide(); } else { $j('.btn[id=lesiones_view_parent]').show(); }


				if(typeof(VcrIdLes_update_autofills__RAND__) == 'function') VcrIdLes_update_autofills__RAND__();
			});

			if(!$j("#VcrIdLes-container__RAND__").length) {
				$j.ajax({
					url: 'ajax_combo.php',
					dataType: 'json',
					data: { id: AppGini.current_VcrIdLes__RAND__.value, t: 'natural', f: 'VcrIdLes' },
					success: function(resp) {
						$j('[name="VcrIdLes"]').val(resp.results[0].id);
						$j('[id=VcrIdLes-container-readonly__RAND__]').html('<span class="match-text" id="VcrIdLes-match-text">' + resp.results[0].text + '</span>');
						if(resp.results[0].id == '<?php echo empty_lookup_value; ?>') { $j('.btn[id=lesiones_view_parent]').hide(); } else { $j('.btn[id=lesiones_view_parent]').show(); }

						if(typeof(VcrIdLes_update_autofills__RAND__) == 'function') VcrIdLes_update_autofills__RAND__();
					}
				});
			}

		<?php } else { ?>

			$j.ajax({
				url: 'ajax_combo.php',
				dataType: 'json',
				data: { id: AppGini.current_VcrIdLes__RAND__.value, t: 'natural', f: 'VcrIdLes' },
				success: function(resp) {
					$j('[id=VcrIdLes-container__RAND__], [id=VcrIdLes-container-readonly__RAND__]').html('<span class="match-text" id="VcrIdLes-match-text">' + resp.results[0].text + '</span>');
					if(resp.results[0].id == '<?php echo empty_lookup_value; ?>') { $j('.btn[id=lesiones_view_parent]').hide(); } else { $j('.btn[id=lesiones_view_parent]').show(); }

					if(typeof(VcrIdLes_update_autofills__RAND__) == 'function') VcrIdLes_update_autofills__RAND__();
				}
			});
		<?php } ?>

		}
		function VcrIdCap_reload__RAND__() {
		<?php if(($AllowUpdate || $AllowInsert) && !$dvprint) { ?>

			$j("#VcrIdCap-container__RAND__").select2({
				/* initial default value */
				initSelection: function(e, c) {
					$j.ajax({
						url: 'ajax_combo.php',
						dataType: 'json',
						data: { id: AppGini.current_VcrIdCap__RAND__.value, t: 'natural', f: 'VcrIdCap' },
						success: function(resp) {
							c({
								id: resp.results[0].id,
								text: resp.results[0].text
							});
							$j('[name="VcrIdCap"]').val(resp.results[0].id);
							$j('[id=VcrIdCap-container-readonly__RAND__]').html('<span class="match-text" id="VcrIdCap-match-text">' + resp.results[0].text + '</span>');
							if(resp.results[0].id == '<?php echo empty_lookup_value; ?>') { $j('.btn[id=capacidad_reducida_view_parent]').hide(); } else { $j('.btn[id=capacidad_reducida_view_parent]').show(); }


							if(typeof(VcrIdCap_update_autofills__RAND__) == 'function') VcrIdCap_update_autofills__RAND__();
						}
					});
				},
				width: '100%',
				formatNoMatches: function(term) { return '<?php echo addslashes($Translation['No matches found!']); ?>'; },
				minimumResultsForSearch: 5,
				loadMorePadding: 200,
				ajax: {
					url: 'ajax_combo.php',
					dataType: 'json',
					cache: true,
					data: function(term, page) { return { s: term, p: page, t: 'natural', f: 'VcrIdCap' }; },
					results: function(resp, page) { return resp; }
				},
				escapeMarkup: function(str) { return str; }
			}).on('change', function(e) {
				AppGini.current_VcrIdCap__RAND__.value = e.added.id;
				AppGini.current_VcrIdCap__RAND__.text = e.added.text;
				$j('[name="VcrIdCap"]').val(e.added.id);
				if(e.added.id == '<?php echo empty_lookup_value; ?>') { $j('.btn[id=capacidad_reducida_view_parent]').hide(); } else { $j('.btn[id=capacidad_reducida_view_parent]').show(); }


				if(typeof(VcrIdCap_update_autofills__RAND__) == 'function') VcrIdCap_update_autofills__RAND__();
			});

			if(!$j("#VcrIdCap-container__RAND__").length) {
				$j.ajax({
					url: 'ajax_combo.php',
					dataType: 'json',
					data: { id: AppGini.current_VcrIdCap__RAND__.value, t: 'natural', f: 'VcrIdCap' },
					success: function(resp) {
						$j('[name="VcrIdCap"]').val(resp.results[0].id);
						$j('[id=VcrIdCap-container-readonly__RAND__]').html('<span class="match-text" id="VcrIdCap-match-text">' + resp.results[0].text + '</span>');
						if(resp.results[0].id == '<?php echo empty_lookup_value; ?>') { $j('.btn[id=capacidad_reducida_view_parent]').hide(); } else { $j('.btn[id=capacidad_reducida_view_parent]').show(); }

						if(typeof(VcrIdCap_update_autofills__RAND__) == 'function') VcrIdCap_update_autofills__RAND__();
					}
				});
			}

		<?php } else { ?>

			$j.ajax({
				url: 'ajax_combo.php',
				dataType: 'json',
				data: { id: AppGini.current_VcrIdCap__RAND__.value, t: 'natural', f: 'VcrIdCap' },
				success: function(resp) {
					$j('[id=VcrIdCap-container__RAND__], [id=VcrIdCap-container-readonly__RAND__]').html('<span class="match-text" id="VcrIdCap-match-text">' + resp.results[0].text + '</span>');
					if(resp.results[0].id == '<?php echo empty_lookup_value; ?>') { $j('.btn[id=capacidad_reducida_view_parent]').hide(); } else { $j('.btn[id=capacidad_reducida_view_parent]').show(); }

					if(typeof(VcrIdCap_update_autofills__RAND__) == 'function') VcrIdCap_update_autofills__RAND__();
				}
			});
		<?php } ?>

		}
		function VcrIdTra1_reload__RAND__() {
		<?php if(($AllowUpdate || $AllowInsert) && !$dvprint) { ?>

			$j("#VcrIdTra1-container__RAND__").select2({
				/* initial default value */
				initSelection: function(e, c) {
					$j.ajax({
						url: 'ajax_combo.php',
						dataType: 'json',
						data: { id: AppGini.current_VcrIdTra1__RAND__.value, t: 'natural', f: 'VcrIdTra1' },
						success: function(resp) {
							c({
								id: resp.results[0].id,
								text: resp.results[0].text
							});
							$j('[name="VcrIdTra1"]').val(resp.results[0].id);
							$j('[id=VcrIdTra1-container-readonly__RAND__]').html('<span class="match-text" id="VcrIdTra1-match-text">' + resp.results[0].text + '</span>');
							if(resp.results[0].id == '<?php echo empty_lookup_value; ?>') { $j('.btn[id=dependencias_view_parent]').hide(); } else { $j('.btn[id=dependencias_view_parent]').show(); }


							if(typeof(VcrIdTra1_update_autofills__RAND__) == 'function') VcrIdTra1_update_autofills__RAND__();
						}
					});
				},
				width: '100%',
				formatNoMatches: function(term) { return '<?php echo addslashes($Translation['No matches found!']); ?>'; },
				minimumResultsForSearch: 5,
				loadMorePadding: 200,
				ajax: {
					url: 'ajax_combo.php',
					dataType: 'json',
					cache: true,
					data: function(term, page) { return { s: term, p: page, t: 'natural', f: 'VcrIdTra1' }; },
					results: function(resp, page) { return resp; }
				},
				escapeMarkup: function(str) { return str; }
			}).on('change', function(e) {
				AppGini.current_VcrIdTra1__RAND__.value = e.added.id;
				AppGini.current_VcrIdTra1__RAND__.text = e.added.text;
				$j('[name="VcrIdTra1"]').val(e.added.id);
				if(e.added.id == '<?php echo empty_lookup_value; ?>') { $j('.btn[id=dependencias_view_parent]').hide(); } else { $j('.btn[id=dependencias_view_parent]').show(); }


				if(typeof(VcrIdTra1_update_autofills__RAND__) == 'function') VcrIdTra1_update_autofills__RAND__();
			});

			if(!$j("#VcrIdTra1-container__RAND__").length) {
				$j.ajax({
					url: 'ajax_combo.php',
					dataType: 'json',
					data: { id: AppGini.current_VcrIdTra1__RAND__.value, t: 'natural', f: 'VcrIdTra1' },
					success: function(resp) {
						$j('[name="VcrIdTra1"]').val(resp.results[0].id);
						$j('[id=VcrIdTra1-container-readonly__RAND__]').html('<span class="match-text" id="VcrIdTra1-match-text">' + resp.results[0].text + '</span>');
						if(resp.results[0].id == '<?php echo empty_lookup_value; ?>') { $j('.btn[id=dependencias_view_parent]').hide(); } else { $j('.btn[id=dependencias_view_parent]').show(); }

						if(typeof(VcrIdTra1_update_autofills__RAND__) == 'function') VcrIdTra1_update_autofills__RAND__();
					}
				});
			}

		<?php } else { ?>

			$j.ajax({
				url: 'ajax_combo.php',
				dataType: 'json',
				data: { id: AppGini.current_VcrIdTra1__RAND__.value, t: 'natural', f: 'VcrIdTra1' },
				success: function(resp) {
					$j('[id=VcrIdTra1-container__RAND__], [id=VcrIdTra1-container-readonly__RAND__]').html('<span class="match-text" id="VcrIdTra1-match-text">' + resp.results[0].text + '</span>');
					if(resp.results[0].id == '<?php echo empty_lookup_value; ?>') { $j('.btn[id=dependencias_view_parent]').hide(); } else { $j('.btn[id=dependencias_view_parent]').show(); }

					if(typeof(VcrIdTra1_update_autofills__RAND__) == 'function') VcrIdTra1_update_autofills__RAND__();
				}
			});
		<?php } ?>

		}
		function VcrdTra2_reload__RAND__() {
		<?php if(($AllowUpdate || $AllowInsert) && !$dvprint) { ?>

			$j("#VcrdTra2-container__RAND__").select2({
				/* initial default value */
				initSelection: function(e, c) {
					$j.ajax({
						url: 'ajax_combo.php',
						dataType: 'json',
						data: { id: AppGini.current_VcrdTra2__RAND__.value, t: 'natural', f: 'VcrdTra2' },
						success: function(resp) {
							c({
								id: resp.results[0].id,
								text: resp.results[0].text
							});
							$j('[name="VcrdTra2"]').val(resp.results[0].id);
							$j('[id=VcrdTra2-container-readonly__RAND__]').html('<span class="match-text" id="VcrdTra2-match-text">' + resp.results[0].text + '</span>');
							if(resp.results[0].id == '<?php echo empty_lookup_value; ?>') { $j('.btn[id=dependencias_view_parent]').hide(); } else { $j('.btn[id=dependencias_view_parent]').show(); }


							if(typeof(VcrdTra2_update_autofills__RAND__) == 'function') VcrdTra2_update_autofills__RAND__();
						}
					});
				},
				width: '100%',
				formatNoMatches: function(term) { return '<?php echo addslashes($Translation['No matches found!']); ?>'; },
				minimumResultsForSearch: 5,
				loadMorePadding: 200,
				ajax: {
					url: 'ajax_combo.php',
					dataType: 'json',
					cache: true,
					data: function(term, page) { return { s: term, p: page, t: 'natural', f: 'VcrdTra2' }; },
					results: function(resp, page) { return resp; }
				},
				escapeMarkup: function(str) { return str; }
			}).on('change', function(e) {
				AppGini.current_VcrdTra2__RAND__.value = e.added.id;
				AppGini.current_VcrdTra2__RAND__.text = e.added.text;
				$j('[name="VcrdTra2"]').val(e.added.id);
				if(e.added.id == '<?php echo empty_lookup_value; ?>') { $j('.btn[id=dependencias_view_parent]').hide(); } else { $j('.btn[id=dependencias_view_parent]').show(); }


				if(typeof(VcrdTra2_update_autofills__RAND__) == 'function') VcrdTra2_update_autofills__RAND__();
			});

			if(!$j("#VcrdTra2-container__RAND__").length) {
				$j.ajax({
					url: 'ajax_combo.php',
					dataType: 'json',
					data: { id: AppGini.current_VcrdTra2__RAND__.value, t: 'natural', f: 'VcrdTra2' },
					success: function(resp) {
						$j('[name="VcrdTra2"]').val(resp.results[0].id);
						$j('[id=VcrdTra2-container-readonly__RAND__]').html('<span class="match-text" id="VcrdTra2-match-text">' + resp.results[0].text + '</span>');
						if(resp.results[0].id == '<?php echo empty_lookup_value; ?>') { $j('.btn[id=dependencias_view_parent]').hide(); } else { $j('.btn[id=dependencias_view_parent]').show(); }

						if(typeof(VcrdTra2_update_autofills__RAND__) == 'function') VcrdTra2_update_autofills__RAND__();
					}
				});
			}

		<?php } else { ?>

			$j.ajax({
				url: 'ajax_combo.php',
				dataType: 'json',
				data: { id: AppGini.current_VcrdTra2__RAND__.value, t: 'natural', f: 'VcrdTra2' },
				success: function(resp) {
					$j('[id=VcrdTra2-container__RAND__], [id=VcrdTra2-container-readonly__RAND__]').html('<span class="match-text" id="VcrdTra2-match-text">' + resp.results[0].text + '</span>');
					if(resp.results[0].id == '<?php echo empty_lookup_value; ?>') { $j('.btn[id=dependencias_view_parent]').hide(); } else { $j('.btn[id=dependencias_view_parent]').show(); }

					if(typeof(VcrdTra2_update_autofills__RAND__) == 'function') VcrdTra2_update_autofills__RAND__();
				}
			});
		<?php } ?>

		}
		function VcrIdTra3_reload__RAND__() {
		<?php if(($AllowUpdate || $AllowInsert) && !$dvprint) { ?>

			$j("#VcrIdTra3-container__RAND__").select2({
				/* initial default value */
				initSelection: function(e, c) {
					$j.ajax({
						url: 'ajax_combo.php',
						dataType: 'json',
						data: { id: AppGini.current_VcrIdTra3__RAND__.value, t: 'natural', f: 'VcrIdTra3' },
						success: function(resp) {
							c({
								id: resp.results[0].id,
								text: resp.results[0].text
							});
							$j('[name="VcrIdTra3"]').val(resp.results[0].id);
							$j('[id=VcrIdTra3-container-readonly__RAND__]').html('<span class="match-text" id="VcrIdTra3-match-text">' + resp.results[0].text + '</span>');
							if(resp.results[0].id == '<?php echo empty_lookup_value; ?>') { $j('.btn[id=dependencias_view_parent]').hide(); } else { $j('.btn[id=dependencias_view_parent]').show(); }


							if(typeof(VcrIdTra3_update_autofills__RAND__) == 'function') VcrIdTra3_update_autofills__RAND__();
						}
					});
				},
				width: '100%',
				formatNoMatches: function(term) { return '<?php echo addslashes($Translation['No matches found!']); ?>'; },
				minimumResultsForSearch: 5,
				loadMorePadding: 200,
				ajax: {
					url: 'ajax_combo.php',
					dataType: 'json',
					cache: true,
					data: function(term, page) { return { s: term, p: page, t: 'natural', f: 'VcrIdTra3' }; },
					results: function(resp, page) { return resp; }
				},
				escapeMarkup: function(str) { return str; }
			}).on('change', function(e) {
				AppGini.current_VcrIdTra3__RAND__.value = e.added.id;
				AppGini.current_VcrIdTra3__RAND__.text = e.added.text;
				$j('[name="VcrIdTra3"]').val(e.added.id);
				if(e.added.id == '<?php echo empty_lookup_value; ?>') { $j('.btn[id=dependencias_view_parent]').hide(); } else { $j('.btn[id=dependencias_view_parent]').show(); }


				if(typeof(VcrIdTra3_update_autofills__RAND__) == 'function') VcrIdTra3_update_autofills__RAND__();
			});

			if(!$j("#VcrIdTra3-container__RAND__").length) {
				$j.ajax({
					url: 'ajax_combo.php',
					dataType: 'json',
					data: { id: AppGini.current_VcrIdTra3__RAND__.value, t: 'natural', f: 'VcrIdTra3' },
					success: function(resp) {
						$j('[name="VcrIdTra3"]').val(resp.results[0].id);
						$j('[id=VcrIdTra3-container-readonly__RAND__]').html('<span class="match-text" id="VcrIdTra3-match-text">' + resp.results[0].text + '</span>');
						if(resp.results[0].id == '<?php echo empty_lookup_value; ?>') { $j('.btn[id=dependencias_view_parent]').hide(); } else { $j('.btn[id=dependencias_view_parent]').show(); }

						if(typeof(VcrIdTra3_update_autofills__RAND__) == 'function') VcrIdTra3_update_autofills__RAND__();
					}
				});
			}

		<?php } else { ?>

			$j.ajax({
				url: 'ajax_combo.php',
				dataType: 'json',
				data: { id: AppGini.current_VcrIdTra3__RAND__.value, t: 'natural', f: 'VcrIdTra3' },
				success: function(resp) {
					$j('[id=VcrIdTra3-container__RAND__], [id=VcrIdTra3-container-readonly__RAND__]').html('<span class="match-text" id="VcrIdTra3-match-text">' + resp.results[0].text + '</span>');
					if(resp.results[0].id == '<?php echo empty_lookup_value; ?>') { $j('.btn[id=dependencias_view_parent]').hide(); } else { $j('.btn[id=dependencias_view_parent]').show(); }

					if(typeof(VcrIdTra3_update_autofills__RAND__) == 'function') VcrIdTra3_update_autofills__RAND__();
				}
			});
		<?php } ?>

		}
		function VcrIdTra4_reload__RAND__() {
		<?php if(($AllowUpdate || $AllowInsert) && !$dvprint) { ?>

			$j("#VcrIdTra4-container__RAND__").select2({
				/* initial default value */
				initSelection: function(e, c) {
					$j.ajax({
						url: 'ajax_combo.php',
						dataType: 'json',
						data: { id: AppGini.current_VcrIdTra4__RAND__.value, t: 'natural', f: 'VcrIdTra4' },
						success: function(resp) {
							c({
								id: resp.results[0].id,
								text: resp.results[0].text
							});
							$j('[name="VcrIdTra4"]').val(resp.results[0].id);
							$j('[id=VcrIdTra4-container-readonly__RAND__]').html('<span class="match-text" id="VcrIdTra4-match-text">' + resp.results[0].text + '</span>');
							if(resp.results[0].id == '<?php echo empty_lookup_value; ?>') { $j('.btn[id=dependencias_view_parent]').hide(); } else { $j('.btn[id=dependencias_view_parent]').show(); }


							if(typeof(VcrIdTra4_update_autofills__RAND__) == 'function') VcrIdTra4_update_autofills__RAND__();
						}
					});
				},
				width: '100%',
				formatNoMatches: function(term) { return '<?php echo addslashes($Translation['No matches found!']); ?>'; },
				minimumResultsForSearch: 5,
				loadMorePadding: 200,
				ajax: {
					url: 'ajax_combo.php',
					dataType: 'json',
					cache: true,
					data: function(term, page) { return { s: term, p: page, t: 'natural', f: 'VcrIdTra4' }; },
					results: function(resp, page) { return resp; }
				},
				escapeMarkup: function(str) { return str; }
			}).on('change', function(e) {
				AppGini.current_VcrIdTra4__RAND__.value = e.added.id;
				AppGini.current_VcrIdTra4__RAND__.text = e.added.text;
				$j('[name="VcrIdTra4"]').val(e.added.id);
				if(e.added.id == '<?php echo empty_lookup_value; ?>') { $j('.btn[id=dependencias_view_parent]').hide(); } else { $j('.btn[id=dependencias_view_parent]').show(); }


				if(typeof(VcrIdTra4_update_autofills__RAND__) == 'function') VcrIdTra4_update_autofills__RAND__();
			});

			if(!$j("#VcrIdTra4-container__RAND__").length) {
				$j.ajax({
					url: 'ajax_combo.php',
					dataType: 'json',
					data: { id: AppGini.current_VcrIdTra4__RAND__.value, t: 'natural', f: 'VcrIdTra4' },
					success: function(resp) {
						$j('[name="VcrIdTra4"]').val(resp.results[0].id);
						$j('[id=VcrIdTra4-container-readonly__RAND__]').html('<span class="match-text" id="VcrIdTra4-match-text">' + resp.results[0].text + '</span>');
						if(resp.results[0].id == '<?php echo empty_lookup_value; ?>') { $j('.btn[id=dependencias_view_parent]').hide(); } else { $j('.btn[id=dependencias_view_parent]').show(); }

						if(typeof(VcrIdTra4_update_autofills__RAND__) == 'function') VcrIdTra4_update_autofills__RAND__();
					}
				});
			}

		<?php } else { ?>

			$j.ajax({
				url: 'ajax_combo.php',
				dataType: 'json',
				data: { id: AppGini.current_VcrIdTra4__RAND__.value, t: 'natural', f: 'VcrIdTra4' },
				success: function(resp) {
					$j('[id=VcrIdTra4-container__RAND__], [id=VcrIdTra4-container-readonly__RAND__]').html('<span class="match-text" id="VcrIdTra4-match-text">' + resp.results[0].text + '</span>');
					if(resp.results[0].id == '<?php echo empty_lookup_value; ?>') { $j('.btn[id=dependencias_view_parent]').hide(); } else { $j('.btn[id=dependencias_view_parent]').show(); }

					if(typeof(VcrIdTra4_update_autofills__RAND__) == 'function') VcrIdTra4_update_autofills__RAND__();
				}
			});
		<?php } ?>

		}
		function VcrIdSerP_reload__RAND__() {
		<?php if(($AllowUpdate || $AllowInsert) && !$dvprint) { ?>

			$j("#VcrIdSerP-container__RAND__").select2({
				/* initial default value */
				initSelection: function(e, c) {
					$j.ajax({
						url: 'ajax_combo.php',
						dataType: 'json',
						data: { id: AppGini.current_VcrIdSerP__RAND__.value, t: 'natural', f: 'VcrIdSerP' },
						success: function(resp) {
							c({
								id: resp.results[0].id,
								text: resp.results[0].text
							});
							$j('[name="VcrIdSerP"]').val(resp.results[0].id);
							$j('[id=VcrIdSerP-container-readonly__RAND__]').html('<span class="match-text" id="VcrIdSerP-match-text">' + resp.results[0].text + '</span>');
							if(resp.results[0].id == '<?php echo empty_lookup_value; ?>') { $j('.btn[id=servidor_publico_view_parent]').hide(); } else { $j('.btn[id=servidor_publico_view_parent]').show(); }


							if(typeof(VcrIdSerP_update_autofills__RAND__) == 'function') VcrIdSerP_update_autofills__RAND__();
						}
					});
				},
				width: '100%',
				formatNoMatches: function(term) { return '<?php echo addslashes($Translation['No matches found!']); ?>'; },
				minimumResultsForSearch: 5,
				loadMorePadding: 200,
				ajax: {
					url: 'ajax_combo.php',
					dataType: 'json',
					cache: true,
					data: function(term, page) { return { s: term, p: page, t: 'natural', f: 'VcrIdSerP' }; },
					results: function(resp, page) { return resp; }
				},
				escapeMarkup: function(str) { return str; }
			}).on('change', function(e) {
				AppGini.current_VcrIdSerP__RAND__.value = e.added.id;
				AppGini.current_VcrIdSerP__RAND__.text = e.added.text;
				$j('[name="VcrIdSerP"]').val(e.added.id);
				if(e.added.id == '<?php echo empty_lookup_value; ?>') { $j('.btn[id=servidor_publico_view_parent]').hide(); } else { $j('.btn[id=servidor_publico_view_parent]').show(); }


				if(typeof(VcrIdSerP_update_autofills__RAND__) == 'function') VcrIdSerP_update_autofills__RAND__();
			});

			if(!$j("#VcrIdSerP-container__RAND__").length) {
				$j.ajax({
					url: 'ajax_combo.php',
					dataType: 'json',
					data: { id: AppGini.current_VcrIdSerP__RAND__.value, t: 'natural', f: 'VcrIdSerP' },
					success: function(resp) {
						$j('[name="VcrIdSerP"]').val(resp.results[0].id);
						$j('[id=VcrIdSerP-container-readonly__RAND__]').html('<span class="match-text" id="VcrIdSerP-match-text">' + resp.results[0].text + '</span>');
						if(resp.results[0].id == '<?php echo empty_lookup_value; ?>') { $j('.btn[id=servidor_publico_view_parent]').hide(); } else { $j('.btn[id=servidor_publico_view_parent]').show(); }

						if(typeof(VcrIdSerP_update_autofills__RAND__) == 'function') VcrIdSerP_update_autofills__RAND__();
					}
				});
			}

		<?php } else { ?>

			$j.ajax({
				url: 'ajax_combo.php',
				dataType: 'json',
				data: { id: AppGini.current_VcrIdSerP__RAND__.value, t: 'natural', f: 'VcrIdSerP' },
				success: function(resp) {
					$j('[id=VcrIdSerP-container__RAND__], [id=VcrIdSerP-container-readonly__RAND__]').html('<span class="match-text" id="VcrIdSerP-match-text">' + resp.results[0].text + '</span>');
					if(resp.results[0].id == '<?php echo empty_lookup_value; ?>') { $j('.btn[id=servidor_publico_view_parent]').hide(); } else { $j('.btn[id=servidor_publico_view_parent]').show(); }

					if(typeof(VcrIdSerP_update_autofills__RAND__) == 'function') VcrIdSerP_update_autofills__RAND__();
				}
			});
		<?php } ?>

		}
	</script>
	<?php

	$lookups = str_replace('__RAND__', $rnd1, ob_get_clean());


	// code for template based detail view forms

	// open the detail view template
	$template_file = is_file("./{$TemplateDV}") ? "./{$TemplateDV}" : './templates/natural_templateDV.html';
	$templateCode = @file_get_contents($template_file);

	// process form title
	$templateCode = str_replace('<%%DETAIL_VIEW_TITLE%%>', 'FORMATO VISITA DE VERIFICACI&#211;N DE CONDICIONES DE RIESGO NATURAL, SOCIO NATURAL Y TECNOL&#211;GICO', $templateCode);
	$templateCode = str_replace('<%%RND1%%>', $rnd1, $templateCode);
	$templateCode = str_replace('<%%EMBEDDED%%>', (Request::val('Embedded') ? 'Embedded=1' : ''), $templateCode);
	// process buttons
	if($AllowInsert) {
		if(!$selected_id) $templateCode = str_replace('<%%INSERT_BUTTON%%>', '<button type="submit" class="btn btn-success" id="insert" name="insert_x" value="1" onclick="return natural_validateData();"><i class="glyphicon glyphicon-plus-sign"></i> ' . $Translation['Save New'] . '</button>', $templateCode);
		$templateCode = str_replace('<%%INSERT_BUTTON%%>', '<button type="submit" class="btn btn-default" id="insert" name="insert_x" value="1" onclick="return natural_validateData();"><i class="glyphicon glyphicon-plus-sign"></i> ' . $Translation['Save As Copy'] . '</button>', $templateCode);
	} else {
		$templateCode = str_replace('<%%INSERT_BUTTON%%>', '', $templateCode);
	}

	// 'Back' button action
	if(Request::val('Embedded')) {
		$backAction = 'AppGini.closeParentModal(); return false;';
	} else {
		$backAction = '$j(\'form\').eq(0).attr(\'novalidate\', \'novalidate\'); document.myform.reset(); return true;';
	}

	if($selected_id) {
		if($AllowUpdate) {
			$templateCode = str_replace('<%%UPDATE_BUTTON%%>', '<button type="submit" class="btn btn-success btn-lg" id="update" name="update_x" value="1" onclick="return natural_validateData();" title="' . html_attr($Translation['Save Changes']) . '"><i class="glyphicon glyphicon-ok"></i> ' . $Translation['Save Changes'] . '</button>', $templateCode);
		} else {
			$templateCode = str_replace('<%%UPDATE_BUTTON%%>', '', $templateCode);
		}
		if(($arrPerm['delete'] == 1 && $ownerMemberID == getLoggedMemberID()) || ($arrPerm['delete'] == 2 && $ownerGroupID == getLoggedGroupID()) || $arrPerm['delete'] == 3) { // allow delete?
			$templateCode = str_replace('<%%DELETE_BUTTON%%>', '<button type="submit" class="btn btn-danger" id="delete" name="delete_x" value="1" onclick="return confirm(\'' . $Translation['are you sure?'] . '\');" title="' . html_attr($Translation['Delete']) . '"><i class="glyphicon glyphicon-trash"></i> ' . $Translation['Delete'] . '</button>', $templateCode);
		} else {
			$templateCode = str_replace('<%%DELETE_BUTTON%%>', '', $templateCode);
		}
		$templateCode = str_replace('<%%DESELECT_BUTTON%%>', '<button type="submit" class="btn btn-default" id="deselect" name="deselect_x" value="1" onclick="' . $backAction . '" title="' . html_attr($Translation['Back']) . '"><i class="glyphicon glyphicon-chevron-left"></i> ' . $Translation['Back'] . '</button>', $templateCode);
	} else {
		$templateCode = str_replace('<%%UPDATE_BUTTON%%>', '', $templateCode);
		$templateCode = str_replace('<%%DELETE_BUTTON%%>', '', $templateCode);

		// if not in embedded mode and user has insert only but no view/update/delete,
		// remove 'back' button
		if(
			$arrPerm['insert']
			&& !$arrPerm['update'] && !$arrPerm['delete'] && !$arrPerm['view']
			&& !Request::val('Embedded')
		)
			$templateCode = str_replace('<%%DESELECT_BUTTON%%>', '', $templateCode);
		elseif($separateDV)
			$templateCode = str_replace(
				'<%%DESELECT_BUTTON%%>', 
				'<button
					type="submit" 
					class="btn btn-default" 
					id="deselect" 
					name="deselect_x" 
					value="1" 
					onclick="' . $backAction . '" 
					title="' . html_attr($Translation['Back']) . '">
						<i class="glyphicon glyphicon-chevron-left"></i> ' .
						$Translation['Back'] .
				'</button>',
				$templateCode
			);
		else
			$templateCode = str_replace('<%%DESELECT_BUTTON%%>', '', $templateCode);
	}

	// set records to read only if user can't insert new records and can't edit current record
	if(($selected_id && !$AllowUpdate && !$AllowInsert) || (!$selected_id && !$AllowInsert)) {
		$jsReadOnly = '';
		$jsReadOnly .= "\tjQuery('#VcrIdSol').prop('disabled', true).css({ color: '#555', backgroundColor: '#fff' });\n";
		$jsReadOnly .= "\tjQuery('#VcrIdSol_caption').prop('disabled', true).css({ color: '#555', backgroundColor: 'white' });\n";
		$jsReadOnly .= "\tjQuery('#VcrFecVis').prop('readonly', true);\n";
		$jsReadOnly .= "\tjQuery('#VcrFecVisDay, #VcrFecVisMonth, #VcrFecVisYear').prop('disabled', true).css({ color: '#555', backgroundColor: '#fff' });\n";
		$jsReadOnly .= "\tjQuery('#VcrNomAti').replaceWith('<div class=\"form-control-static\" id=\"VcrNomAti\">' + (jQuery('#VcrNomAti').val() || '') + '</div>');\n";
		$jsReadOnly .= "\tjQuery('#VcrIdTip').prop('disabled', true).css({ color: '#555', backgroundColor: '#fff' });\n";
		$jsReadOnly .= "\tjQuery('#VcrIdTip_caption').prop('disabled', true).css({ color: '#555', backgroundColor: 'white' });\n";
		$jsReadOnly .= "\tjQuery('#VcrNoIde').replaceWith('<div class=\"form-control-static\" id=\"VcrNoIde\">' + (jQuery('#VcrNoIde').val() || '') + '</div>');\n";
		$jsReadOnly .= "\tjQuery('#VcrCel').replaceWith('<div class=\"form-control-static\" id=\"VcrCel\">' + (jQuery('#VcrCel').val() || '') + '</div>');\n";
		$jsReadOnly .= "\tjQuery('#VcrCorEle').replaceWith('<div class=\"form-control-static\" id=\"VcrCorEle\">' + (jQuery('#VcrCorEle').val() || '') + '</div>');\n";
		$jsReadOnly .= "\tjQuery('#VcrIdMot').prop('disabled', true).css({ color: '#555', backgroundColor: '#fff' });\n";
		$jsReadOnly .= "\tjQuery('#VcrIdMot_caption').prop('disabled', true).css({ color: '#555', backgroundColor: 'white' });\n";
		$jsReadOnly .= "\tjQuery('#VcrRadSol').replaceWith('<div class=\"form-control-static\" id=\"VcrRadSol\">' + (jQuery('#VcrRadSol').val() || '') + '</div>');\n";
		$jsReadOnly .= "\tjQuery('#VcrFecSol').prop('readonly', true);\n";
		$jsReadOnly .= "\tjQuery('#VcrFecSolDay, #VcrFecSolMonth, #VcrFecSolYear').prop('disabled', true).css({ color: '#555', backgroundColor: '#fff' });\n";
		$jsReadOnly .= "\tjQuery('#VcrObsDat').replaceWith('<div class=\"form-control-static\" id=\"VcrObsDat\">' + (jQuery('#VcrObsDat').val() || '') + '</div>');\n";
		$jsReadOnly .= "\tjQuery('#VcrIdUbi').prop('disabled', true).css({ color: '#555', backgroundColor: '#fff' });\n";
		$jsReadOnly .= "\tjQuery('#VcrIdUbi_caption').prop('disabled', true).css({ color: '#555', backgroundColor: 'white' });\n";
		$jsReadOnly .= "\tjQuery('#VcrDir').replaceWith('<div class=\"form-control-static\" id=\"VcrDir\">' + (jQuery('#VcrDir').val() || '') + '</div>');\n";
		$jsReadOnly .= "\tjQuery('#VcrIdBarVe').prop('disabled', true).css({ color: '#555', backgroundColor: '#fff' });\n";
		$jsReadOnly .= "\tjQuery('#VcrIdBarVe_caption').prop('disabled', true).css({ color: '#555', backgroundColor: 'white' });\n";
		$jsReadOnly .= "\tjQuery('#VcrIdCorr').prop('disabled', true).css({ color: '#555', backgroundColor: '#fff' });\n";
		$jsReadOnly .= "\tjQuery('#VcrIdCorr_caption').prop('disabled', true).css({ color: '#555', backgroundColor: 'white' });\n";
		$jsReadOnly .= "\tjQuery('#VcrIdCom').prop('disabled', true).css({ color: '#555', backgroundColor: '#fff' });\n";
		$jsReadOnly .= "\tjQuery('#VcrIdCom_caption').prop('disabled', true).css({ color: '#555', backgroundColor: 'white' });\n";
		$jsReadOnly .= "\tjQuery('#VcrLat').replaceWith('<div class=\"form-control-static\" id=\"VcrLat\">' + (jQuery('#VcrLat').val() || '') + '</div>');\n";
		$jsReadOnly .= "\tjQuery('#VcrLon').replaceWith('<div class=\"form-control-static\" id=\"VcrLon\">' + (jQuery('#VcrLon').val() || '') + '</div>');\n";
		$jsReadOnly .= "\tjQuery('#VcrObsUbi').replaceWith('<div class=\"form-control-static\" id=\"VcrObsUbi\">' + (jQuery('#VcrObsUbi').val() || '') + '</div>');\n";
		$jsReadOnly .= "\tjQuery('#VcrIdFen').prop('disabled', true).css({ color: '#555', backgroundColor: '#fff' });\n";
		$jsReadOnly .= "\tjQuery('#VcrIdFen_caption').prop('disabled', true).css({ color: '#555', backgroundColor: 'white' });\n";
		$jsReadOnly .= "\tjQuery('#VcrDet').replaceWith('<div class=\"form-control-static\" id=\"VcrDet\">' + (jQuery('#VcrDet').val() || '') + '</div>');\n";
		$jsReadOnly .= "\tjQuery('#VcrIdCar').prop('disabled', true).css({ color: '#555', backgroundColor: '#fff' });\n";
		$jsReadOnly .= "\tjQuery('#VcrIdCar_caption').prop('disabled', true).css({ color: '#555', backgroundColor: 'white' });\n";
		$jsReadOnly .= "\tjQuery('#VcrOtr').replaceWith('<div class=\"form-control-static\" id=\"VcrOtr\">' + (jQuery('#VcrOtr').val() || '') + '</div>');\n";
		$jsReadOnly .= "\tjQuery('#VcrDesEve').replaceWith('<div class=\"form-control-static\" id=\"VcrDesEve\">' + (jQuery('#VcrDesEve').val() || '') + '</div>');\n";
		$jsReadOnly .= "\tjQuery('#VcrIdEdi').prop('disabled', true).css({ color: '#555', backgroundColor: '#fff' });\n";
		$jsReadOnly .= "\tjQuery('#VcrIdEdi_caption').prop('disabled', true).css({ color: '#555', backgroundColor: 'white' });\n";
		$jsReadOnly .= "\tjQuery('#VcrNoPis').replaceWith('<div class=\"form-control-static\" id=\"VcrNoPis\">' + (jQuery('#VcrNoPis').val() || '') + '</div>');\n";
		$jsReadOnly .= "\tjQuery('#VcrObrCiv').replaceWith('<div class=\"form-control-static\" id=\"VcrObrCiv\">' + (jQuery('#VcrObrCiv').val() || '') + '</div>');\n";
		$jsReadOnly .= "\tjQuery('#VcrEstEdi').replaceWith('<div class=\"form-control-static\" id=\"VcrEstEdi\">' + (jQuery('#VcrEstEdi').val() || '') + '</div>'); jQuery('#VcrEstEdi-multi-selection-help').hide();\n";
		$jsReadOnly .= "\tjQuery('#VcrIdAfe').prop('disabled', true).css({ color: '#555', backgroundColor: '#fff' });\n";
		$jsReadOnly .= "\tjQuery('#VcrIdAfe_caption').prop('disabled', true).css({ color: '#555', backgroundColor: 'white' });\n";
		$jsReadOnly .= "\tjQuery('#VcrObsEst').replaceWith('<div class=\"form-control-static\" id=\"VcrObsEst\">' + (jQuery('#VcrObsEst').val() || '') + '</div>');\n";
		$jsReadOnly .= "\tjQuery('#VcrDanGrav').replaceWith('<div class=\"form-control-static\" id=\"VcrDanGrav\">' + (jQuery('#VcrDanGrav').val() || '') + '</div>'); jQuery('#VcrDanGrav-multi-selection-help').hide();\n";
		$jsReadOnly .= "\tjQuery('#VcrAnoCon').replaceWith('<div class=\"form-control-static\" id=\"VcrAnoCon\">' + (jQuery('#VcrAnoCon').val() || '') + '</div>');\n";
		$jsReadOnly .= "\tjQuery('#VcrIdMat').prop('disabled', true).css({ color: '#555', backgroundColor: '#fff' });\n";
		$jsReadOnly .= "\tjQuery('#VcrIdMat_caption').prop('disabled', true).css({ color: '#555', backgroundColor: 'white' });\n";
		$jsReadOnly .= "\tjQuery('#VcrIdLes').prop('disabled', true).css({ color: '#555', backgroundColor: '#fff' });\n";
		$jsReadOnly .= "\tjQuery('#VcrIdLes_caption').prop('disabled', true).css({ color: '#555', backgroundColor: 'white' });\n";
		$jsReadOnly .= "\tjQuery('#VcrAyuHum').replaceWith('<div class=\"form-control-static\" id=\"VcrAyuHum\">' + (jQuery('#VcrAyuHum').val() || '') + '</div>'); jQuery('#VcrAyuHum-multi-selection-help').hide();\n";
		$jsReadOnly .= "\tjQuery('#VcrConAyu').replaceWith('<div class=\"form-control-static\" id=\"VcrConAyu\">' + (jQuery('#VcrConAyu').val() || '') + '</div>');\n";
		$jsReadOnly .= "\tjQuery('#VcrObs').replaceWith('<div class=\"form-control-static\" id=\"VcrObs\">' + (jQuery('#VcrObs').val() || '') + '</div>');\n";
		$jsReadOnly .= "\tjQuery('#VcrCapRed').replaceWith('<div class=\"form-control-static\" id=\"VcrCapRed\">' + (jQuery('#VcrCapRed').val() || '') + '</div>'); jQuery('#VcrCapRed-multi-selection-help').hide();\n";
		$jsReadOnly .= "\tjQuery('#VcrIdCap').prop('disabled', true).css({ color: '#555', backgroundColor: '#fff' });\n";
		$jsReadOnly .= "\tjQuery('#VcrIdCap_caption').prop('disabled', true).css({ color: '#555', backgroundColor: 'white' });\n";
		$jsReadOnly .= "\tjQuery('#VcrOtrCap').replaceWith('<div class=\"form-control-static\" id=\"VcrOtrCap\">' + (jQuery('#VcrOtrCap').val() || '') + '</div>');\n";
		$jsReadOnly .= "\tjQuery('#VcrInf0a5F').replaceWith('<div class=\"form-control-static\" id=\"VcrInf0a5F\">' + (jQuery('#VcrInf0a5F').val() || '') + '</div>');\n";
		$jsReadOnly .= "\tjQuery('#VcrInf0a5M').replaceWith('<div class=\"form-control-static\" id=\"VcrInf0a5M\">' + (jQuery('#VcrInf0a5M').val() || '') + '</div>');\n";
		$jsReadOnly .= "\tjQuery('#VcrInf5a12F').replaceWith('<div class=\"form-control-static\" id=\"VcrInf5a12F\">' + (jQuery('#VcrInf5a12F').val() || '') + '</div>');\n";
		$jsReadOnly .= "\tjQuery('#VcrInf5a12M').replaceWith('<div class=\"form-control-static\" id=\"VcrInf5a12M\">' + (jQuery('#VcrInf5a12M').val() || '') + '</div>');\n";
		$jsReadOnly .= "\tjQuery('#VcrAd12a18F').replaceWith('<div class=\"form-control-static\" id=\"VcrAd12a18F\">' + (jQuery('#VcrAd12a18F').val() || '') + '</div>');\n";
		$jsReadOnly .= "\tjQuery('#VcrAd12a18M').replaceWith('<div class=\"form-control-static\" id=\"VcrAd12a18M\">' + (jQuery('#VcrAd12a18M').val() || '') + '</div>');\n";
		$jsReadOnly .= "\tjQuery('#VcrAd18a28F').replaceWith('<div class=\"form-control-static\" id=\"VcrAd18a28F\">' + (jQuery('#VcrAd18a28F').val() || '') + '</div>');\n";
		$jsReadOnly .= "\tjQuery('#VcrAd18a28M').replaceWith('<div class=\"form-control-static\" id=\"VcrAd18a28M\">' + (jQuery('#VcrAd18a28M').val() || '') + '</div>');\n";
		$jsReadOnly .= "\tjQuery('#VcrAd28a60F').replaceWith('<div class=\"form-control-static\" id=\"VcrAd28a60F\">' + (jQuery('#VcrAd28a60F').val() || '') + '</div>');\n";
		$jsReadOnly .= "\tjQuery('#VcrAd28a60M').replaceWith('<div class=\"form-control-static\" id=\"VcrAd28a60M\">' + (jQuery('#VcrAd28a60M').val() || '') + '</div>');\n";
		$jsReadOnly .= "\tjQuery('#VcrAdMay60F').replaceWith('<div class=\"form-control-static\" id=\"VcrAdMay60F\">' + (jQuery('#VcrAdMay60F').val() || '') + '</div>');\n";
		$jsReadOnly .= "\tjQuery('#VcrAdMay60M').replaceWith('<div class=\"form-control-static\" id=\"VcrAdMay60M\">' + (jQuery('#VcrAdMay60M').val() || '') + '</div>');\n";
		$jsReadOnly .= "\tjQuery('#VcrAfr').replaceWith('<div class=\"form-control-static\" id=\"VcrAfr\">' + (jQuery('#VcrAfr').val() || '') + '</div>');\n";
		$jsReadOnly .= "\tjQuery('#VcrPal').replaceWith('<div class=\"form-control-static\" id=\"VcrPal\">' + (jQuery('#VcrPal').val() || '') + '</div>');\n";
		$jsReadOnly .= "\tjQuery('#VcrInd').replaceWith('<div class=\"form-control-static\" id=\"VcrInd\">' + (jQuery('#VcrInd').val() || '') + '</div>');\n";
		$jsReadOnly .= "\tjQuery('#VcrCau').replaceWith('<div class=\"form-control-static\" id=\"VcrCau\">' + (jQuery('#VcrCau').val() || '') + '</div>');\n";
		$jsReadOnly .= "\tjQuery('#VcrGit').replaceWith('<div class=\"form-control-static\" id=\"VcrGit\">' + (jQuery('#VcrGit').val() || '') + '</div>');\n";
		$jsReadOnly .= "\tjQuery('#VcrMes').replaceWith('<div class=\"form-control-static\" id=\"VcrMes\">' + (jQuery('#VcrMes').val() || '') + '</div>');\n";
		$jsReadOnly .= "\tjQuery('#VcrOtrPer').replaceWith('<div class=\"form-control-static\" id=\"VcrOtrPer\">' + (jQuery('#VcrOtrPer').val() || '') + '</div>');\n";
		$jsReadOnly .= "\tjQuery('#VcrPerNsNr').replaceWith('<div class=\"form-control-static\" id=\"VcrPerNsNr\">' + (jQuery('#VcrPerNsNr').val() || '') + '</div>'); jQuery('#VcrPerNsNr-multi-selection-help').hide();\n";
		$jsReadOnly .= "\tjQuery('#VcrTraCas').replaceWith('<div class=\"form-control-static\" id=\"VcrTraCas\">' + (jQuery('#VcrTraCas').val() || '') + '</div>'); jQuery('#VcrTraCas-multi-selection-help').hide();\n";
		$jsReadOnly .= "\tjQuery('#VcrIdTra1').prop('disabled', true).css({ color: '#555', backgroundColor: '#fff' });\n";
		$jsReadOnly .= "\tjQuery('#VcrIdTra1_caption').prop('disabled', true).css({ color: '#555', backgroundColor: 'white' });\n";
		$jsReadOnly .= "\tjQuery('#VcrdTra2').prop('disabled', true).css({ color: '#555', backgroundColor: '#fff' });\n";
		$jsReadOnly .= "\tjQuery('#VcrdTra2_caption').prop('disabled', true).css({ color: '#555', backgroundColor: 'white' });\n";
		$jsReadOnly .= "\tjQuery('#VcrIdTra3').prop('disabled', true).css({ color: '#555', backgroundColor: '#fff' });\n";
		$jsReadOnly .= "\tjQuery('#VcrIdTra3_caption').prop('disabled', true).css({ color: '#555', backgroundColor: 'white' });\n";
		$jsReadOnly .= "\tjQuery('#VcrIdTra4').prop('disabled', true).css({ color: '#555', backgroundColor: '#fff' });\n";
		$jsReadOnly .= "\tjQuery('#VcrIdTra4_caption').prop('disabled', true).css({ color: '#555', backgroundColor: 'white' });\n";
		$jsReadOnly .= "\tjQuery('#VcrRecLin').replaceWith('<div class=\"form-control-static\" id=\"VcrRecLin\">' + (jQuery('#VcrRecLin').val() || '') + '</div>'); jQuery('#VcrRecLin-multi-selection-help').hide();\n";
		$jsReadOnly .= "\tjQuery('#VcrRecLey').replaceWith('<div class=\"form-control-static\" id=\"VcrRecLey\">' + (jQuery('#VcrRecLey').val() || '') + '</div>'); jQuery('#VcrRecLey-multi-selection-help').hide();\n";
		$jsReadOnly .= "\tjQuery('#VcrRecPre').replaceWith('<div class=\"form-control-static\" id=\"VcrRecPre\">' + (jQuery('#VcrRecPre').val() || '') + '</div>'); jQuery('#VcrRecPre-multi-selection-help').hide();\n";
		$jsReadOnly .= "\tjQuery('#VcrRecAut').replaceWith('<div class=\"form-control-static\" id=\"VcrRecAut\">' + (jQuery('#VcrRecAut').val() || '') + '</div>'); jQuery('#VcrRecAut-multi-selection-help').hide();\n";
		$jsReadOnly .= "\tjQuery('#VcrDatPer').replaceWith('<div class=\"form-control-static\" id=\"VcrDatPer\">' + (jQuery('#VcrDatPer').val() || '') + '</div>'); jQuery('#VcrDatPer-multi-selection-help').hide();\n";
		$jsReadOnly .= "\tjQuery('#VcrUsoIma').replaceWith('<div class=\"form-control-static\" id=\"VcrUsoIma\">' + (jQuery('#VcrUsoIma').val() || '') + '</div>'); jQuery('#VcrUsoIma-multi-selection-help').hide();\n";
		$jsReadOnly .= "\tjQuery('#VcrUsoDat').replaceWith('<div class=\"form-control-static\" id=\"VcrUsoDat\">' + (jQuery('#VcrUsoDat').val() || '') + '</div>'); jQuery('#VcrUsoDat-multi-selection-help').hide();\n";
		$jsReadOnly .= "\tjQuery('#VcrAutCor').replaceWith('<div class=\"form-control-static\" id=\"VcrAutCor\">' + (jQuery('#VcrAutCor').val() || '') + '</div>'); jQuery('#VcrAutCor-multi-selection-help').hide();\n";
		$jsReadOnly .= "\tjQuery('#VcrIdSerP').prop('disabled', true).css({ color: '#555', backgroundColor: '#fff' });\n";
		$jsReadOnly .= "\tjQuery('#VcrIdSerP_caption').prop('disabled', true).css({ color: '#555', backgroundColor: 'white' });\n";
		$jsReadOnly .= "\tjQuery('#VcrIma').replaceWith('<div class=\"form-control-static\" id=\"VcrIma\">' + (jQuery('#VcrIma').val() || '') + '</div>');\n";
		$jsReadOnly .= "\tjQuery('#VcrIma, #VcrIma-edit-link').hide();\n";
		$jsReadOnly .= "\tjQuery('#VcrVideo').replaceWith('<div class=\"form-control-static\" id=\"VcrVideo\">' + (jQuery('#VcrVideo').val() || '') + '</div>');\n";
		$jsReadOnly .= "\tjQuery('#VcrVideo, #VcrVideo-edit-link').hide();\n";
		$jsReadOnly .= "\tjQuery('#VcrDoc').replaceWith('<div class=\"form-control-static\" id=\"VcrDoc\">' + (jQuery('#VcrDoc').val() || '') + '</div>');\n";
		$jsReadOnly .= "\tjQuery('#VcrDoc, #VcrDoc-edit-link').hide();\n";
		$jsReadOnly .= "\tjQuery('.select2-container').hide();\n";

		$noUploads = true;
	} elseif($AllowInsert) {
		$jsEditable = "\tjQuery('form').eq(0).data('already_changed', true);"; // temporarily disable form change handler
		$jsEditable .= "\tjQuery('form').eq(0).data('already_changed', false);"; // re-enable form change handler
	}

	// process combos
	$templateCode = str_replace('<%%COMBO(VcrIdSol)%%>', $combo_VcrIdSol->HTML, $templateCode);
	$templateCode = str_replace('<%%COMBOTEXT(VcrIdSol)%%>', $combo_VcrIdSol->MatchText, $templateCode);
	$templateCode = str_replace('<%%URLCOMBOTEXT(VcrIdSol)%%>', urlencode($combo_VcrIdSol->MatchText), $templateCode);
	$templateCode = str_replace(
		'<%%COMBO(VcrFecVis)%%>', 
		($selected_id && !$arrPerm['edit'] && ($noSaveAsCopy || !$arrPerm['insert']) ? 
			'<div class="form-control-static">' . $combo_VcrFecVis->GetHTML(true) . '</div>' : 
			$combo_VcrFecVis->GetHTML()
		), $templateCode);
	$templateCode = str_replace('<%%COMBOTEXT(VcrFecVis)%%>', $combo_VcrFecVis->GetHTML(true), $templateCode);
	$templateCode = str_replace('<%%COMBO(VcrIdTip)%%>', $combo_VcrIdTip->HTML, $templateCode);
	$templateCode = str_replace('<%%COMBOTEXT(VcrIdTip)%%>', $combo_VcrIdTip->MatchText, $templateCode);
	$templateCode = str_replace('<%%URLCOMBOTEXT(VcrIdTip)%%>', urlencode($combo_VcrIdTip->MatchText), $templateCode);
	$templateCode = str_replace('<%%COMBO(VcrIdMot)%%>', $combo_VcrIdMot->HTML, $templateCode);
	$templateCode = str_replace('<%%COMBOTEXT(VcrIdMot)%%>', $combo_VcrIdMot->MatchText, $templateCode);
	$templateCode = str_replace('<%%URLCOMBOTEXT(VcrIdMot)%%>', urlencode($combo_VcrIdMot->MatchText), $templateCode);
	$templateCode = str_replace(
		'<%%COMBO(VcrFecSol)%%>', 
		($selected_id && !$arrPerm['edit'] && ($noSaveAsCopy || !$arrPerm['insert']) ? 
			'<div class="form-control-static">' . $combo_VcrFecSol->GetHTML(true) . '</div>' : 
			$combo_VcrFecSol->GetHTML()
		), $templateCode);
	$templateCode = str_replace('<%%COMBOTEXT(VcrFecSol)%%>', $combo_VcrFecSol->GetHTML(true), $templateCode);
	$templateCode = str_replace('<%%COMBO(VcrIdUbi)%%>', $combo_VcrIdUbi->HTML, $templateCode);
	$templateCode = str_replace('<%%COMBOTEXT(VcrIdUbi)%%>', $combo_VcrIdUbi->MatchText, $templateCode);
	$templateCode = str_replace('<%%URLCOMBOTEXT(VcrIdUbi)%%>', urlencode($combo_VcrIdUbi->MatchText), $templateCode);
	$templateCode = str_replace('<%%COMBO(VcrIdBarVe)%%>', $combo_VcrIdBarVe->HTML, $templateCode);
	$templateCode = str_replace('<%%COMBOTEXT(VcrIdBarVe)%%>', $combo_VcrIdBarVe->MatchText, $templateCode);
	$templateCode = str_replace('<%%URLCOMBOTEXT(VcrIdBarVe)%%>', urlencode($combo_VcrIdBarVe->MatchText), $templateCode);
	$templateCode = str_replace('<%%COMBO(VcrIdCorr)%%>', $combo_VcrIdCorr->HTML, $templateCode);
	$templateCode = str_replace('<%%COMBOTEXT(VcrIdCorr)%%>', $combo_VcrIdCorr->MatchText, $templateCode);
	$templateCode = str_replace('<%%URLCOMBOTEXT(VcrIdCorr)%%>', urlencode($combo_VcrIdCorr->MatchText), $templateCode);
	$templateCode = str_replace('<%%COMBO(VcrIdCom)%%>', $combo_VcrIdCom->HTML, $templateCode);
	$templateCode = str_replace('<%%COMBOTEXT(VcrIdCom)%%>', $combo_VcrIdCom->MatchText, $templateCode);
	$templateCode = str_replace('<%%URLCOMBOTEXT(VcrIdCom)%%>', urlencode($combo_VcrIdCom->MatchText), $templateCode);
	$templateCode = str_replace('<%%COMBO(VcrIdFen)%%>', $combo_VcrIdFen->HTML, $templateCode);
	$templateCode = str_replace('<%%COMBOTEXT(VcrIdFen)%%>', $combo_VcrIdFen->MatchText, $templateCode);
	$templateCode = str_replace('<%%URLCOMBOTEXT(VcrIdFen)%%>', urlencode($combo_VcrIdFen->MatchText), $templateCode);
	$templateCode = str_replace('<%%COMBO(VcrIdCar)%%>', $combo_VcrIdCar->HTML, $templateCode);
	$templateCode = str_replace('<%%COMBOTEXT(VcrIdCar)%%>', $combo_VcrIdCar->MatchText, $templateCode);
	$templateCode = str_replace('<%%URLCOMBOTEXT(VcrIdCar)%%>', urlencode($combo_VcrIdCar->MatchText), $templateCode);
	$templateCode = str_replace('<%%COMBO(VcrIdEdi)%%>', $combo_VcrIdEdi->HTML, $templateCode);
	$templateCode = str_replace('<%%COMBOTEXT(VcrIdEdi)%%>', $combo_VcrIdEdi->MatchText, $templateCode);
	$templateCode = str_replace('<%%URLCOMBOTEXT(VcrIdEdi)%%>', urlencode($combo_VcrIdEdi->MatchText), $templateCode);
	$templateCode = str_replace('<%%COMBO(VcrEstEdi)%%>', $combo_VcrEstEdi->HTML, $templateCode);
	$templateCode = str_replace('<%%COMBOTEXT(VcrEstEdi)%%>', $combo_VcrEstEdi->SelectedData, $templateCode);
	$templateCode = str_replace('<%%COMBO(VcrIdAfe)%%>', $combo_VcrIdAfe->HTML, $templateCode);
	$templateCode = str_replace('<%%COMBOTEXT(VcrIdAfe)%%>', $combo_VcrIdAfe->MatchText, $templateCode);
	$templateCode = str_replace('<%%URLCOMBOTEXT(VcrIdAfe)%%>', urlencode($combo_VcrIdAfe->MatchText), $templateCode);
	$templateCode = str_replace('<%%COMBO(VcrDanGrav)%%>', $combo_VcrDanGrav->HTML, $templateCode);
	$templateCode = str_replace('<%%COMBOTEXT(VcrDanGrav)%%>', $combo_VcrDanGrav->SelectedData, $templateCode);
	$templateCode = str_replace('<%%COMBO(VcrIdMat)%%>', $combo_VcrIdMat->HTML, $templateCode);
	$templateCode = str_replace('<%%COMBOTEXT(VcrIdMat)%%>', $combo_VcrIdMat->MatchText, $templateCode);
	$templateCode = str_replace('<%%URLCOMBOTEXT(VcrIdMat)%%>', urlencode($combo_VcrIdMat->MatchText), $templateCode);
	$templateCode = str_replace('<%%COMBO(VcrIdLes)%%>', $combo_VcrIdLes->HTML, $templateCode);
	$templateCode = str_replace('<%%COMBOTEXT(VcrIdLes)%%>', $combo_VcrIdLes->MatchText, $templateCode);
	$templateCode = str_replace('<%%URLCOMBOTEXT(VcrIdLes)%%>', urlencode($combo_VcrIdLes->MatchText), $templateCode);
	$templateCode = str_replace('<%%COMBO(VcrAyuHum)%%>', $combo_VcrAyuHum->HTML, $templateCode);
	$templateCode = str_replace('<%%COMBOTEXT(VcrAyuHum)%%>', $combo_VcrAyuHum->SelectedData, $templateCode);
	$templateCode = str_replace('<%%COMBO(VcrCapRed)%%>', $combo_VcrCapRed->HTML, $templateCode);
	$templateCode = str_replace('<%%COMBOTEXT(VcrCapRed)%%>', $combo_VcrCapRed->SelectedData, $templateCode);
	$templateCode = str_replace('<%%COMBO(VcrIdCap)%%>', $combo_VcrIdCap->HTML, $templateCode);
	$templateCode = str_replace('<%%COMBOTEXT(VcrIdCap)%%>', $combo_VcrIdCap->MatchText, $templateCode);
	$templateCode = str_replace('<%%URLCOMBOTEXT(VcrIdCap)%%>', urlencode($combo_VcrIdCap->MatchText), $templateCode);
	$templateCode = str_replace('<%%COMBO(VcrPerNsNr)%%>', $combo_VcrPerNsNr->HTML, $templateCode);
	$templateCode = str_replace('<%%COMBOTEXT(VcrPerNsNr)%%>', $combo_VcrPerNsNr->SelectedData, $templateCode);
	$templateCode = str_replace('<%%COMBO(VcrTraCas)%%>', $combo_VcrTraCas->HTML, $templateCode);
	$templateCode = str_replace('<%%COMBOTEXT(VcrTraCas)%%>', $combo_VcrTraCas->SelectedData, $templateCode);
	$templateCode = str_replace('<%%COMBO(VcrIdTra1)%%>', $combo_VcrIdTra1->HTML, $templateCode);
	$templateCode = str_replace('<%%COMBOTEXT(VcrIdTra1)%%>', $combo_VcrIdTra1->MatchText, $templateCode);
	$templateCode = str_replace('<%%URLCOMBOTEXT(VcrIdTra1)%%>', urlencode($combo_VcrIdTra1->MatchText), $templateCode);
	$templateCode = str_replace('<%%COMBO(VcrdTra2)%%>', $combo_VcrdTra2->HTML, $templateCode);
	$templateCode = str_replace('<%%COMBOTEXT(VcrdTra2)%%>', $combo_VcrdTra2->MatchText, $templateCode);
	$templateCode = str_replace('<%%URLCOMBOTEXT(VcrdTra2)%%>', urlencode($combo_VcrdTra2->MatchText), $templateCode);
	$templateCode = str_replace('<%%COMBO(VcrIdTra3)%%>', $combo_VcrIdTra3->HTML, $templateCode);
	$templateCode = str_replace('<%%COMBOTEXT(VcrIdTra3)%%>', $combo_VcrIdTra3->MatchText, $templateCode);
	$templateCode = str_replace('<%%URLCOMBOTEXT(VcrIdTra3)%%>', urlencode($combo_VcrIdTra3->MatchText), $templateCode);
	$templateCode = str_replace('<%%COMBO(VcrIdTra4)%%>', $combo_VcrIdTra4->HTML, $templateCode);
	$templateCode = str_replace('<%%COMBOTEXT(VcrIdTra4)%%>', $combo_VcrIdTra4->MatchText, $templateCode);
	$templateCode = str_replace('<%%URLCOMBOTEXT(VcrIdTra4)%%>', urlencode($combo_VcrIdTra4->MatchText), $templateCode);
	$templateCode = str_replace('<%%COMBO(VcrRecLin)%%>', $combo_VcrRecLin->HTML, $templateCode);
	$templateCode = str_replace('<%%COMBOTEXT(VcrRecLin)%%>', $combo_VcrRecLin->SelectedData, $templateCode);
	$templateCode = str_replace('<%%COMBO(VcrRecLey)%%>', $combo_VcrRecLey->HTML, $templateCode);
	$templateCode = str_replace('<%%COMBOTEXT(VcrRecLey)%%>', $combo_VcrRecLey->SelectedData, $templateCode);
	$templateCode = str_replace('<%%COMBO(VcrRecPre)%%>', $combo_VcrRecPre->HTML, $templateCode);
	$templateCode = str_replace('<%%COMBOTEXT(VcrRecPre)%%>', $combo_VcrRecPre->SelectedData, $templateCode);
	$templateCode = str_replace('<%%COMBO(VcrRecAut)%%>', $combo_VcrRecAut->HTML, $templateCode);
	$templateCode = str_replace('<%%COMBOTEXT(VcrRecAut)%%>', $combo_VcrRecAut->SelectedData, $templateCode);
	$templateCode = str_replace('<%%COMBO(VcrDatPer)%%>', $combo_VcrDatPer->HTML, $templateCode);
	$templateCode = str_replace('<%%COMBOTEXT(VcrDatPer)%%>', $combo_VcrDatPer->SelectedData, $templateCode);
	$templateCode = str_replace('<%%COMBO(VcrUsoIma)%%>', $combo_VcrUsoIma->HTML, $templateCode);
	$templateCode = str_replace('<%%COMBOTEXT(VcrUsoIma)%%>', $combo_VcrUsoIma->SelectedData, $templateCode);
	$templateCode = str_replace('<%%COMBO(VcrUsoDat)%%>', $combo_VcrUsoDat->HTML, $templateCode);
	$templateCode = str_replace('<%%COMBOTEXT(VcrUsoDat)%%>', $combo_VcrUsoDat->SelectedData, $templateCode);
	$templateCode = str_replace('<%%COMBO(VcrAutCor)%%>', $combo_VcrAutCor->HTML, $templateCode);
	$templateCode = str_replace('<%%COMBOTEXT(VcrAutCor)%%>', $combo_VcrAutCor->SelectedData, $templateCode);
	$templateCode = str_replace('<%%COMBO(VcrIdSerP)%%>', $combo_VcrIdSerP->HTML, $templateCode);
	$templateCode = str_replace('<%%COMBOTEXT(VcrIdSerP)%%>', $combo_VcrIdSerP->MatchText, $templateCode);
	$templateCode = str_replace('<%%URLCOMBOTEXT(VcrIdSerP)%%>', urlencode($combo_VcrIdSerP->MatchText), $templateCode);

	/* lookup fields array: 'lookup field name' => ['parent table name', 'lookup field caption'] */
	$lookup_fields = ['VcrIdSol' => ['solicitudes', 'TIPO SOLICITUD:'], 'VcrIdTip' => ['tipo_documento', 'TIPO IDENTIFICACI&#211;N:'], 'VcrIdMot' => ['motivo_visita', 'MOTIVO VISITA:'], 'VcrIdUbi' => ['ubicacion', 'UBICACION:'], 'VcrIdBarVe' => ['barrios', 'BARRIO:'], 'VcrIdCorr' => ['corregimientos', 'VEREDA/CORREGIMIENTO:'], 'VcrIdCom' => ['comunas', 'COMUNA/LOCALIDAD:'], 'VcrIdFen' => ['fenomenos', 'TIPO DE FEN&#211;MENO:'], 'VcrIdCar' => ['caracteristicas_evento', 'CARACTER&#205;STICAS DEL EVENTO:'], 'VcrIdEdi' => ['edificacion', 'TIPO DE EDIFICACI&#211;N:'], 'VcrIdAfe' => ['afectacion', 'AFECTACI&#211;N:'], 'VcrIdMat' => ['tipo_material', 'TIPO DE MATERIAL:'], 'VcrIdLes' => ['lesiones', 'LESIONES EN LA ESTRUCTURA:'], 'VcrIdCap' => ['capacidad_reducida', 'TIPO CAPACIDAD REDUCIDA:'], 'VcrIdTra1' => ['dependencias', 'ORGANISMO O ENTIDAD 1:'], 'VcrdTra2' => ['dependencias', 'ORGANISMO O ENTIDAD 2:'], 'VcrIdTra3' => ['dependencias', 'ORGANISMO O ENTIDAD 3:'], 'VcrIdTra4' => ['dependencias', 'ORGANISMO O ENTIDAD 4:'], 'VcrIdSerP' => ['servidor_publico', 'FUNCIONARIO / CONTRATISTA:'], ];
	foreach($lookup_fields as $luf => $ptfc) {
		$pt_perm = getTablePermissions($ptfc[0]);

		// process foreign key links
		if($pt_perm['view'] || $pt_perm['edit']) {
			$templateCode = str_replace("<%%PLINK({$luf})%%>", '<button type="button" class="btn btn-default view_parent" id="' . $ptfc[0] . '_view_parent" title="' . html_attr($Translation['View'] . ' ' . $ptfc[1]) . '"><i class="glyphicon glyphicon-eye-open"></i></button>', $templateCode);
		}

		// if user has insert permission to parent table of a lookup field, put an add new button
		if($pt_perm['insert'] /* && !Request::val('Embedded')*/) {
			$templateCode = str_replace("<%%ADDNEW({$ptfc[0]})%%>", '<button type="button" class="btn btn-default add_new_parent" id="' . $ptfc[0] . '_add_new" title="' . html_attr($Translation['Add New'] . ' ' . $ptfc[1]) . '"><i class="glyphicon glyphicon-plus text-success"></i></button>', $templateCode);
		}
	}

	// process images
	$templateCode = str_replace('<%%UPLOADFILE(VcrId)%%>', '', $templateCode);
	$templateCode = str_replace('<%%UPLOADFILE(VcrCodForm)%%>', '', $templateCode);
	$templateCode = str_replace('<%%UPLOADFILE(VcrIdSol)%%>', '', $templateCode);
	$templateCode = str_replace('<%%UPLOADFILE(VcrFecVis)%%>', '', $templateCode);
	$templateCode = str_replace('<%%UPLOADFILE(VcrNomAti)%%>', '', $templateCode);
	$templateCode = str_replace('<%%UPLOADFILE(VcrIdTip)%%>', '', $templateCode);
	$templateCode = str_replace('<%%UPLOADFILE(VcrNoIde)%%>', '', $templateCode);
	$templateCode = str_replace('<%%UPLOADFILE(VcrCel)%%>', '', $templateCode);
	$templateCode = str_replace('<%%UPLOADFILE(VcrCorEle)%%>', '', $templateCode);
	$templateCode = str_replace('<%%UPLOADFILE(VcrIdMot)%%>', '', $templateCode);
	$templateCode = str_replace('<%%UPLOADFILE(VcrRadSol)%%>', '', $templateCode);
	$templateCode = str_replace('<%%UPLOADFILE(VcrFecSol)%%>', '', $templateCode);
	$templateCode = str_replace('<%%UPLOADFILE(VcrObsDat)%%>', '', $templateCode);
	$templateCode = str_replace('<%%UPLOADFILE(VcrIdUbi)%%>', '', $templateCode);
	$templateCode = str_replace('<%%UPLOADFILE(VcrDir)%%>', '', $templateCode);
	$templateCode = str_replace('<%%UPLOADFILE(VcrIdBarVe)%%>', '', $templateCode);
	$templateCode = str_replace('<%%UPLOADFILE(VcrIdCorr)%%>', '', $templateCode);
	$templateCode = str_replace('<%%UPLOADFILE(VcrIdCom)%%>', '', $templateCode);
	$templateCode = str_replace('<%%UPLOADFILE(VcrLat)%%>', '', $templateCode);
	$templateCode = str_replace('<%%UPLOADFILE(VcrLon)%%>', '', $templateCode);
	$templateCode = str_replace('<%%UPLOADFILE(VcrObsUbi)%%>', '', $templateCode);
	$templateCode = str_replace('<%%UPLOADFILE(VcrIdFen)%%>', '', $templateCode);
	$templateCode = str_replace('<%%UPLOADFILE(VcrDet)%%>', '', $templateCode);
	$templateCode = str_replace('<%%UPLOADFILE(VcrIdCar)%%>', '', $templateCode);
	$templateCode = str_replace('<%%UPLOADFILE(VcrOtr)%%>', '', $templateCode);
	$templateCode = str_replace('<%%UPLOADFILE(VcrDesEve)%%>', '', $templateCode);
	$templateCode = str_replace('<%%UPLOADFILE(VcrIdEdi)%%>', '', $templateCode);
	$templateCode = str_replace('<%%UPLOADFILE(VcrNoPis)%%>', '', $templateCode);
	$templateCode = str_replace('<%%UPLOADFILE(VcrObrCiv)%%>', '', $templateCode);
	$templateCode = str_replace('<%%UPLOADFILE(VcrEstEdi)%%>', '', $templateCode);
	$templateCode = str_replace('<%%UPLOADFILE(VcrIdAfe)%%>', '', $templateCode);
	$templateCode = str_replace('<%%UPLOADFILE(VcrObsEst)%%>', '', $templateCode);
	$templateCode = str_replace('<%%UPLOADFILE(VcrDanGrav)%%>', '', $templateCode);
	$templateCode = str_replace('<%%UPLOADFILE(VcrAnoCon)%%>', '', $templateCode);
	$templateCode = str_replace('<%%UPLOADFILE(VcrIdMat)%%>', '', $templateCode);
	$templateCode = str_replace('<%%UPLOADFILE(VcrIdLes)%%>', '', $templateCode);
	$templateCode = str_replace('<%%UPLOADFILE(VcrAyuHum)%%>', '', $templateCode);
	$templateCode = str_replace('<%%UPLOADFILE(VcrConAyu)%%>', '', $templateCode);
	$templateCode = str_replace('<%%UPLOADFILE(VcrObs)%%>', '', $templateCode);
	$templateCode = str_replace('<%%UPLOADFILE(VcrCapRed)%%>', '', $templateCode);
	$templateCode = str_replace('<%%UPLOADFILE(VcrIdCap)%%>', '', $templateCode);
	$templateCode = str_replace('<%%UPLOADFILE(VcrOtrCap)%%>', '', $templateCode);
	$templateCode = str_replace('<%%UPLOADFILE(VcrInf0a5F)%%>', '', $templateCode);
	$templateCode = str_replace('<%%UPLOADFILE(VcrInf0a5M)%%>', '', $templateCode);
	$templateCode = str_replace('<%%UPLOADFILE(VcrInf5a12F)%%>', '', $templateCode);
	$templateCode = str_replace('<%%UPLOADFILE(VcrInf5a12M)%%>', '', $templateCode);
	$templateCode = str_replace('<%%UPLOADFILE(VcrAd12a18F)%%>', '', $templateCode);
	$templateCode = str_replace('<%%UPLOADFILE(VcrAd12a18M)%%>', '', $templateCode);
	$templateCode = str_replace('<%%UPLOADFILE(VcrAd18a28F)%%>', '', $templateCode);
	$templateCode = str_replace('<%%UPLOADFILE(VcrAd18a28M)%%>', '', $templateCode);
	$templateCode = str_replace('<%%UPLOADFILE(VcrAd28a60F)%%>', '', $templateCode);
	$templateCode = str_replace('<%%UPLOADFILE(VcrAd28a60M)%%>', '', $templateCode);
	$templateCode = str_replace('<%%UPLOADFILE(VcrAdMay60F)%%>', '', $templateCode);
	$templateCode = str_replace('<%%UPLOADFILE(VcrAdMay60M)%%>', '', $templateCode);
	$templateCode = str_replace('<%%UPLOADFILE(VcrAfr)%%>', '', $templateCode);
	$templateCode = str_replace('<%%UPLOADFILE(VcrPal)%%>', '', $templateCode);
	$templateCode = str_replace('<%%UPLOADFILE(VcrInd)%%>', '', $templateCode);
	$templateCode = str_replace('<%%UPLOADFILE(VcrCau)%%>', '', $templateCode);
	$templateCode = str_replace('<%%UPLOADFILE(VcrGit)%%>', '', $templateCode);
	$templateCode = str_replace('<%%UPLOADFILE(VcrMes)%%>', '', $templateCode);
	$templateCode = str_replace('<%%UPLOADFILE(VcrOtrPer)%%>', '', $templateCode);
	$templateCode = str_replace('<%%UPLOADFILE(VcrPerNsNr)%%>', '', $templateCode);
	$templateCode = str_replace('<%%UPLOADFILE(VcrTraCas)%%>', '', $templateCode);
	$templateCode = str_replace('<%%UPLOADFILE(VcrIdTra1)%%>', '', $templateCode);
	$templateCode = str_replace('<%%UPLOADFILE(VcrdTra2)%%>', '', $templateCode);
	$templateCode = str_replace('<%%UPLOADFILE(VcrIdTra3)%%>', '', $templateCode);
	$templateCode = str_replace('<%%UPLOADFILE(VcrIdTra4)%%>', '', $templateCode);
	$templateCode = str_replace('<%%UPLOADFILE(VcrRecLin)%%>', '', $templateCode);
	$templateCode = str_replace('<%%UPLOADFILE(VcrRecLey)%%>', '', $templateCode);
	$templateCode = str_replace('<%%UPLOADFILE(VcrRecPre)%%>', '', $templateCode);
	$templateCode = str_replace('<%%UPLOADFILE(VcrRecAut)%%>', '', $templateCode);
	$templateCode = str_replace('<%%UPLOADFILE(VcrDatPer)%%>', '', $templateCode);
	$templateCode = str_replace('<%%UPLOADFILE(VcrUsoIma)%%>', '', $templateCode);
	$templateCode = str_replace('<%%UPLOADFILE(VcrUsoDat)%%>', '', $templateCode);
	$templateCode = str_replace('<%%UPLOADFILE(VcrAutCor)%%>', '', $templateCode);
	$templateCode = str_replace('<%%UPLOADFILE(VcrIdSerP)%%>', '', $templateCode);
	$templateCode = str_replace('<%%UPLOADFILE(VcrIma)%%>', ($noUploads ? '' : "<div>{$Translation['upload image']}</div>" . '<i class="glyphicon glyphicon-remove text-danger clear-upload hidden"></i> <input type="file" name="VcrIma" id="VcrIma" data-filetypes="jpg|jpeg|gif|png|webp" data-maxsize="8192000" accept=".jpg,.jpeg,.gif,.png,.webp">'), $templateCode);
	if($AllowUpdate && $row['VcrIma'] != '') {
		$templateCode = str_replace('<%%REMOVEFILE(VcrIma)%%>', '<br><input type="checkbox" name="VcrIma_remove" id="VcrIma_remove" value="1"> <label for="VcrIma_remove" style="color: red; font-weight: bold;">'.$Translation['remove image'].'</label>', $templateCode);
	} else {
		$templateCode = str_replace('<%%REMOVEFILE(VcrIma)%%>', '', $templateCode);
	}
	$templateCode = str_replace('<%%UPLOADFILE(VcrVideo)%%>', ($noUploads ? '' : "<div>{$Translation['upload image']}</div>" . '<i class="glyphicon glyphicon-remove text-danger clear-upload hidden"></i> <input type="file" name="VcrVideo" id="VcrVideo" data-filetypes="mov|avi|swf|asf|wmv|mpg|mpeg|mp4|flv" data-maxsize="8192000" accept=".mov,.avi,.swf,.asf,.wmv,.mpg,.mpeg,.mp4,.flv">'), $templateCode);
	if($AllowUpdate && $row['VcrVideo'] != '') {
		$templateCode = str_replace('<%%REMOVEFILE(VcrVideo)%%>', '<br><input type="checkbox" name="VcrVideo_remove" id="VcrVideo_remove" value="1"> <label for="VcrVideo_remove" style="color: red; font-weight: bold;">'.$Translation['remove image'].'</label>', $templateCode);
	} else {
		$templateCode = str_replace('<%%REMOVEFILE(VcrVideo)%%>', '', $templateCode);
	}
	$templateCode = str_replace('<%%UPLOADFILE(VcrDoc)%%>', ($noUploads ? '' : "<div>{$Translation['upload image']}</div>" . '<i class="glyphicon glyphicon-remove text-danger clear-upload hidden"></i> <input type="file" name="VcrDoc" id="VcrDoc" data-filetypes="txt|doc|docx|docm|odt|pdf|rtf" data-maxsize="2048000" accept=".txt,.doc,.docx,.docm,.odt,.pdf,.rtf">'), $templateCode);
	if($AllowUpdate && $row['VcrDoc'] != '') {
		$templateCode = str_replace('<%%REMOVEFILE(VcrDoc)%%>', '<br><input type="checkbox" name="VcrDoc_remove" id="VcrDoc_remove" value="1"> <label for="VcrDoc_remove" style="color: red; font-weight: bold;">'.$Translation['remove image'].'</label>', $templateCode);
	} else {
		$templateCode = str_replace('<%%REMOVEFILE(VcrDoc)%%>', '', $templateCode);
	}

	// process values
	if($selected_id) {
		if( $dvprint) $templateCode = str_replace('<%%VALUE(VcrId)%%>', safe_html($urow['VcrId']), $templateCode);
		if(!$dvprint) $templateCode = str_replace('<%%VALUE(VcrId)%%>', html_attr($row['VcrId']), $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrId)%%>', urlencode($urow['VcrId']), $templateCode);
		$templateCode = str_replace('<%%VALUE(VcrCodForm)%%>', safe_html($urow['VcrCodForm']), $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrCodForm)%%>', urlencode($urow['VcrCodForm']), $templateCode);
		if( $dvprint) $templateCode = str_replace('<%%VALUE(VcrIdSol)%%>', safe_html($urow['VcrIdSol']), $templateCode);
		if(!$dvprint) $templateCode = str_replace('<%%VALUE(VcrIdSol)%%>', html_attr($row['VcrIdSol']), $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrIdSol)%%>', urlencode($urow['VcrIdSol']), $templateCode);
		$templateCode = str_replace('<%%VALUE(VcrFecVis)%%>', app_datetime($row['VcrFecVis']), $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrFecVis)%%>', urlencode(app_datetime($urow['VcrFecVis'])), $templateCode);
		if( $dvprint) $templateCode = str_replace('<%%VALUE(VcrNomAti)%%>', safe_html($urow['VcrNomAti']), $templateCode);
		if(!$dvprint) $templateCode = str_replace('<%%VALUE(VcrNomAti)%%>', html_attr($row['VcrNomAti']), $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrNomAti)%%>', urlencode($urow['VcrNomAti']), $templateCode);
		if( $dvprint) $templateCode = str_replace('<%%VALUE(VcrIdTip)%%>', safe_html($urow['VcrIdTip']), $templateCode);
		if(!$dvprint) $templateCode = str_replace('<%%VALUE(VcrIdTip)%%>', html_attr($row['VcrIdTip']), $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrIdTip)%%>', urlencode($urow['VcrIdTip']), $templateCode);
		if( $dvprint) $templateCode = str_replace('<%%VALUE(VcrNoIde)%%>', safe_html($urow['VcrNoIde']), $templateCode);
		if(!$dvprint) $templateCode = str_replace('<%%VALUE(VcrNoIde)%%>', html_attr($row['VcrNoIde']), $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrNoIde)%%>', urlencode($urow['VcrNoIde']), $templateCode);
		if( $dvprint) $templateCode = str_replace('<%%VALUE(VcrCel)%%>', safe_html($urow['VcrCel']), $templateCode);
		if(!$dvprint) $templateCode = str_replace('<%%VALUE(VcrCel)%%>', html_attr($row['VcrCel']), $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrCel)%%>', urlencode($urow['VcrCel']), $templateCode);
		if( $dvprint) $templateCode = str_replace('<%%VALUE(VcrCorEle)%%>', safe_html($urow['VcrCorEle']), $templateCode);
		if(!$dvprint) $templateCode = str_replace('<%%VALUE(VcrCorEle)%%>', html_attr($row['VcrCorEle']), $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrCorEle)%%>', urlencode($urow['VcrCorEle']), $templateCode);
		if( $dvprint) $templateCode = str_replace('<%%VALUE(VcrIdMot)%%>', safe_html($urow['VcrIdMot']), $templateCode);
		if(!$dvprint) $templateCode = str_replace('<%%VALUE(VcrIdMot)%%>', html_attr($row['VcrIdMot']), $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrIdMot)%%>', urlencode($urow['VcrIdMot']), $templateCode);
		if( $dvprint) $templateCode = str_replace('<%%VALUE(VcrRadSol)%%>', safe_html($urow['VcrRadSol']), $templateCode);
		if(!$dvprint) $templateCode = str_replace('<%%VALUE(VcrRadSol)%%>', html_attr($row['VcrRadSol']), $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrRadSol)%%>', urlencode($urow['VcrRadSol']), $templateCode);
		$templateCode = str_replace('<%%VALUE(VcrFecSol)%%>', app_datetime($row['VcrFecSol']), $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrFecSol)%%>', urlencode(app_datetime($urow['VcrFecSol'])), $templateCode);
		if($dvprint || (!$AllowUpdate && !$AllowInsert)) {
			$templateCode = str_replace('<%%VALUE(VcrObsDat)%%>', safe_html($urow['VcrObsDat']), $templateCode);
		} else {
			$templateCode = str_replace('<%%VALUE(VcrObsDat)%%>', safe_html($urow['VcrObsDat'], true), $templateCode);
		}
		$templateCode = str_replace('<%%URLVALUE(VcrObsDat)%%>', urlencode($urow['VcrObsDat']), $templateCode);
		if( $dvprint) $templateCode = str_replace('<%%VALUE(VcrIdUbi)%%>', safe_html($urow['VcrIdUbi']), $templateCode);
		if(!$dvprint) $templateCode = str_replace('<%%VALUE(VcrIdUbi)%%>', html_attr($row['VcrIdUbi']), $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrIdUbi)%%>', urlencode($urow['VcrIdUbi']), $templateCode);
		if( $dvprint) $templateCode = str_replace('<%%VALUE(VcrDir)%%>', safe_html($urow['VcrDir']), $templateCode);
		if(!$dvprint) $templateCode = str_replace('<%%VALUE(VcrDir)%%>', html_attr($row['VcrDir']), $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrDir)%%>', urlencode($urow['VcrDir']), $templateCode);
		if( $dvprint) $templateCode = str_replace('<%%VALUE(VcrIdBarVe)%%>', safe_html($urow['VcrIdBarVe']), $templateCode);
		if(!$dvprint) $templateCode = str_replace('<%%VALUE(VcrIdBarVe)%%>', html_attr($row['VcrIdBarVe']), $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrIdBarVe)%%>', urlencode($urow['VcrIdBarVe']), $templateCode);
		if( $dvprint) $templateCode = str_replace('<%%VALUE(VcrIdCorr)%%>', safe_html($urow['VcrIdCorr']), $templateCode);
		if(!$dvprint) $templateCode = str_replace('<%%VALUE(VcrIdCorr)%%>', html_attr($row['VcrIdCorr']), $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrIdCorr)%%>', urlencode($urow['VcrIdCorr']), $templateCode);
		if( $dvprint) $templateCode = str_replace('<%%VALUE(VcrIdCom)%%>', safe_html($urow['VcrIdCom']), $templateCode);
		if(!$dvprint) $templateCode = str_replace('<%%VALUE(VcrIdCom)%%>', html_attr($row['VcrIdCom']), $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrIdCom)%%>', urlencode($urow['VcrIdCom']), $templateCode);
		if( $dvprint) $templateCode = str_replace('<%%VALUE(VcrLat)%%>', safe_html($urow['VcrLat']), $templateCode);
		if(!$dvprint) $templateCode = str_replace('<%%VALUE(VcrLat)%%>', html_attr($row['VcrLat']), $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrLat)%%>', urlencode($urow['VcrLat']), $templateCode);
		if( $dvprint) $templateCode = str_replace('<%%VALUE(VcrLon)%%>', safe_html($urow['VcrLon']), $templateCode);
		if(!$dvprint) $templateCode = str_replace('<%%VALUE(VcrLon)%%>', html_attr($row['VcrLon']), $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrLon)%%>', urlencode($urow['VcrLon']), $templateCode);
		if($dvprint || (!$AllowUpdate && !$AllowInsert)) {
			$templateCode = str_replace('<%%VALUE(VcrObsUbi)%%>', safe_html($urow['VcrObsUbi']), $templateCode);
		} else {
			$templateCode = str_replace('<%%VALUE(VcrObsUbi)%%>', safe_html($urow['VcrObsUbi'], true), $templateCode);
		}
		$templateCode = str_replace('<%%URLVALUE(VcrObsUbi)%%>', urlencode($urow['VcrObsUbi']), $templateCode);
		if( $dvprint) $templateCode = str_replace('<%%VALUE(VcrIdFen)%%>', safe_html($urow['VcrIdFen']), $templateCode);
		if(!$dvprint) $templateCode = str_replace('<%%VALUE(VcrIdFen)%%>', html_attr($row['VcrIdFen']), $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrIdFen)%%>', urlencode($urow['VcrIdFen']), $templateCode);
		if($dvprint || (!$AllowUpdate && !$AllowInsert)) {
			$templateCode = str_replace('<%%VALUE(VcrDet)%%>', safe_html($urow['VcrDet']), $templateCode);
		} else {
			$templateCode = str_replace('<%%VALUE(VcrDet)%%>', safe_html($urow['VcrDet'], true), $templateCode);
		}
		$templateCode = str_replace('<%%URLVALUE(VcrDet)%%>', urlencode($urow['VcrDet']), $templateCode);
		if( $dvprint) $templateCode = str_replace('<%%VALUE(VcrIdCar)%%>', safe_html($urow['VcrIdCar']), $templateCode);
		if(!$dvprint) $templateCode = str_replace('<%%VALUE(VcrIdCar)%%>', html_attr($row['VcrIdCar']), $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrIdCar)%%>', urlencode($urow['VcrIdCar']), $templateCode);
		if( $dvprint) $templateCode = str_replace('<%%VALUE(VcrOtr)%%>', safe_html($urow['VcrOtr']), $templateCode);
		if(!$dvprint) $templateCode = str_replace('<%%VALUE(VcrOtr)%%>', html_attr($row['VcrOtr']), $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrOtr)%%>', urlencode($urow['VcrOtr']), $templateCode);
		if($dvprint || (!$AllowUpdate && !$AllowInsert)) {
			$templateCode = str_replace('<%%VALUE(VcrDesEve)%%>', safe_html($urow['VcrDesEve']), $templateCode);
		} else {
			$templateCode = str_replace('<%%VALUE(VcrDesEve)%%>', safe_html($urow['VcrDesEve'], true), $templateCode);
		}
		$templateCode = str_replace('<%%URLVALUE(VcrDesEve)%%>', urlencode($urow['VcrDesEve']), $templateCode);
		if( $dvprint) $templateCode = str_replace('<%%VALUE(VcrIdEdi)%%>', safe_html($urow['VcrIdEdi']), $templateCode);
		if(!$dvprint) $templateCode = str_replace('<%%VALUE(VcrIdEdi)%%>', html_attr($row['VcrIdEdi']), $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrIdEdi)%%>', urlencode($urow['VcrIdEdi']), $templateCode);
		if( $dvprint) $templateCode = str_replace('<%%VALUE(VcrNoPis)%%>', safe_html($urow['VcrNoPis']), $templateCode);
		if(!$dvprint) $templateCode = str_replace('<%%VALUE(VcrNoPis)%%>', html_attr($row['VcrNoPis']), $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrNoPis)%%>', urlencode($urow['VcrNoPis']), $templateCode);
		if( $dvprint) $templateCode = str_replace('<%%VALUE(VcrObrCiv)%%>', safe_html($urow['VcrObrCiv']), $templateCode);
		if(!$dvprint) $templateCode = str_replace('<%%VALUE(VcrObrCiv)%%>', html_attr($row['VcrObrCiv']), $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrObrCiv)%%>', urlencode($urow['VcrObrCiv']), $templateCode);
		if( $dvprint) $templateCode = str_replace('<%%VALUE(VcrEstEdi)%%>', safe_html($urow['VcrEstEdi']), $templateCode);
		if(!$dvprint) $templateCode = str_replace('<%%VALUE(VcrEstEdi)%%>', html_attr($row['VcrEstEdi']), $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrEstEdi)%%>', urlencode($urow['VcrEstEdi']), $templateCode);
		if( $dvprint) $templateCode = str_replace('<%%VALUE(VcrIdAfe)%%>', safe_html($urow['VcrIdAfe']), $templateCode);
		if(!$dvprint) $templateCode = str_replace('<%%VALUE(VcrIdAfe)%%>', html_attr($row['VcrIdAfe']), $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrIdAfe)%%>', urlencode($urow['VcrIdAfe']), $templateCode);
		if($dvprint || (!$AllowUpdate && !$AllowInsert)) {
			$templateCode = str_replace('<%%VALUE(VcrObsEst)%%>', safe_html($urow['VcrObsEst']), $templateCode);
		} else {
			$templateCode = str_replace('<%%VALUE(VcrObsEst)%%>', safe_html($urow['VcrObsEst'], true), $templateCode);
		}
		$templateCode = str_replace('<%%URLVALUE(VcrObsEst)%%>', urlencode($urow['VcrObsEst']), $templateCode);
		if( $dvprint) $templateCode = str_replace('<%%VALUE(VcrDanGrav)%%>', safe_html($urow['VcrDanGrav']), $templateCode);
		if(!$dvprint) $templateCode = str_replace('<%%VALUE(VcrDanGrav)%%>', html_attr($row['VcrDanGrav']), $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrDanGrav)%%>', urlencode($urow['VcrDanGrav']), $templateCode);
		if( $dvprint) $templateCode = str_replace('<%%VALUE(VcrAnoCon)%%>', safe_html($urow['VcrAnoCon']), $templateCode);
		if(!$dvprint) $templateCode = str_replace('<%%VALUE(VcrAnoCon)%%>', html_attr($row['VcrAnoCon']), $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrAnoCon)%%>', urlencode($urow['VcrAnoCon']), $templateCode);
		if( $dvprint) $templateCode = str_replace('<%%VALUE(VcrIdMat)%%>', safe_html($urow['VcrIdMat']), $templateCode);
		if(!$dvprint) $templateCode = str_replace('<%%VALUE(VcrIdMat)%%>', html_attr($row['VcrIdMat']), $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrIdMat)%%>', urlencode($urow['VcrIdMat']), $templateCode);
		if( $dvprint) $templateCode = str_replace('<%%VALUE(VcrIdLes)%%>', safe_html($urow['VcrIdLes']), $templateCode);
		if(!$dvprint) $templateCode = str_replace('<%%VALUE(VcrIdLes)%%>', html_attr($row['VcrIdLes']), $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrIdLes)%%>', urlencode($urow['VcrIdLes']), $templateCode);
		if( $dvprint) $templateCode = str_replace('<%%VALUE(VcrAyuHum)%%>', safe_html($urow['VcrAyuHum']), $templateCode);
		if(!$dvprint) $templateCode = str_replace('<%%VALUE(VcrAyuHum)%%>', html_attr($row['VcrAyuHum']), $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrAyuHum)%%>', urlencode($urow['VcrAyuHum']), $templateCode);
		if( $dvprint) $templateCode = str_replace('<%%VALUE(VcrConAyu)%%>', safe_html($urow['VcrConAyu']), $templateCode);
		if(!$dvprint) $templateCode = str_replace('<%%VALUE(VcrConAyu)%%>', html_attr($row['VcrConAyu']), $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrConAyu)%%>', urlencode($urow['VcrConAyu']), $templateCode);
		if($dvprint || (!$AllowUpdate && !$AllowInsert)) {
			$templateCode = str_replace('<%%VALUE(VcrObs)%%>', safe_html($urow['VcrObs']), $templateCode);
		} else {
			$templateCode = str_replace('<%%VALUE(VcrObs)%%>', safe_html($urow['VcrObs'], true), $templateCode);
		}
		$templateCode = str_replace('<%%URLVALUE(VcrObs)%%>', urlencode($urow['VcrObs']), $templateCode);
		if( $dvprint) $templateCode = str_replace('<%%VALUE(VcrCapRed)%%>', safe_html($urow['VcrCapRed']), $templateCode);
		if(!$dvprint) $templateCode = str_replace('<%%VALUE(VcrCapRed)%%>', html_attr($row['VcrCapRed']), $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrCapRed)%%>', urlencode($urow['VcrCapRed']), $templateCode);
		if( $dvprint) $templateCode = str_replace('<%%VALUE(VcrIdCap)%%>', safe_html($urow['VcrIdCap']), $templateCode);
		if(!$dvprint) $templateCode = str_replace('<%%VALUE(VcrIdCap)%%>', html_attr($row['VcrIdCap']), $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrIdCap)%%>', urlencode($urow['VcrIdCap']), $templateCode);
		if($dvprint || (!$AllowUpdate && !$AllowInsert)) {
			$templateCode = str_replace('<%%VALUE(VcrOtrCap)%%>', safe_html($urow['VcrOtrCap']), $templateCode);
		} else {
			$templateCode = str_replace('<%%VALUE(VcrOtrCap)%%>', safe_html($urow['VcrOtrCap'], true), $templateCode);
		}
		$templateCode = str_replace('<%%URLVALUE(VcrOtrCap)%%>', urlencode($urow['VcrOtrCap']), $templateCode);
		if( $dvprint) $templateCode = str_replace('<%%VALUE(VcrInf0a5F)%%>', safe_html($urow['VcrInf0a5F']), $templateCode);
		if(!$dvprint) $templateCode = str_replace('<%%VALUE(VcrInf0a5F)%%>', html_attr($row['VcrInf0a5F']), $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrInf0a5F)%%>', urlencode($urow['VcrInf0a5F']), $templateCode);
		if( $dvprint) $templateCode = str_replace('<%%VALUE(VcrInf0a5M)%%>', safe_html($urow['VcrInf0a5M']), $templateCode);
		if(!$dvprint) $templateCode = str_replace('<%%VALUE(VcrInf0a5M)%%>', html_attr($row['VcrInf0a5M']), $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrInf0a5M)%%>', urlencode($urow['VcrInf0a5M']), $templateCode);
		if( $dvprint) $templateCode = str_replace('<%%VALUE(VcrInf5a12F)%%>', safe_html($urow['VcrInf5a12F']), $templateCode);
		if(!$dvprint) $templateCode = str_replace('<%%VALUE(VcrInf5a12F)%%>', html_attr($row['VcrInf5a12F']), $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrInf5a12F)%%>', urlencode($urow['VcrInf5a12F']), $templateCode);
		if( $dvprint) $templateCode = str_replace('<%%VALUE(VcrInf5a12M)%%>', safe_html($urow['VcrInf5a12M']), $templateCode);
		if(!$dvprint) $templateCode = str_replace('<%%VALUE(VcrInf5a12M)%%>', html_attr($row['VcrInf5a12M']), $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrInf5a12M)%%>', urlencode($urow['VcrInf5a12M']), $templateCode);
		if( $dvprint) $templateCode = str_replace('<%%VALUE(VcrAd12a18F)%%>', safe_html($urow['VcrAd12a18F']), $templateCode);
		if(!$dvprint) $templateCode = str_replace('<%%VALUE(VcrAd12a18F)%%>', html_attr($row['VcrAd12a18F']), $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrAd12a18F)%%>', urlencode($urow['VcrAd12a18F']), $templateCode);
		if( $dvprint) $templateCode = str_replace('<%%VALUE(VcrAd12a18M)%%>', safe_html($urow['VcrAd12a18M']), $templateCode);
		if(!$dvprint) $templateCode = str_replace('<%%VALUE(VcrAd12a18M)%%>', html_attr($row['VcrAd12a18M']), $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrAd12a18M)%%>', urlencode($urow['VcrAd12a18M']), $templateCode);
		if( $dvprint) $templateCode = str_replace('<%%VALUE(VcrAd18a28F)%%>', safe_html($urow['VcrAd18a28F']), $templateCode);
		if(!$dvprint) $templateCode = str_replace('<%%VALUE(VcrAd18a28F)%%>', html_attr($row['VcrAd18a28F']), $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrAd18a28F)%%>', urlencode($urow['VcrAd18a28F']), $templateCode);
		if( $dvprint) $templateCode = str_replace('<%%VALUE(VcrAd18a28M)%%>', safe_html($urow['VcrAd18a28M']), $templateCode);
		if(!$dvprint) $templateCode = str_replace('<%%VALUE(VcrAd18a28M)%%>', html_attr($row['VcrAd18a28M']), $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrAd18a28M)%%>', urlencode($urow['VcrAd18a28M']), $templateCode);
		if( $dvprint) $templateCode = str_replace('<%%VALUE(VcrAd28a60F)%%>', safe_html($urow['VcrAd28a60F']), $templateCode);
		if(!$dvprint) $templateCode = str_replace('<%%VALUE(VcrAd28a60F)%%>', html_attr($row['VcrAd28a60F']), $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrAd28a60F)%%>', urlencode($urow['VcrAd28a60F']), $templateCode);
		if( $dvprint) $templateCode = str_replace('<%%VALUE(VcrAd28a60M)%%>', safe_html($urow['VcrAd28a60M']), $templateCode);
		if(!$dvprint) $templateCode = str_replace('<%%VALUE(VcrAd28a60M)%%>', html_attr($row['VcrAd28a60M']), $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrAd28a60M)%%>', urlencode($urow['VcrAd28a60M']), $templateCode);
		if( $dvprint) $templateCode = str_replace('<%%VALUE(VcrAdMay60F)%%>', safe_html($urow['VcrAdMay60F']), $templateCode);
		if(!$dvprint) $templateCode = str_replace('<%%VALUE(VcrAdMay60F)%%>', html_attr($row['VcrAdMay60F']), $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrAdMay60F)%%>', urlencode($urow['VcrAdMay60F']), $templateCode);
		if( $dvprint) $templateCode = str_replace('<%%VALUE(VcrAdMay60M)%%>', safe_html($urow['VcrAdMay60M']), $templateCode);
		if(!$dvprint) $templateCode = str_replace('<%%VALUE(VcrAdMay60M)%%>', html_attr($row['VcrAdMay60M']), $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrAdMay60M)%%>', urlencode($urow['VcrAdMay60M']), $templateCode);
		if( $dvprint) $templateCode = str_replace('<%%VALUE(VcrAfr)%%>', safe_html($urow['VcrAfr']), $templateCode);
		if(!$dvprint) $templateCode = str_replace('<%%VALUE(VcrAfr)%%>', html_attr($row['VcrAfr']), $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrAfr)%%>', urlencode($urow['VcrAfr']), $templateCode);
		if( $dvprint) $templateCode = str_replace('<%%VALUE(VcrPal)%%>', safe_html($urow['VcrPal']), $templateCode);
		if(!$dvprint) $templateCode = str_replace('<%%VALUE(VcrPal)%%>', html_attr($row['VcrPal']), $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrPal)%%>', urlencode($urow['VcrPal']), $templateCode);
		if( $dvprint) $templateCode = str_replace('<%%VALUE(VcrInd)%%>', safe_html($urow['VcrInd']), $templateCode);
		if(!$dvprint) $templateCode = str_replace('<%%VALUE(VcrInd)%%>', html_attr($row['VcrInd']), $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrInd)%%>', urlencode($urow['VcrInd']), $templateCode);
		if( $dvprint) $templateCode = str_replace('<%%VALUE(VcrCau)%%>', safe_html($urow['VcrCau']), $templateCode);
		if(!$dvprint) $templateCode = str_replace('<%%VALUE(VcrCau)%%>', html_attr($row['VcrCau']), $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrCau)%%>', urlencode($urow['VcrCau']), $templateCode);
		if( $dvprint) $templateCode = str_replace('<%%VALUE(VcrGit)%%>', safe_html($urow['VcrGit']), $templateCode);
		if(!$dvprint) $templateCode = str_replace('<%%VALUE(VcrGit)%%>', html_attr($row['VcrGit']), $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrGit)%%>', urlencode($urow['VcrGit']), $templateCode);
		if( $dvprint) $templateCode = str_replace('<%%VALUE(VcrMes)%%>', safe_html($urow['VcrMes']), $templateCode);
		if(!$dvprint) $templateCode = str_replace('<%%VALUE(VcrMes)%%>', html_attr($row['VcrMes']), $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrMes)%%>', urlencode($urow['VcrMes']), $templateCode);
		if($dvprint || (!$AllowUpdate && !$AllowInsert)) {
			$templateCode = str_replace('<%%VALUE(VcrOtrPer)%%>', safe_html($urow['VcrOtrPer']), $templateCode);
		} else {
			$templateCode = str_replace('<%%VALUE(VcrOtrPer)%%>', safe_html($urow['VcrOtrPer'], true), $templateCode);
		}
		$templateCode = str_replace('<%%URLVALUE(VcrOtrPer)%%>', urlencode($urow['VcrOtrPer']), $templateCode);
		if( $dvprint) $templateCode = str_replace('<%%VALUE(VcrPerNsNr)%%>', safe_html($urow['VcrPerNsNr']), $templateCode);
		if(!$dvprint) $templateCode = str_replace('<%%VALUE(VcrPerNsNr)%%>', html_attr($row['VcrPerNsNr']), $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrPerNsNr)%%>', urlencode($urow['VcrPerNsNr']), $templateCode);
		if( $dvprint) $templateCode = str_replace('<%%VALUE(VcrTraCas)%%>', safe_html($urow['VcrTraCas']), $templateCode);
		if(!$dvprint) $templateCode = str_replace('<%%VALUE(VcrTraCas)%%>', html_attr($row['VcrTraCas']), $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrTraCas)%%>', urlencode($urow['VcrTraCas']), $templateCode);
		if( $dvprint) $templateCode = str_replace('<%%VALUE(VcrIdTra1)%%>', safe_html($urow['VcrIdTra1']), $templateCode);
		if(!$dvprint) $templateCode = str_replace('<%%VALUE(VcrIdTra1)%%>', html_attr($row['VcrIdTra1']), $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrIdTra1)%%>', urlencode($urow['VcrIdTra1']), $templateCode);
		if( $dvprint) $templateCode = str_replace('<%%VALUE(VcrdTra2)%%>', safe_html($urow['VcrdTra2']), $templateCode);
		if(!$dvprint) $templateCode = str_replace('<%%VALUE(VcrdTra2)%%>', html_attr($row['VcrdTra2']), $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrdTra2)%%>', urlencode($urow['VcrdTra2']), $templateCode);
		if( $dvprint) $templateCode = str_replace('<%%VALUE(VcrIdTra3)%%>', safe_html($urow['VcrIdTra3']), $templateCode);
		if(!$dvprint) $templateCode = str_replace('<%%VALUE(VcrIdTra3)%%>', html_attr($row['VcrIdTra3']), $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrIdTra3)%%>', urlencode($urow['VcrIdTra3']), $templateCode);
		if( $dvprint) $templateCode = str_replace('<%%VALUE(VcrIdTra4)%%>', safe_html($urow['VcrIdTra4']), $templateCode);
		if(!$dvprint) $templateCode = str_replace('<%%VALUE(VcrIdTra4)%%>', html_attr($row['VcrIdTra4']), $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrIdTra4)%%>', urlencode($urow['VcrIdTra4']), $templateCode);
		if( $dvprint) $templateCode = str_replace('<%%VALUE(VcrRecLin)%%>', safe_html($urow['VcrRecLin']), $templateCode);
		if(!$dvprint) $templateCode = str_replace('<%%VALUE(VcrRecLin)%%>', html_attr($row['VcrRecLin']), $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrRecLin)%%>', urlencode($urow['VcrRecLin']), $templateCode);
		if( $dvprint) $templateCode = str_replace('<%%VALUE(VcrRecLey)%%>', safe_html($urow['VcrRecLey']), $templateCode);
		if(!$dvprint) $templateCode = str_replace('<%%VALUE(VcrRecLey)%%>', html_attr($row['VcrRecLey']), $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrRecLey)%%>', urlencode($urow['VcrRecLey']), $templateCode);
		if( $dvprint) $templateCode = str_replace('<%%VALUE(VcrRecPre)%%>', safe_html($urow['VcrRecPre']), $templateCode);
		if(!$dvprint) $templateCode = str_replace('<%%VALUE(VcrRecPre)%%>', html_attr($row['VcrRecPre']), $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrRecPre)%%>', urlencode($urow['VcrRecPre']), $templateCode);
		if( $dvprint) $templateCode = str_replace('<%%VALUE(VcrRecAut)%%>', safe_html($urow['VcrRecAut']), $templateCode);
		if(!$dvprint) $templateCode = str_replace('<%%VALUE(VcrRecAut)%%>', html_attr($row['VcrRecAut']), $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrRecAut)%%>', urlencode($urow['VcrRecAut']), $templateCode);
		if( $dvprint) $templateCode = str_replace('<%%VALUE(VcrDatPer)%%>', safe_html($urow['VcrDatPer']), $templateCode);
		if(!$dvprint) $templateCode = str_replace('<%%VALUE(VcrDatPer)%%>', html_attr($row['VcrDatPer']), $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrDatPer)%%>', urlencode($urow['VcrDatPer']), $templateCode);
		if( $dvprint) $templateCode = str_replace('<%%VALUE(VcrUsoIma)%%>', safe_html($urow['VcrUsoIma']), $templateCode);
		if(!$dvprint) $templateCode = str_replace('<%%VALUE(VcrUsoIma)%%>', html_attr($row['VcrUsoIma']), $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrUsoIma)%%>', urlencode($urow['VcrUsoIma']), $templateCode);
		if( $dvprint) $templateCode = str_replace('<%%VALUE(VcrUsoDat)%%>', safe_html($urow['VcrUsoDat']), $templateCode);
		if(!$dvprint) $templateCode = str_replace('<%%VALUE(VcrUsoDat)%%>', html_attr($row['VcrUsoDat']), $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrUsoDat)%%>', urlencode($urow['VcrUsoDat']), $templateCode);
		if( $dvprint) $templateCode = str_replace('<%%VALUE(VcrAutCor)%%>', safe_html($urow['VcrAutCor']), $templateCode);
		if(!$dvprint) $templateCode = str_replace('<%%VALUE(VcrAutCor)%%>', html_attr($row['VcrAutCor']), $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrAutCor)%%>', urlencode($urow['VcrAutCor']), $templateCode);
		if( $dvprint) $templateCode = str_replace('<%%VALUE(VcrIdSerP)%%>', safe_html($urow['VcrIdSerP']), $templateCode);
		if(!$dvprint) $templateCode = str_replace('<%%VALUE(VcrIdSerP)%%>', html_attr($row['VcrIdSerP']), $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrIdSerP)%%>', urlencode($urow['VcrIdSerP']), $templateCode);
		if( $dvprint) $templateCode = str_replace('<%%VALUE(VcrIma)%%>', safe_html($urow['VcrIma']), $templateCode);
		if(!$dvprint) $templateCode = str_replace('<%%VALUE(VcrIma)%%>', html_attr($row['VcrIma']), $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrIma)%%>', urlencode($urow['VcrIma']), $templateCode);
		if( $dvprint) $templateCode = str_replace('<%%VALUE(VcrVideo)%%>', safe_html($urow['VcrVideo']), $templateCode);
		if(!$dvprint) $templateCode = str_replace('<%%VALUE(VcrVideo)%%>', html_attr($row['VcrVideo']), $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrVideo)%%>', urlencode($urow['VcrVideo']), $templateCode);
		if( $dvprint) $templateCode = str_replace('<%%VALUE(VcrDoc)%%>', safe_html($urow['VcrDoc']), $templateCode);
		if(!$dvprint) $templateCode = str_replace('<%%VALUE(VcrDoc)%%>', html_attr($row['VcrDoc']), $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrDoc)%%>', urlencode($urow['VcrDoc']), $templateCode);
	} else {
		$templateCode = str_replace('<%%VALUE(VcrId)%%>', '', $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrId)%%>', urlencode(''), $templateCode);
		$templateCode = str_replace('<%%VALUE(VcrCodForm)%%>', '', $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrCodForm)%%>', urlencode(''), $templateCode);
		$templateCode = str_replace('<%%VALUE(VcrIdSol)%%>', '', $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrIdSol)%%>', urlencode(''), $templateCode);
		$templateCode = str_replace('<%%VALUE(VcrFecVis)%%>', '', $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrFecVis)%%>', urlencode(''), $templateCode);
		$templateCode = str_replace('<%%VALUE(VcrNomAti)%%>', '', $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrNomAti)%%>', urlencode(''), $templateCode);
		$templateCode = str_replace('<%%VALUE(VcrIdTip)%%>', '', $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrIdTip)%%>', urlencode(''), $templateCode);
		$templateCode = str_replace('<%%VALUE(VcrNoIde)%%>', '', $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrNoIde)%%>', urlencode(''), $templateCode);
		$templateCode = str_replace('<%%VALUE(VcrCel)%%>', '', $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrCel)%%>', urlencode(''), $templateCode);
		$templateCode = str_replace('<%%VALUE(VcrCorEle)%%>', '', $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrCorEle)%%>', urlencode(''), $templateCode);
		$templateCode = str_replace('<%%VALUE(VcrIdMot)%%>', '', $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrIdMot)%%>', urlencode(''), $templateCode);
		$templateCode = str_replace('<%%VALUE(VcrRadSol)%%>', '', $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrRadSol)%%>', urlencode(''), $templateCode);
		$templateCode = str_replace('<%%VALUE(VcrFecSol)%%>', '', $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrFecSol)%%>', urlencode(''), $templateCode);
		$templateCode = str_replace('<%%VALUE(VcrObsDat)%%>', '', $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrObsDat)%%>', urlencode(''), $templateCode);
		$templateCode = str_replace('<%%VALUE(VcrIdUbi)%%>', '', $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrIdUbi)%%>', urlencode(''), $templateCode);
		$templateCode = str_replace('<%%VALUE(VcrDir)%%>', '', $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrDir)%%>', urlencode(''), $templateCode);
		$templateCode = str_replace('<%%VALUE(VcrIdBarVe)%%>', '', $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrIdBarVe)%%>', urlencode(''), $templateCode);
		$templateCode = str_replace('<%%VALUE(VcrIdCorr)%%>', '', $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrIdCorr)%%>', urlencode(''), $templateCode);
		$templateCode = str_replace('<%%VALUE(VcrIdCom)%%>', '', $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrIdCom)%%>', urlencode(''), $templateCode);
		$templateCode = str_replace('<%%VALUE(VcrLat)%%>', '', $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrLat)%%>', urlencode(''), $templateCode);
		$templateCode = str_replace('<%%VALUE(VcrLon)%%>', '', $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrLon)%%>', urlencode(''), $templateCode);
		$templateCode = str_replace('<%%VALUE(VcrObsUbi)%%>', '', $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrObsUbi)%%>', urlencode(''), $templateCode);
		$templateCode = str_replace('<%%VALUE(VcrIdFen)%%>', '', $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrIdFen)%%>', urlencode(''), $templateCode);
		$templateCode = str_replace('<%%VALUE(VcrDet)%%>', '', $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrDet)%%>', urlencode(''), $templateCode);
		$templateCode = str_replace('<%%VALUE(VcrIdCar)%%>', '', $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrIdCar)%%>', urlencode(''), $templateCode);
		$templateCode = str_replace('<%%VALUE(VcrOtr)%%>', '', $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrOtr)%%>', urlencode(''), $templateCode);
		$templateCode = str_replace('<%%VALUE(VcrDesEve)%%>', '', $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrDesEve)%%>', urlencode(''), $templateCode);
		$templateCode = str_replace('<%%VALUE(VcrIdEdi)%%>', '', $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrIdEdi)%%>', urlencode(''), $templateCode);
		$templateCode = str_replace('<%%VALUE(VcrNoPis)%%>', '', $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrNoPis)%%>', urlencode(''), $templateCode);
		$templateCode = str_replace('<%%VALUE(VcrObrCiv)%%>', '', $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrObrCiv)%%>', urlencode(''), $templateCode);
		$templateCode = str_replace('<%%VALUE(VcrEstEdi)%%>', '', $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrEstEdi)%%>', urlencode(''), $templateCode);
		$templateCode = str_replace('<%%VALUE(VcrIdAfe)%%>', '', $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrIdAfe)%%>', urlencode(''), $templateCode);
		$templateCode = str_replace('<%%VALUE(VcrObsEst)%%>', '', $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrObsEst)%%>', urlencode(''), $templateCode);
		$templateCode = str_replace('<%%VALUE(VcrDanGrav)%%>', '', $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrDanGrav)%%>', urlencode(''), $templateCode);
		$templateCode = str_replace('<%%VALUE(VcrAnoCon)%%>', '', $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrAnoCon)%%>', urlencode(''), $templateCode);
		$templateCode = str_replace('<%%VALUE(VcrIdMat)%%>', '', $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrIdMat)%%>', urlencode(''), $templateCode);
		$templateCode = str_replace('<%%VALUE(VcrIdLes)%%>', '', $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrIdLes)%%>', urlencode(''), $templateCode);
		$templateCode = str_replace('<%%VALUE(VcrAyuHum)%%>', '', $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrAyuHum)%%>', urlencode(''), $templateCode);
		$templateCode = str_replace('<%%VALUE(VcrConAyu)%%>', '', $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrConAyu)%%>', urlencode(''), $templateCode);
		$templateCode = str_replace('<%%VALUE(VcrObs)%%>', '', $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrObs)%%>', urlencode(''), $templateCode);
		$templateCode = str_replace('<%%VALUE(VcrCapRed)%%>', '', $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrCapRed)%%>', urlencode(''), $templateCode);
		$templateCode = str_replace('<%%VALUE(VcrIdCap)%%>', '', $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrIdCap)%%>', urlencode(''), $templateCode);
		$templateCode = str_replace('<%%VALUE(VcrOtrCap)%%>', '', $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrOtrCap)%%>', urlencode(''), $templateCode);
		$templateCode = str_replace('<%%VALUE(VcrInf0a5F)%%>', '', $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrInf0a5F)%%>', urlencode(''), $templateCode);
		$templateCode = str_replace('<%%VALUE(VcrInf0a5M)%%>', '', $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrInf0a5M)%%>', urlencode(''), $templateCode);
		$templateCode = str_replace('<%%VALUE(VcrInf5a12F)%%>', '', $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrInf5a12F)%%>', urlencode(''), $templateCode);
		$templateCode = str_replace('<%%VALUE(VcrInf5a12M)%%>', '', $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrInf5a12M)%%>', urlencode(''), $templateCode);
		$templateCode = str_replace('<%%VALUE(VcrAd12a18F)%%>', '', $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrAd12a18F)%%>', urlencode(''), $templateCode);
		$templateCode = str_replace('<%%VALUE(VcrAd12a18M)%%>', '', $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrAd12a18M)%%>', urlencode(''), $templateCode);
		$templateCode = str_replace('<%%VALUE(VcrAd18a28F)%%>', '', $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrAd18a28F)%%>', urlencode(''), $templateCode);
		$templateCode = str_replace('<%%VALUE(VcrAd18a28M)%%>', '', $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrAd18a28M)%%>', urlencode(''), $templateCode);
		$templateCode = str_replace('<%%VALUE(VcrAd28a60F)%%>', '', $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrAd28a60F)%%>', urlencode(''), $templateCode);
		$templateCode = str_replace('<%%VALUE(VcrAd28a60M)%%>', '', $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrAd28a60M)%%>', urlencode(''), $templateCode);
		$templateCode = str_replace('<%%VALUE(VcrAdMay60F)%%>', '', $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrAdMay60F)%%>', urlencode(''), $templateCode);
		$templateCode = str_replace('<%%VALUE(VcrAdMay60M)%%>', '', $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrAdMay60M)%%>', urlencode(''), $templateCode);
		$templateCode = str_replace('<%%VALUE(VcrAfr)%%>', '', $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrAfr)%%>', urlencode(''), $templateCode);
		$templateCode = str_replace('<%%VALUE(VcrPal)%%>', '', $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrPal)%%>', urlencode(''), $templateCode);
		$templateCode = str_replace('<%%VALUE(VcrInd)%%>', '', $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrInd)%%>', urlencode(''), $templateCode);
		$templateCode = str_replace('<%%VALUE(VcrCau)%%>', '', $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrCau)%%>', urlencode(''), $templateCode);
		$templateCode = str_replace('<%%VALUE(VcrGit)%%>', '', $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrGit)%%>', urlencode(''), $templateCode);
		$templateCode = str_replace('<%%VALUE(VcrMes)%%>', '', $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrMes)%%>', urlencode(''), $templateCode);
		$templateCode = str_replace('<%%VALUE(VcrOtrPer)%%>', '', $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrOtrPer)%%>', urlencode(''), $templateCode);
		$templateCode = str_replace('<%%VALUE(VcrPerNsNr)%%>', '', $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrPerNsNr)%%>', urlencode(''), $templateCode);
		$templateCode = str_replace('<%%VALUE(VcrTraCas)%%>', '', $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrTraCas)%%>', urlencode(''), $templateCode);
		$templateCode = str_replace('<%%VALUE(VcrIdTra1)%%>', '', $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrIdTra1)%%>', urlencode(''), $templateCode);
		$templateCode = str_replace('<%%VALUE(VcrdTra2)%%>', '', $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrdTra2)%%>', urlencode(''), $templateCode);
		$templateCode = str_replace('<%%VALUE(VcrIdTra3)%%>', '', $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrIdTra3)%%>', urlencode(''), $templateCode);
		$templateCode = str_replace('<%%VALUE(VcrIdTra4)%%>', '', $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrIdTra4)%%>', urlencode(''), $templateCode);
		$templateCode = str_replace('<%%VALUE(VcrRecLin)%%>', '', $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrRecLin)%%>', urlencode(''), $templateCode);
		$templateCode = str_replace('<%%VALUE(VcrRecLey)%%>', '', $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrRecLey)%%>', urlencode(''), $templateCode);
		$templateCode = str_replace('<%%VALUE(VcrRecPre)%%>', '', $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrRecPre)%%>', urlencode(''), $templateCode);
		$templateCode = str_replace('<%%VALUE(VcrRecAut)%%>', '', $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrRecAut)%%>', urlencode(''), $templateCode);
		$templateCode = str_replace('<%%VALUE(VcrDatPer)%%>', '', $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrDatPer)%%>', urlencode(''), $templateCode);
		$templateCode = str_replace('<%%VALUE(VcrUsoIma)%%>', '', $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrUsoIma)%%>', urlencode(''), $templateCode);
		$templateCode = str_replace('<%%VALUE(VcrUsoDat)%%>', '', $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrUsoDat)%%>', urlencode(''), $templateCode);
		$templateCode = str_replace('<%%VALUE(VcrAutCor)%%>', '', $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrAutCor)%%>', urlencode(''), $templateCode);
		$templateCode = str_replace('<%%VALUE(VcrIdSerP)%%>', '', $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrIdSerP)%%>', urlencode(''), $templateCode);
		$templateCode = str_replace('<%%VALUE(VcrIma)%%>', '', $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrIma)%%>', urlencode(''), $templateCode);
		$templateCode = str_replace('<%%VALUE(VcrVideo)%%>', '', $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrVideo)%%>', urlencode(''), $templateCode);
		$templateCode = str_replace('<%%VALUE(VcrDoc)%%>', '', $templateCode);
		$templateCode = str_replace('<%%URLVALUE(VcrDoc)%%>', urlencode(''), $templateCode);
	}

	// process translations
	$templateCode = parseTemplate($templateCode);

	// clear scrap
	$templateCode = str_replace('<%%', '<!-- ', $templateCode);
	$templateCode = str_replace('%%>', ' -->', $templateCode);

	// hide links to inaccessible tables
	if(Request::val('dvprint_x') == '') {
		$templateCode .= "\n\n<script>\$j(function() {\n";
		$arrTables = getTableList();
		foreach($arrTables as $name => $caption) {
			$templateCode .= "\t\$j('#{$name}_link').removeClass('hidden');\n";
			$templateCode .= "\t\$j('#xs_{$name}_link').removeClass('hidden');\n";
		}

		$templateCode .= $jsReadOnly;
		$templateCode .= $jsEditable;

		if(!$selected_id) {
			$templateCode.="\n\tif(document.getElementById('VcrImaEdit')) { document.getElementById('VcrImaEdit').style.display='inline'; }";
			$templateCode.="\n\tif(document.getElementById('VcrImaEditLink')) { document.getElementById('VcrImaEditLink').style.display='none'; }";
			$templateCode.="\n\tif(document.getElementById('VcrVideoEdit')) { document.getElementById('VcrVideoEdit').style.display='inline'; }";
			$templateCode.="\n\tif(document.getElementById('VcrVideoEditLink')) { document.getElementById('VcrVideoEditLink').style.display='none'; }";
			$templateCode.="\n\tif(document.getElementById('VcrDocEdit')) { document.getElementById('VcrDocEdit').style.display='inline'; }";
			$templateCode.="\n\tif(document.getElementById('VcrDocEditLink')) { document.getElementById('VcrDocEditLink').style.display='none'; }";
		}

		$templateCode.="\n});</script>\n";
	}

	// ajaxed auto-fill fields
	$templateCode .= '<script>';
	$templateCode .= '$j(function() {';


	$templateCode.="});";
	$templateCode.="</script>";
	$templateCode .= $lookups;

	// handle enforced parent values for read-only lookup fields
	$filterField = Request::val('FilterField');
	$filterOperator = Request::val('FilterOperator');
	$filterValue = Request::val('FilterValue');

	// don't include blank images in lightbox gallery
	$templateCode = preg_replace('/blank.gif" data-lightbox=".*?"/', 'blank.gif"', $templateCode);

	// don't display empty email links
	$templateCode=preg_replace('/<a .*?href="mailto:".*?<\/a>/', '', $templateCode);

	/* default field values */
	$rdata = $jdata = get_defaults('natural');
	if($selected_id) {
		$jdata = get_joined_record('natural', $selected_id);
		if($jdata === false) $jdata = get_defaults('natural');
		$rdata = $row;
	}
	$templateCode .= loadView('natural-ajax-cache', ['rdata' => $rdata, 'jdata' => $jdata]);

	// hook: natural_dv
	if(function_exists('natural_dv')) {
		$args = [];
		natural_dv(($selected_id ? $selected_id : FALSE), getMemberInfo(), $templateCode, $args);
	}

	return $templateCode;
}